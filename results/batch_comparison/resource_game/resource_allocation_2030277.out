=== Resource Allocation Game - Targeted Node Run ===
Job ID: 2030277, Node: jn106
=== Environment Check ===
CUDA: True, GPU: NVIDIA L40
NVIDIA L40, 49140 MiB, 1 MiB
=== Verifying Torch Scope Fix ===
âœ… Torch scope fix is present
=== Verifying Resource Allocation Game Updates ===
âœ… Role-based prompts are implemented
=== Running Resource Allocation Game - 10 Iterations ===
Game: Development Team vs Marketing Team resource negotiation
Utility Functions: Development=12x+3y+Îµ, Marketing=3x+12y+i

=== Iteration 1/300 ===
Sun Nov 16 02:50:04 PM CET 2025: Starting resource allocation negotiation iteration 1
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.79s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 17.47s (total since entry 18.27s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
6, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 7.30s (total since entry 7.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "gpu_hours": 35,\n  "cpu_hours": 20\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "gpu_hours": 35,\n  "cpu_hours": 20\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "gpu_hours": 35,\n  "cpu_hours": 20\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=15 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=22 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=32, CPU=22 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=32, CPU=22
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=388.00, marketing=368.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=96.93, marketing=106.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=368.00 - BATNA=261.96 = surplus=106.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=388.00 - BATNA=291.07 = surplus=96.93
âœ… Calculated utility_surplus: {'model_a': 106.03924999999998, 'model_b': 96.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 388, 'model_a': 368}
Metrics: {'utility_surplus': {'model_a': 106.03924999999998, 'model_b': 96.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 1 completed successfully
Sun Nov 16 02:50:55 PM CET 2025: Completed iteration 1

=== Iteration 2/300 ===
Sun Nov 16 02:50:55 PM CET 2025: Starting resource allocation negotiation iteration 2
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.96s (total since entry 14.69s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.76s (total since entry 6.28s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=70, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_a made offer GPU=50, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=30 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=35, CPU=25 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=35, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=430.00, marketing=410.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=138.93, marketing=148.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=430.00 - BATNA=291.07 = surplus=138.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=410.00 - BATNA=261.96 = surplus=148.04
âœ… Calculated utility_surplus: {'model_a': 138.9325, 'model_b': 148.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 430, 'model_b': 410}
Metrics: {'utility_surplus': {'model_a': 138.9325, 'model_b': 148.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 2 completed successfully
Sun Nov 16 02:51:26 PM CET 2025: Completed iteration 2

=== Iteration 3/300 ===
Sun Nov 16 02:51:26 PM CET 2025: Starting resource allocation negotiation iteration 3
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.20s (total since entry 13.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
13, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.39s (total since entry 5.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=15 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=22 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=103.30, marketing=121.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=258.03 = surplus=121.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=286.70 = surplus=103.30
âœ… Calculated utility_surplus: {'model_a': 121.96866125000003, 'model_b': 103.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 121.96866125000003, 'model_b': 103.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 3 completed successfully
Sun Nov 16 02:52:07 PM CET 2025: Completed iteration 3

=== Iteration 4/300 ===
Sun Nov 16 02:52:07 PM CET 2025: Starting resource allocation negotiation iteration 4
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.47s (total since entry 14.21s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.45s (total since entry 5.96s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=20, CPU=10 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=15 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=30 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=98.93, marketing=118.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=390.00 - BATNA=291.07 = surplus=98.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=380.00 - BATNA=261.96 = surplus=118.04
âœ… Calculated utility_surplus: {'model_a': 98.9325, 'model_b': 118.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 390, 'model_b': 380}
Metrics: {'utility_surplus': {'model_a': 98.9325, 'model_b': 118.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 4 completed successfully
Sun Nov 16 02:52:48 PM CET 2025: Completed iteration 4

=== Iteration 5/300 ===
Sun Nov 16 02:52:48 PM CET 2025: Starting resource allocation negotiation iteration 5
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.19s (total since entry 13.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
11, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.38s (total since entry 5.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 25.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_a made offer GPU=25, CPU=30 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=50, CPU=10 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 40}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 40}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 40}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 40}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 40}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 25.0, 'cpu_hours': 40.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=25, CPU=40 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 45}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 45}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 45}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 45}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 45}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 45.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=15 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=20, CPU=45 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=35, CPU=15 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=35, CPU=15
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=370.00, marketing=330.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=83.30, marketing=71.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=330.00 - BATNA=258.03 = surplus=71.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=370.00 - BATNA=286.70 = surplus=83.30
âœ… Calculated utility_surplus: {'model_a': 71.96866125000003, 'model_b': 83.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 370, 'model_a': 330}
Metrics: {'utility_surplus': {'model_a': 71.96866125000003, 'model_b': 83.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 5 completed successfully
Sun Nov 16 02:53:23 PM CET 2025: Completed iteration 5

=== Iteration 6/300 ===
Sun Nov 16 02:53:23 PM CET 2025: Starting resource allocation negotiation iteration 6
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.19s (total since entry 13.94s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.40s (total since entry 5.95s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 1)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 1 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=300.00, marketing=270.00
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=90.00, marketing=110.00
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=270.00 = surplus=110.00
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=300.00 = surplus=90.00
âœ… Calculated utility_surplus: {'model_a': 110.0, 'model_b': 90.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 110.0, 'model_b': 90.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 6 completed successfully
Sun Nov 16 02:54:00 PM CET 2025: Completed iteration 6

=== Iteration 7/300 ===
Sun Nov 16 02:54:00 PM CET 2025: Starting resource allocation negotiation iteration 7
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.14s (total since entry 13.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
24, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.41s (total since entry 5.94s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
13, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 35}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 35}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 35}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 35}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 35}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 35.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=20, CPU=35 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered GPU=30, CPU=25 - Creating automatic agreement!
ğŸ” [RESOURCE DEBUG] Agreement in round 3: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from round 3
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=98.93, marketing=118.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=261.96 = surplus=118.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=291.07 = surplus=98.93
âœ… Calculated utility_surplus: {'model_a': 118.03924999999998, 'model_b': 98.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 118.03924999999998, 'model_b': 98.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 7 completed successfully
Sun Nov 16 02:54:32 PM CET 2025: Completed iteration 7

=== Iteration 8/300 ===
Sun Nov 16 02:54:32 PM CET 2025: Starting resource allocation negotiation iteration 8
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.16s (total since entry 13.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.39s (total since entry 5.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=20, CPU=10 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=30 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=30 (made in round 2)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=30, CPU=30
ğŸ” [BATNA DEBUG] Using BATNA from offer round 2 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=295.50, marketing=265.95
ğŸ” [UTILITY DEBUG] Utilities: development=420.00, marketing=420.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=124.50, marketing=154.05
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=420.00 - BATNA=265.95 = surplus=154.05
ğŸ’° [UTILITY SURPLUS] model_b: utility=420.00 - BATNA=295.50 = surplus=124.50
âœ… Calculated utility_surplus: {'model_a': 154.05, 'model_b': 124.5}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 420, 'model_a': 420}
Metrics: {'utility_surplus': {'model_a': 154.05, 'model_b': 124.5}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 8 completed successfully
Sun Nov 16 02:55:03 PM CET 2025: Completed iteration 8

=== Iteration 9/300 ===
Sun Nov 16 02:55:03 PM CET 2025: Starting resource allocation negotiation iteration 9
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.16s (total since entry 13.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.39s (total since entry 5.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
11, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 25.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_a made offer GPU=25, CPU=30 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=25, CPU=30 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=25, CPU=30
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=380.00, marketing=390.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=88.93, marketing=128.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=390.00 - BATNA=261.96 = surplus=128.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=380.00 - BATNA=291.07 = surplus=88.93
âœ… Calculated utility_surplus: {'model_a': 128.03924999999998, 'model_b': 88.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 380, 'model_a': 390}
Metrics: {'utility_surplus': {'model_a': 128.03924999999998, 'model_b': 88.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 9 completed successfully
Sun Nov 16 02:55:40 PM CET 2025: Completed iteration 9

=== Iteration 10/300 ===
Sun Nov 16 02:55:40 PM CET 2025: Starting resource allocation negotiation iteration 10
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.16s (total since entry 13.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.39s (total since entry 5.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
15, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=20, CPU=10 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 27.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=27 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 27.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=27 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=40, CPU=20 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=40, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=440.00, marketing=400.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=148.93, marketing=138.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=261.96 = surplus=138.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=440.00 - BATNA=291.07 = surplus=148.93
âœ… Calculated utility_surplus: {'model_a': 138.03924999999998, 'model_b': 148.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 440, 'model_a': 400}
Metrics: {'utility_surplus': {'model_a': 138.03924999999998, 'model_b': 148.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 10 completed successfully
Sun Nov 16 02:56:20 PM CET 2025: Completed iteration 10

=== Iteration 11/300 ===
Sun Nov 16 02:56:20 PM CET 2025: Starting resource allocation negotiation iteration 11
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.19s (total since entry 13.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.43s (total since entry 5.95s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 33.0, 'cpu_hours': 24.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 27.0}
ğŸ’¡ Player model_b made offer GPU=33, CPU=24 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=27 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 24.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=27 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=27
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=402.00, marketing=396.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=110.93, marketing=134.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=396.00 - BATNA=261.96 = surplus=134.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=402.00 - BATNA=291.07 = surplus=110.93
âœ… Calculated utility_surplus: {'model_a': 134.03924999999998, 'model_b': 110.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 402, 'model_a': 396}
Metrics: {'utility_surplus': {'model_a': 134.03924999999998, 'model_b': 110.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 11 completed successfully
Sun Nov 16 02:57:00 PM CET 2025: Completed iteration 11

=== Iteration 12/300 ===
Sun Nov 16 02:57:00 PM CET 2025: Starting resource allocation negotiation iteration 12
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.15s (total since entry 13.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.40s (total since entry 6.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 0}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 0}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 0}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 75, 'cpu_hours': 0}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 75, 'cpu_hours': 0}
[DEBUG] Validation error: Invalid action type 'offer' for game 'resource_allocation'
[DEBUG] Raw response: {"type": "offer", "gpu_hours": 75, "cpu_hours": 0}
âš ï¸ [DEBUG] [model_a] Pydantic validation failed, using original: Action validation failed: Invalid action type 'offer' for game 'resource_allocation'
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=20, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 24}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 37, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 37, 'cpu_hours': 24}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 37.0, 'cpu_hours': 24.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=20 (made in round 2)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 2 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=295.50, marketing=265.95
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=104.50, marketing=104.05
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=295.50 = surplus=104.50
ğŸ’° [UTILITY SURPLUS] model_b: utility=370.00 - BATNA=265.95 = surplus=104.05
âœ… Calculated utility_surplus: {'model_a': 104.5, 'model_b': 104.05000000000001}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 400, 'model_b': 370}
Metrics: {'utility_surplus': {'model_a': 104.5, 'model_b': 104.05000000000001}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 12 completed successfully
Sun Nov 16 02:57:39 PM CET 2025: Completed iteration 12

=== Iteration 13/300 ===
Sun Nov 16 02:57:39 PM CET 2025: Starting resource allocation negotiation iteration 13
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.18s (total since entry 13.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
11, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.41s (total since entry 5.93s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 27.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=27 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 37, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 37, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 37.0, 'cpu_hours': 23.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_b made offer GPU=37, CPU=23 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=30 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=40, CPU=20 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=40, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=440.00, marketing=400.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=153.30, marketing=141.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=258.03 = surplus=141.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=440.00 - BATNA=286.70 = surplus=153.30
âœ… Calculated utility_surplus: {'model_a': 141.96866125000003, 'model_b': 153.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 440, 'model_a': 400}
Metrics: {'utility_surplus': {'model_a': 141.96866125000003, 'model_b': 153.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 13 completed successfully
Sun Nov 16 02:58:19 PM CET 2025: Completed iteration 13

=== Iteration 14/300 ===
Sun Nov 16 02:58:19 PM CET 2025: Starting resource allocation negotiation iteration 14
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.19s (total since entry 13.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.41s (total since entry 5.93s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
12, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "gpu_hours": 35,\n    "cpu_hours": 22\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "gpu_hours": 35,\n    "cpu_hours": 22\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "gpu_hours": 35,\n    "cpu_hours": 22\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered GPU=35, CPU=20 - Creating automatic agreement!
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=113.30, marketing=111.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=370.00 - BATNA=258.03 = surplus=111.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=286.70 = surplus=113.30
âœ… Calculated utility_surplus: {'model_a': 111.96866125000003, 'model_b': 113.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 400, 'model_a': 370}
Metrics: {'utility_surplus': {'model_a': 111.96866125000003, 'model_b': 113.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 14 completed successfully
Sun Nov 16 02:58:56 PM CET 2025: Completed iteration 14

=== Iteration 15/300 ===
Sun Nov 16 02:58:56 PM CET 2025: Starting resource allocation negotiation iteration 15
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.89s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.19s (total since entry 14.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
14, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.39s (total since entry 5.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 40.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.5}
ğŸ’¡ Player model_a made offer GPU=20, CPU=40 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=22.5 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 18}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 18}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 18}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 37, 'cpu_hours': 18}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 37, 'cpu_hours': 18}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 37.0, 'cpu_hours': 18.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=37, CPU=18 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=103.30, marketing=121.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=258.03 = surplus=121.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=286.70 = surplus=103.30
âœ… Calculated utility_surplus: {'model_a': 121.96866125000003, 'model_b': 103.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 121.96866125000003, 'model_b': 103.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 15 completed successfully
Sun Nov 16 02:59:37 PM CET 2025: Completed iteration 15

=== Iteration 16/300 ===
Sun Nov 16 02:59:37 PM CET 2025: Starting resource allocation negotiation iteration 16
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.19s (total since entry 13.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
5, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.38s (total since entry 5.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 40}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 40}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 40}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 40}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 40}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 25.0, 'cpu_hours': 40.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=25, CPU=40 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=50, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 50}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 50}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 50}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 50}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 50}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 25.0, 'cpu_hours': 50.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=25, CPU=50 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=30 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=30 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=30
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=420.00, marketing=420.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=133.30, marketing=161.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=420.00 - BATNA=258.03 = surplus=161.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=420.00 - BATNA=286.70 = surplus=133.30
âœ… Calculated utility_surplus: {'model_a': 161.96866125000003, 'model_b': 133.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 420, 'model_a': 420}
Metrics: {'utility_surplus': {'model_a': 161.96866125000003, 'model_b': 133.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 16 completed successfully
Sun Nov 16 03:00:18 PM CET 2025: Completed iteration 16

=== Iteration 17/300 ===
Sun Nov 16 03:00:18 PM CET 2025: Starting resource allocation negotiation iteration 17
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.20s (total since entry 13.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
19, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.39s (total since entry 5.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 23.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=32, CPU=23 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 33.0, 'cpu_hours': 24.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=33, CPU=24 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 36, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 36, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 36, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 36, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 36, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 36.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=36, CPU=22 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=103.30, marketing=121.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=258.03 = surplus=121.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=286.70 = surplus=103.30
âœ… Calculated utility_surplus: {'model_a': 121.96866125000003, 'model_b': 103.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 121.96866125000003, 'model_b': 103.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 17 completed successfully
Sun Nov 16 03:00:57 PM CET 2025: Completed iteration 17

=== Iteration 18/300 ===
Sun Nov 16 03:00:57 PM CET 2025: Starting resource allocation negotiation iteration 18
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.33s (total since entry 14.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.38s (total since entry 5.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
10, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=50, CPU=10 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 25.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=25 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=25, CPU=30 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=25, CPU=30 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=25, CPU=30
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=380.00, marketing=390.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=93.30, marketing=131.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=390.00 - BATNA=258.03 = surplus=131.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=380.00 - BATNA=286.70 = surplus=93.30
âœ… Calculated utility_surplus: {'model_a': 131.96866125000003, 'model_b': 93.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 380, 'model_a': 390}
Metrics: {'utility_surplus': {'model_a': 131.96866125000003, 'model_b': 93.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 18 completed successfully
Sun Nov 16 03:01:43 PM CET 2025: Completed iteration 18

=== Iteration 19/300 ===
Sun Nov 16 03:01:43 PM CET 2025: Starting resource allocation negotiation iteration 19
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.18s (total since entry 13.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.38s (total since entry 5.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
12, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=45, CPU=10 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=50, CPU=15 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=98.93, marketing=118.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=261.96 = surplus=118.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=291.07 = surplus=98.93
âœ… Calculated utility_surplus: {'model_a': 118.03924999999998, 'model_b': 98.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 118.03924999999998, 'model_b': 98.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 19 completed successfully
Sun Nov 16 03:02:19 PM CET 2025: Completed iteration 19

=== Iteration 20/300 ===
Sun Nov 16 03:02:19 PM CET 2025: Starting resource allocation negotiation iteration 20
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.17s (total since entry 13.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.57s (total since entry 6.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=20, CPU=30 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=98.93, marketing=118.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=390.00 - BATNA=291.07 = surplus=98.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=380.00 - BATNA=261.96 = surplus=118.04
âœ… Calculated utility_surplus: {'model_a': 98.9325, 'model_b': 118.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 390, 'model_b': 380}
Metrics: {'utility_surplus': {'model_a': 98.9325, 'model_b': 118.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 20 completed successfully
Sun Nov 16 03:02:57 PM CET 2025: Completed iteration 20

=== Iteration 21/300 ===
Sun Nov 16 03:02:57 PM CET 2025: Starting resource allocation negotiation iteration 21
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.20s (total since entry 13.94s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
15, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.40s (total since entry 5.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=70, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=50, CPU=15 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=20 (made in round 2)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 2 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=295.50, marketing=265.95
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=104.50, marketing=104.05
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=295.50 = surplus=104.50
ğŸ’° [UTILITY SURPLUS] model_b: utility=370.00 - BATNA=265.95 = surplus=104.05
âœ… Calculated utility_surplus: {'model_a': 104.5, 'model_b': 104.05000000000001}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 400, 'model_b': 370}
Metrics: {'utility_surplus': {'model_a': 104.5, 'model_b': 104.05000000000001}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 21 completed successfully
Sun Nov 16 03:03:34 PM CET 2025: Completed iteration 21

=== Iteration 22/300 ===
Sun Nov 16 03:03:34 PM CET 2025: Starting resource allocation negotiation iteration 22
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.18s (total since entry 13.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.39s (total since entry 5.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=20, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=15 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "gpu_hours": 50,\n    "cpu_hours": 10\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "gpu_hours": 50,\n    "cpu_hours": 10\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "gpu_hours": 50,\n    "cpu_hours": 10\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=50, CPU=10 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=98.93, marketing=118.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=261.96 = surplus=118.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=291.07 = surplus=98.93
âœ… Calculated utility_surplus: {'model_a': 118.03924999999998, 'model_b': 98.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 118.03924999999998, 'model_b': 98.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 22 completed successfully
Sun Nov 16 03:04:14 PM CET 2025: Completed iteration 22

=== Iteration 23/300 ===
Sun Nov 16 03:04:14 PM CET 2025: Starting resource allocation negotiation iteration 23
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.18s (total since entry 14.14s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.67s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.41s (total since entry 6.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
22, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=20, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 27.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=27 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 24.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=24 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=98.93, marketing=118.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=261.96 = surplus=118.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=291.07 = surplus=98.93
âœ… Calculated utility_surplus: {'model_a': 118.03924999999998, 'model_b': 98.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 118.03924999999998, 'model_b': 98.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 23 completed successfully
Sun Nov 16 03:04:52 PM CET 2025: Completed iteration 23

=== Iteration 24/300 ===
Sun Nov 16 03:04:52 PM CET 2025: Starting resource allocation negotiation iteration 24
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.93s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.16s (total since entry 14.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.40s (total since entry 5.94s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=20, CPU=30 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 35}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 35}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 35}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 35}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 35}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 35.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=35 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "gpu_hours": 40,\n  "cpu_hours": 20\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "gpu_hours": 40,\n  "cpu_hours": 20\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "gpu_hours": 40,\n  "cpu_hours": 20\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=30 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=30 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=30
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=420.00, marketing=420.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=128.93, marketing=158.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=420.00 - BATNA=261.96 = surplus=158.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=420.00 - BATNA=291.07 = surplus=128.93
âœ… Calculated utility_surplus: {'model_a': 158.03924999999998, 'model_b': 128.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 420, 'model_a': 420}
Metrics: {'utility_surplus': {'model_a': 158.03924999999998, 'model_b': 128.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 24 completed successfully
Sun Nov 16 03:05:28 PM CET 2025: Completed iteration 24

=== Iteration 25/300 ===
Sun Nov 16 03:05:28 PM CET 2025: Starting resource allocation negotiation iteration 25
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.19s (total since entry 13.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
13, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.40s (total since entry 5.93s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 33.0, 'cpu_hours': 23.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=33, CPU=23 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 31.0, 'cpu_hours': 24.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=31, CPU=24 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=98.93, marketing=118.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=261.96 = surplus=118.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=291.07 = surplus=98.93
âœ… Calculated utility_surplus: {'model_a': 118.03924999999998, 'model_b': 98.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 118.03924999999998, 'model_b': 98.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 25 completed successfully
Sun Nov 16 03:06:07 PM CET 2025: Completed iteration 25

=== Iteration 26/300 ===
Sun Nov 16 03:06:07 PM CET 2025: Starting resource allocation negotiation iteration 26
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.16s (total since entry 13.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.42s (total since entry 5.94s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 35}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 35}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 35.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=35 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 50}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 50}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 50}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 50}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 50}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 50.0}
ğŸ’¡ Player model_b made offer GPU=45, CPU=50 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 55}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 55}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 55}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 55}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 55}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 55.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=55 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=70, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.5}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22.5 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=50, CPU=30 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=50, CPU=30 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=50, CPU=30
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=580.00, marketing=540.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=293.30, marketing=281.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=580.00 - BATNA=286.70 = surplus=293.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=540.00 - BATNA=258.03 = surplus=281.97
âœ… Calculated utility_surplus: {'model_a': 293.2985125, 'model_b': 281.96866125}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 580, 'model_b': 540}
Metrics: {'utility_surplus': {'model_a': 293.2985125, 'model_b': 281.96866125}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 26 completed successfully
Sun Nov 16 03:06:45 PM CET 2025: Completed iteration 26

=== Iteration 27/300 ===
Sun Nov 16 03:06:45 PM CET 2025: Starting resource allocation negotiation iteration 27
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.11s (total since entry 13.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.40s (total since entry 5.93s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
22, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=20, CPU=15 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=30 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 35}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 35}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 35}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 35}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 35}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 25.0, 'cpu_hours': 35.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=30 (made in round 2)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=30
ğŸ” [BATNA DEBUG] Using BATNA from offer round 2 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=295.50, marketing=265.95
ğŸ” [UTILITY DEBUG] Utilities: development=420.00, marketing=420.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=124.50, marketing=154.05
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=420.00 - BATNA=265.95 = surplus=154.05
ğŸ’° [UTILITY SURPLUS] model_b: utility=420.00 - BATNA=295.50 = surplus=124.50
âœ… Calculated utility_surplus: {'model_a': 154.05, 'model_b': 124.5}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 420, 'model_a': 420}
Metrics: {'utility_surplus': {'model_a': 154.05, 'model_b': 124.5}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 27 completed successfully
Sun Nov 16 03:07:26 PM CET 2025: Completed iteration 27

=== Iteration 28/300 ===
Sun Nov 16 03:07:26 PM CET 2025: Starting resource allocation negotiation iteration 28
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.90s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.20s (total since entry 14.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
20, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.41s (total since entry 5.93s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
8, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=45, CPU=10 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 27.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=20 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=113.30, marketing=111.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=370.00 - BATNA=258.03 = surplus=111.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=286.70 = surplus=113.30
âœ… Calculated utility_surplus: {'model_a': 111.96866125000003, 'model_b': 113.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 400, 'model_a': 370}
Metrics: {'utility_surplus': {'model_a': 111.96866125000003, 'model_b': 113.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 28 completed successfully
Sun Nov 16 03:08:07 PM CET 2025: Completed iteration 28

=== Iteration 29/300 ===
Sun Nov 16 03:08:07 PM CET 2025: Starting resource allocation negotiation iteration 29
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.16s (total since entry 13.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
9, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.38s (total since entry 5.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 31.0, 'cpu_hours': 24.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=31, CPU=24 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 24.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=32, CPU=24 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=32, CPU=24 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=32, CPU=24
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=384.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=108.93, marketing=122.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=291.07 = surplus=108.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=384.00 - BATNA=261.96 = surplus=122.04
âœ… Calculated utility_surplus: {'model_a': 108.9325, 'model_b': 122.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 400, 'model_b': 384}
Metrics: {'utility_surplus': {'model_a': 108.9325, 'model_b': 122.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 29 completed successfully
Sun Nov 16 03:08:47 PM CET 2025: Completed iteration 29

=== Iteration 30/300 ===
Sun Nov 16 03:08:47 PM CET 2025: Starting resource allocation negotiation iteration 30
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.19s (total since entry 13.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
14, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.42s (total since entry 5.94s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=20, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_a made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 27}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 28, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 28, 'cpu_hours': 27}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 28.0, 'cpu_hours': 27.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=28, CPU=27 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "gpu_hours": 33,\n    "cpu_hours": 24\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "gpu_hours": 33,\n    "cpu_hours": 24\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "gpu_hours": 33,\n    "cpu_hours": 24\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 33.0, 'cpu_hours': 24.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=22 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=35, CPU=22
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=412.00, marketing=386.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=125.30, marketing=127.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=412.00 - BATNA=286.70 = surplus=125.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=386.00 - BATNA=258.03 = surplus=127.97
âœ… Calculated utility_surplus: {'model_a': 125.29851250000002, 'model_b': 127.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 412, 'model_b': 386}
Metrics: {'utility_surplus': {'model_a': 125.29851250000002, 'model_b': 127.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 30 completed successfully
Sun Nov 16 03:09:28 PM CET 2025: Completed iteration 30

=== Iteration 31/300 ===
Sun Nov 16 03:09:28 PM CET 2025: Starting resource allocation negotiation iteration 31
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.06s (total since entry 13.80s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.36s (total since entry 5.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=20, CPU=30 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=45, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 40}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 40}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 40}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 40}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 40}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 25.0, 'cpu_hours': 40.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_a made offer GPU=25, CPU=40 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=50, CPU=10 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 50}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 50}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 50}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 50}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 50}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 50.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=25, CPU=40 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=25, CPU=40
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=440.00, marketing=470.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=148.93, marketing=208.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=470.00 - BATNA=261.96 = surplus=208.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=440.00 - BATNA=291.07 = surplus=148.93
âœ… Calculated utility_surplus: {'model_a': 208.03924999999998, 'model_b': 148.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 440, 'model_a': 470}
Metrics: {'utility_surplus': {'model_a': 208.03924999999998, 'model_b': 148.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 31 completed successfully
Sun Nov 16 03:10:06 PM CET 2025: Completed iteration 31

=== Iteration 32/300 ===
Sun Nov 16 03:10:06 PM CET 2025: Starting resource allocation negotiation iteration 32
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.09s (total since entry 13.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
19, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.40s (total since entry 5.95s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
14, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 27, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 27, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 27, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 27, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 27, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 27.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 37, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 37, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 37.0, 'cpu_hours': 23.0}
ğŸ’¡ Player model_a made offer GPU=27, CPU=30 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=37, CPU=23 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 29, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 29, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 29, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 29, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 29, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 29.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=29, CPU=30 (proposal 4/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=35, CPU=20 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=113.30, marketing=111.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=370.00 - BATNA=258.03 = surplus=111.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=286.70 = surplus=113.30
âœ… Calculated utility_surplus: {'model_a': 111.96866125000003, 'model_b': 113.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 400, 'model_a': 370}
Metrics: {'utility_surplus': {'model_a': 111.96866125000003, 'model_b': 113.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 32 completed successfully
Sun Nov 16 03:10:43 PM CET 2025: Completed iteration 32

=== Iteration 33/300 ===
Sun Nov 16 03:10:43 PM CET 2025: Starting resource allocation negotiation iteration 33
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.78s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.21s (total since entry 14.00s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
11, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.44s (total since entry 5.97s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=50, CPU=30 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_b made offer GPU=45, CPU=22 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=30 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 35}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 35}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 35}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 35}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 35}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 25.0, 'cpu_hours': 35.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=25, CPU=35 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=35, CPU=20 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=108.93, marketing=108.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=370.00 - BATNA=261.96 = surplus=108.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=291.07 = surplus=108.93
âœ… Calculated utility_surplus: {'model_a': 108.03924999999998, 'model_b': 108.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 400, 'model_a': 370}
Metrics: {'utility_surplus': {'model_a': 108.03924999999998, 'model_b': 108.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 33 completed successfully
Sun Nov 16 03:11:18 PM CET 2025: Completed iteration 33

=== Iteration 34/300 ===
Sun Nov 16 03:11:18 PM CET 2025: Starting resource allocation negotiation iteration 34
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.15s (total since entry 13.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.56s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.49s (total since entry 6.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=40, CPU=20 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=40, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=440.00, marketing=400.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=153.30, marketing=141.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=258.03 = surplus=141.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=440.00 - BATNA=286.70 = surplus=153.30
âœ… Calculated utility_surplus: {'model_a': 141.96866125000003, 'model_b': 153.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 440, 'model_a': 400}
Metrics: {'utility_surplus': {'model_a': 141.96866125000003, 'model_b': 153.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 34 completed successfully
Sun Nov 16 03:11:56 PM CET 2025: Completed iteration 34

=== Iteration 35/300 ===
Sun Nov 16 03:11:56 PM CET 2025: Starting resource allocation negotiation iteration 35
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.77s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.25s (total since entry 14.03s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.50s (total since entry 6.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 27.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=27 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 26}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 26}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 26}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 26}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 26}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 26.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=26 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=35, CPU=20 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=108.93, marketing=108.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=370.00 - BATNA=261.96 = surplus=108.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=291.07 = surplus=108.93
âœ… Calculated utility_surplus: {'model_a': 108.03924999999998, 'model_b': 108.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 400, 'model_a': 370}
Metrics: {'utility_surplus': {'model_a': 108.03924999999998, 'model_b': 108.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 35 completed successfully
Sun Nov 16 03:12:35 PM CET 2025: Completed iteration 35

=== Iteration 36/300 ===
Sun Nov 16 03:12:35 PM CET 2025: Starting resource allocation negotiation iteration 36
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.79s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.48s (total since entry 14.28s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
7, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.57s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.59s (total since entry 6.16s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
8, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=70, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=45, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=50, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=30 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=40, CPU=15 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=40, CPU=15 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=40, CPU=15
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=410.00, marketing=360.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=123.30, marketing=101.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=410.00 - BATNA=286.70 = surplus=123.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=360.00 - BATNA=258.03 = surplus=101.97
âœ… Calculated utility_surplus: {'model_a': 123.29851250000002, 'model_b': 101.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 410, 'model_b': 360}
Metrics: {'utility_surplus': {'model_a': 123.29851250000002, 'model_b': 101.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 36 completed successfully
Sun Nov 16 03:13:16 PM CET 2025: Completed iteration 36

=== Iteration 37/300 ===
Sun Nov 16 03:13:16 PM CET 2025: Starting resource allocation negotiation iteration 37
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.77s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.35s (total since entry 14.14s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.49s (total since entry 6.04s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 75, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 75, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 75.0, 'cpu_hours': 25.0}
âš ï¸ Player model_a offer violates constraints: GPU=75, CPU=25
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=20, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 17}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 17}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 17}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 28, 'cpu_hours': 17}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 28, 'cpu_hours': 17}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 28.0, 'cpu_hours': 17.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=28, CPU=17 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 23.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=15 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=23 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=15 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=35, CPU=15
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=370.00, marketing=330.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=78.93, marketing=68.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=370.00 - BATNA=291.07 = surplus=78.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=330.00 - BATNA=261.96 = surplus=68.04
âœ… Calculated utility_surplus: {'model_a': 78.9325, 'model_b': 68.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 370, 'model_b': 330}
Metrics: {'utility_surplus': {'model_a': 78.9325, 'model_b': 68.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 37 completed successfully
Sun Nov 16 03:13:53 PM CET 2025: Completed iteration 37

=== Iteration 38/300 ===
Sun Nov 16 03:13:53 PM CET 2025: Starting resource allocation negotiation iteration 38
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.78s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.64s (total since entry 14.43s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.58s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.58s (total since entry 6.16s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
10, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=45, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=50, CPU=15 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=10 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=10 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=35, CPU=10
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=340.00, marketing=290.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=53.30, marketing=31.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=290.00 - BATNA=258.03 = surplus=31.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=340.00 - BATNA=286.70 = surplus=53.30
âœ… Calculated utility_surplus: {'model_a': 31.968661250000025, 'model_b': 53.298512500000015}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 340, 'model_a': 290}
Metrics: {'utility_surplus': {'model_a': 31.968661250000025, 'model_b': 53.298512500000015}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 38 completed successfully
Sun Nov 16 03:14:33 PM CET 2025: Completed iteration 38

=== Iteration 39/300 ===
Sun Nov 16 03:14:33 PM CET 2025: Starting resource allocation negotiation iteration 39
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.79s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.49s (total since entry 14.29s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
8, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.59s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.58s (total since entry 6.17s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
7, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=20, CPU=30 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=20, CPU=30 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=20, CPU=30
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=340.00, marketing=360.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=53.30, marketing=101.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=360.00 - BATNA=258.03 = surplus=101.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=340.00 - BATNA=286.70 = surplus=53.30
âœ… Calculated utility_surplus: {'model_a': 101.96866125000003, 'model_b': 53.298512500000015}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 340, 'model_a': 360}
Metrics: {'utility_surplus': {'model_a': 101.96866125000003, 'model_b': 53.298512500000015}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 39 completed successfully
Sun Nov 16 03:15:13 PM CET 2025: Completed iteration 39

=== Iteration 40/300 ===
Sun Nov 16 03:15:13 PM CET 2025: Starting resource allocation negotiation iteration 40
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.80s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.43s (total since entry 14.24s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
18, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.59s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.66s (total since entry 6.26s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=20, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 30}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 30}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=30 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=25 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=35, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=430.00, marketing=410.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=138.93, marketing=148.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=430.00 - BATNA=291.07 = surplus=138.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=410.00 - BATNA=261.96 = surplus=148.04
âœ… Calculated utility_surplus: {'model_a': 138.9325, 'model_b': 148.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 430, 'model_b': 410}
Metrics: {'utility_surplus': {'model_a': 138.9325, 'model_b': 148.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 40 completed successfully
Sun Nov 16 03:15:51 PM CET 2025: Completed iteration 40

=== Iteration 41/300 ===
Sun Nov 16 03:15:51 PM CET 2025: Starting resource allocation negotiation iteration 41
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.78s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.64s (total since entry 14.44s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.59s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.68s (total since entry 6.28s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
7, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered GPU=35, CPU=20 - Creating automatic agreement!
ğŸ” [RESOURCE DEBUG] Agreement in round 3: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from round 3
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=108.93, marketing=108.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=291.07 = surplus=108.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=370.00 - BATNA=261.96 = surplus=108.04
âœ… Calculated utility_surplus: {'model_a': 108.9325, 'model_b': 108.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 400, 'model_b': 370}
Metrics: {'utility_surplus': {'model_a': 108.9325, 'model_b': 108.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 41 completed successfully
Sun Nov 16 03:16:24 PM CET 2025: Completed iteration 41

=== Iteration 42/300 ===
Sun Nov 16 03:16:24 PM CET 2025: Starting resource allocation negotiation iteration 42
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.81s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.86s (total since entry 14.69s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.59s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.74s (total since entry 6.33s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=15 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "gpu_hours": 37,\n    "cpu_hours": 23\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "gpu_hours": 37,\n    "cpu_hours": 23\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "gpu_hours": 37,\n    "cpu_hours": 23\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 37, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 37, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 37.0, 'cpu_hours': 23.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=37, CPU=23 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=37, CPU=23 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=37, CPU=23
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=434.00, marketing=406.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=142.93, marketing=144.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=406.00 - BATNA=261.96 = surplus=144.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=434.00 - BATNA=291.07 = surplus=142.93
âœ… Calculated utility_surplus: {'model_a': 144.03924999999998, 'model_b': 142.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 434, 'model_a': 406}
Metrics: {'utility_surplus': {'model_a': 144.03924999999998, 'model_b': 142.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 42 completed successfully
Sun Nov 16 03:17:06 PM CET 2025: Completed iteration 42

=== Iteration 43/300 ===
Sun Nov 16 03:17:06 PM CET 2025: Starting resource allocation negotiation iteration 43
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.86s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.23s (total since entry 15.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.92s (total since entry 6.56s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=50, CPU=10 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 40.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=20, CPU=40 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=20, CPU=40 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=20, CPU=40
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=440.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=108.93, marketing=178.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=440.00 - BATNA=261.96 = surplus=178.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=291.07 = surplus=108.93
âœ… Calculated utility_surplus: {'model_a': 178.03924999999998, 'model_b': 108.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 400, 'model_a': 440}
Metrics: {'utility_surplus': {'model_a': 178.03924999999998, 'model_b': 108.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 43 completed successfully
Sun Nov 16 03:17:52 PM CET 2025: Completed iteration 43

=== Iteration 44/300 ===
Sun Nov 16 03:17:52 PM CET 2025: Starting resource allocation negotiation iteration 44
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.86s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.40s (total since entry 15.28s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
8, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.67s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.97s (total since entry 6.64s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.5}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=22.5 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 40.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 2)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 2 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=295.50, marketing=265.95
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=94.50, marketing=114.05
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=265.95 = surplus=114.05
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=295.50 = surplus=94.50
âœ… Calculated utility_surplus: {'model_a': 114.05000000000001, 'model_b': 94.5}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 114.05000000000001, 'model_b': 94.5}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 44 completed successfully
Sun Nov 16 03:18:36 PM CET 2025: Completed iteration 44

=== Iteration 45/300 ===
Sun Nov 16 03:18:36 PM CET 2025: Starting resource allocation negotiation iteration 45
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.87s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.41s (total since entry 15.29s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
12, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.66s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.94s (total since entry 6.60s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
16, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=70, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=30 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "accept"\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "accept"\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "accept"\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=25 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=35, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=430.00, marketing=410.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=143.30, marketing=151.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=430.00 - BATNA=286.70 = surplus=143.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=410.00 - BATNA=258.03 = surplus=151.97
âœ… Calculated utility_surplus: {'model_a': 143.29851250000002, 'model_b': 151.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 430, 'model_b': 410}
Metrics: {'utility_surplus': {'model_a': 143.29851250000002, 'model_b': 151.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 45 completed successfully
Sun Nov 16 03:19:21 PM CET 2025: Completed iteration 45

=== Iteration 46/300 ===
Sun Nov 16 03:19:21 PM CET 2025: Starting resource allocation negotiation iteration 46
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.85s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.53s (total since entry 15.40s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
19, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.68s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.95s (total since entry 6.63s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 26}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 26}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 26}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 26}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 26}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 31.0, 'cpu_hours': 26.0}
ğŸ’¡ Player model_b made offer GPU=31, CPU=26 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 24.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_a made offer GPU=32, CPU=24 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=32, CPU=24 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=32, CPU=24
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=384.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=113.30, marketing=125.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=286.70 = surplus=113.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=384.00 - BATNA=258.03 = surplus=125.97
âœ… Calculated utility_surplus: {'model_a': 113.29851250000002, 'model_b': 125.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 400, 'model_b': 384}
Metrics: {'utility_surplus': {'model_a': 113.29851250000002, 'model_b': 125.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 46 completed successfully
Sun Nov 16 03:20:13 PM CET 2025: Completed iteration 46

=== Iteration 47/300 ===
Sun Nov 16 03:20:13 PM CET 2025: Starting resource allocation negotiation iteration 47
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.83s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.25s (total since entry 15.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.96s (total since entry 6.60s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 35}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 35}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 35.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=35 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 35}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 35}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 35}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 35}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 35}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 35.0}
ğŸ’¡ Player model_a made offer GPU=50, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=45, CPU=35 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=30 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=50, CPU=15 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=20 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=108.93, marketing=108.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=291.07 = surplus=108.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=370.00 - BATNA=261.96 = surplus=108.04
âœ… Calculated utility_surplus: {'model_a': 108.9325, 'model_b': 108.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 400, 'model_b': 370}
Metrics: {'utility_surplus': {'model_a': 108.9325, 'model_b': 108.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 47 completed successfully
Sun Nov 16 03:21:00 PM CET 2025: Completed iteration 47

=== Iteration 48/300 ===
Sun Nov 16 03:21:00 PM CET 2025: Starting resource allocation negotiation iteration 48
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.91s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.36s (total since entry 15.29s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.96s (total since entry 6.64s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
14, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 17}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 17}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 17}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 17}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 17}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 17.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=17 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 24.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=24 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 34, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 34, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 34.0, 'cpu_hours': 23.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=34, CPU=23 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "accept"\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "accept"\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "accept"\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=103.30, marketing=121.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=258.03 = surplus=121.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=286.70 = surplus=103.30
âœ… Calculated utility_surplus: {'model_a': 121.96866125000003, 'model_b': 103.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 121.96866125000003, 'model_b': 103.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 48 completed successfully
Sun Nov 16 03:21:49 PM CET 2025: Completed iteration 48

=== Iteration 49/300 ===
Sun Nov 16 03:21:49 PM CET 2025: Starting resource allocation negotiation iteration 49
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.90s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.56s (total since entry 15.47s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.02s (total since entry 6.73s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
14, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 27.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=27 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 24.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=24 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=30 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=32, CPU=24 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=32, CPU=24
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=384.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=113.30, marketing=125.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=384.00 - BATNA=258.03 = surplus=125.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=286.70 = surplus=113.30
âœ… Calculated utility_surplus: {'model_a': 125.96866125000003, 'model_b': 113.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 400, 'model_a': 384}
Metrics: {'utility_surplus': {'model_a': 125.96866125000003, 'model_b': 113.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 49 completed successfully
Sun Nov 16 03:22:27 PM CET 2025: Completed iteration 49

=== Iteration 50/300 ===
Sun Nov 16 03:22:27 PM CET 2025: Starting resource allocation negotiation iteration 50
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.92s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.76s (total since entry 15.69s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.07s (total since entry 6.78s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 5, "cpu_hours": 95}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 5, "cpu_hours": 95}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 5, "cpu_hours": 95}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 5, 'cpu_hours': 95}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 5, 'cpu_hours': 95}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 5.0, 'cpu_hours': 95.0}
âš ï¸ Player model_a offer violates constraints: GPU=5, CPU=95
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered GPU=35, CPU=20 - Creating automatic agreement!
ğŸ” [RESOURCE DEBUG] Agreement in round 2: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from round 2
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=295.50, marketing=265.95
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=104.50, marketing=104.05
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=370.00 - BATNA=265.95 = surplus=104.05
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=295.50 = surplus=104.50
âœ… Calculated utility_surplus: {'model_a': 104.05000000000001, 'model_b': 104.5}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 400, 'model_a': 370}
Metrics: {'utility_surplus': {'model_a': 104.05000000000001, 'model_b': 104.5}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 50 completed successfully
Sun Nov 16 03:23:06 PM CET 2025: Completed iteration 50

=== Iteration 51/300 ===
Sun Nov 16 03:23:06 PM CET 2025: Starting resource allocation negotiation iteration 51
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.92s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.82s (total since entry 15.76s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
18, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.76s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.13s (total since entry 6.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=30 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=30 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=15 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=35, CPU=15 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=35, CPU=15
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=370.00, marketing=330.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=78.93, marketing=68.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=330.00 - BATNA=261.96 = surplus=68.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=370.00 - BATNA=291.07 = surplus=78.93
âœ… Calculated utility_surplus: {'model_a': 68.03924999999998, 'model_b': 78.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 370, 'model_a': 330}
Metrics: {'utility_surplus': {'model_a': 68.03924999999998, 'model_b': 78.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 51 completed successfully
Sun Nov 16 03:23:54 PM CET 2025: Completed iteration 51

=== Iteration 52/300 ===
Sun Nov 16 03:23:54 PM CET 2025: Starting resource allocation negotiation iteration 52
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.84s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.22s (total since entry 15.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.66s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.99s (total since entry 6.65s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
16, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 75, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 75, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 75.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=75, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=45, CPU=15 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=70, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=70, CPU=15 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=35, CPU=20 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=108.93, marketing=108.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=291.07 = surplus=108.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=370.00 - BATNA=261.96 = surplus=108.04
âœ… Calculated utility_surplus: {'model_a': 108.9325, 'model_b': 108.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 400, 'model_b': 370}
Metrics: {'utility_surplus': {'model_a': 108.9325, 'model_b': 108.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 52 completed successfully
Sun Nov 16 03:24:41 PM CET 2025: Completed iteration 52

=== Iteration 53/300 ===
Sun Nov 16 03:24:41 PM CET 2025: Starting resource allocation negotiation iteration 53
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.21s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.31s (total since entry 15.54s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
18, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.90s (total since entry 6.52s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
8, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 40.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=20, CPU=40 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered GPU=35, CPU=20 - Creating automatic agreement!
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=113.30, marketing=111.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=286.70 = surplus=113.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=370.00 - BATNA=258.03 = surplus=111.97
âœ… Calculated utility_surplus: {'model_a': 113.29851250000002, 'model_b': 111.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 400, 'model_b': 370}
Metrics: {'utility_surplus': {'model_a': 113.29851250000002, 'model_b': 111.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 53 completed successfully
Sun Nov 16 03:25:19 PM CET 2025: Completed iteration 53

=== Iteration 54/300 ===
Sun Nov 16 03:25:19 PM CET 2025: Starting resource allocation negotiation iteration 54
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.85s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.09s (total since entry 14.96s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.66s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.88s (total since entry 6.53s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 5}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 5.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=70, CPU=5 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=20, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=25 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=40, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_a made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=32, CPU=28 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=32, CPU=28
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=424.00, marketing=416.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=132.93, marketing=154.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=424.00 - BATNA=291.07 = surplus=132.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=416.00 - BATNA=261.96 = surplus=154.04
âœ… Calculated utility_surplus: {'model_a': 132.9325, 'model_b': 154.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 424, 'model_b': 416}
Metrics: {'utility_surplus': {'model_a': 132.9325, 'model_b': 154.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 54 completed successfully
Sun Nov 16 03:26:01 PM CET 2025: Completed iteration 54

=== Iteration 55/300 ===
Sun Nov 16 03:26:01 PM CET 2025: Starting resource allocation negotiation iteration 55
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.90s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.37s (total since entry 15.29s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.68s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.87s (total since entry 6.55s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=45, CPU=10 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=103.30, marketing=121.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=258.03 = surplus=121.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=286.70 = surplus=103.30
âœ… Calculated utility_surplus: {'model_a': 121.96866125000003, 'model_b': 103.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 121.96866125000003, 'model_b': 103.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 55 completed successfully
Sun Nov 16 03:26:47 PM CET 2025: Completed iteration 55

=== Iteration 56/300 ===
Sun Nov 16 03:26:47 PM CET 2025: Starting resource allocation negotiation iteration 56
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.87s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.78s (total since entry 14.67s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.68s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.85s (total since entry 6.53s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
19, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=50, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=30 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 2)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 2 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=295.50, marketing=265.95
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=94.50, marketing=114.05
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=265.95 = surplus=114.05
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=295.50 = surplus=94.50
âœ… Calculated utility_surplus: {'model_a': 114.05000000000001, 'model_b': 94.5}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 114.05000000000001, 'model_b': 94.5}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 56 completed successfully
Sun Nov 16 03:27:32 PM CET 2025: Completed iteration 56

=== Iteration 57/300 ===
Sun Nov 16 03:27:32 PM CET 2025: Starting resource allocation negotiation iteration 57
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.91s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.33s (total since entry 15.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
12, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.98s (total since entry 6.67s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 5}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 5.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=70, CPU=5 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_a made offer GPU=60, CPU=10 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=60, CPU=10 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered GPU=60, CPU=10 - Creating automatic agreement!
ğŸ” [RESOURCE DEBUG] Agreement in round 2: GPU=60, CPU=10
ğŸ” [BATNA DEBUG] Using BATNA from round 2
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=295.50, marketing=265.95
ğŸ” [UTILITY DEBUG] Utilities: development=540.00, marketing=440.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=244.50, marketing=174.05
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=540.00 - BATNA=295.50 = surplus=244.50
ğŸ’° [UTILITY SURPLUS] model_b: utility=440.00 - BATNA=265.95 = surplus=174.05
âœ… Calculated utility_surplus: {'model_a': 244.5, 'model_b': 174.05}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 540, 'model_b': 440}
Metrics: {'utility_surplus': {'model_a': 244.5, 'model_b': 174.05}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 57 completed successfully
Sun Nov 16 03:28:04 PM CET 2025: Completed iteration 57

=== Iteration 58/300 ===
Sun Nov 16 03:28:04 PM CET 2025: Starting resource allocation negotiation iteration 58
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.92s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.85s (total since entry 15.79s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.68s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.00s (total since entry 6.69s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
9, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.5}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22.5 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=40, CPU=15 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=40, CPU=15
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=410.00, marketing=360.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=118.93, marketing=98.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=360.00 - BATNA=261.96 = surplus=98.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=410.00 - BATNA=291.07 = surplus=118.93
âœ… Calculated utility_surplus: {'model_a': 98.03924999999998, 'model_b': 118.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 410, 'model_a': 360}
Metrics: {'utility_surplus': {'model_a': 98.03924999999998, 'model_b': 118.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 58 completed successfully
Sun Nov 16 03:28:50 PM CET 2025: Completed iteration 58

=== Iteration 59/300 ===
Sun Nov 16 03:28:50 PM CET 2025: Starting resource allocation negotiation iteration 59
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.49s (total since entry 15.45s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
15, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.92s (total since entry 6.66s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=50, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "gpu_hours": 35,\n    "cpu_hours": 22\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "gpu_hours": 35,\n    "cpu_hours": 22\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "gpu_hours": 35,\n    "cpu_hours": 22\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 2)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 2 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=295.50, marketing=265.95
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=94.50, marketing=114.05
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=265.95 = surplus=114.05
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=295.50 = surplus=94.50
âœ… Calculated utility_surplus: {'model_a': 114.05000000000001, 'model_b': 94.5}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 114.05000000000001, 'model_b': 94.5}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 59 completed successfully
Sun Nov 16 03:29:33 PM CET 2025: Completed iteration 59

=== Iteration 60/300 ===
Sun Nov 16 03:29:33 PM CET 2025: Starting resource allocation negotiation iteration 60
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.86s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.44s (total since entry 15.32s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
15, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.66s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.92s (total since entry 6.58s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
16, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 35}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 35}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 35}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 35}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 35}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 25.0, 'cpu_hours': 35.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_a made offer GPU=25, CPU=35 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 24.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=32, CPU=24 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=25, CPU=35 (made in round 2)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=25, CPU=35
ğŸ” [BATNA DEBUG] Using BATNA from offer round 2 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=295.50, marketing=265.95
ğŸ” [UTILITY DEBUG] Utilities: development=410.00, marketing=430.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=114.50, marketing=164.05
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=430.00 - BATNA=265.95 = surplus=164.05
ğŸ’° [UTILITY SURPLUS] model_b: utility=410.00 - BATNA=295.50 = surplus=114.50
âœ… Calculated utility_surplus: {'model_a': 164.05, 'model_b': 114.5}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 410, 'model_a': 430}
Metrics: {'utility_surplus': {'model_a': 164.05, 'model_b': 114.5}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 60 completed successfully
Sun Nov 16 03:30:11 PM CET 2025: Completed iteration 60

=== Iteration 61/300 ===
Sun Nov 16 03:30:11 PM CET 2025: Starting resource allocation negotiation iteration 61
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.91s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.48s (total since entry 15.41s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
19, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.02s (total since entry 6.72s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
5, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=20, CPU=15 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 27.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=27 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 35}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 35}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 35}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 35}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 35}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 25.0, 'cpu_hours': 35.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=25, CPU=35 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=30, CPU=25 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=30, CPU=25 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=103.30, marketing=121.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=258.03 = surplus=121.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=286.70 = surplus=103.30
âœ… Calculated utility_surplus: {'model_a': 121.96866125000003, 'model_b': 103.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 121.96866125000003, 'model_b': 103.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 61 completed successfully
Sun Nov 16 03:30:51 PM CET 2025: Completed iteration 61

=== Iteration 62/300 ===
Sun Nov 16 03:30:51 PM CET 2025: Starting resource allocation negotiation iteration 62
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.91s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.54s (total since entry 15.47s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.01s (total since entry 6.73s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=20, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=45, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=98.93, marketing=118.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=261.96 = surplus=118.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=291.07 = surplus=98.93
âœ… Calculated utility_surplus: {'model_a': 118.03924999999998, 'model_b': 98.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 118.03924999999998, 'model_b': 98.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 62 completed successfully
Sun Nov 16 03:31:33 PM CET 2025: Completed iteration 62

=== Iteration 63/300 ===
Sun Nov 16 03:31:33 PM CET 2025: Starting resource allocation negotiation iteration 63
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.93s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.38s (total since entry 15.33s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.97s (total since entry 6.66s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=30 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=98.93, marketing=118.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=261.96 = surplus=118.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=291.07 = surplus=98.93
âœ… Calculated utility_surplus: {'model_a': 118.03924999999998, 'model_b': 98.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 118.03924999999998, 'model_b': 98.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 63 completed successfully
Sun Nov 16 03:32:13 PM CET 2025: Completed iteration 63

=== Iteration 64/300 ===
Sun Nov 16 03:32:13 PM CET 2025: Starting resource allocation negotiation iteration 64
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.89s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.31s (total since entry 15.21s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.67s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.94s (total since entry 6.61s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
5, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=45, CPU=15 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=40, CPU=10 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=40, CPU=10
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=380.00, marketing=320.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=93.30, marketing=61.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=320.00 - BATNA=258.03 = surplus=61.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=380.00 - BATNA=286.70 = surplus=93.30
âœ… Calculated utility_surplus: {'model_a': 61.968661250000025, 'model_b': 93.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 380, 'model_a': 320}
Metrics: {'utility_surplus': {'model_a': 61.968661250000025, 'model_b': 93.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 64 completed successfully
Sun Nov 16 03:32:58 PM CET 2025: Completed iteration 64

=== Iteration 65/300 ===
Sun Nov 16 03:32:58 PM CET 2025: Starting resource allocation negotiation iteration 65
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.92s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.43s (total since entry 15.37s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.85s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.95s (total since entry 6.80s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
6, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 5}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 5.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=70, CPU=5 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=20, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 5}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 5}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 5}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 75, 'cpu_hours': 5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 75, 'cpu_hours': 5}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 75.0, 'cpu_hours': 5.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=75, CPU=5 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 5}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 5}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 5}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 75, 'cpu_hours': 5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 75, 'cpu_hours': 5}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 75.0, 'cpu_hours': 5.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=75, CPU=5 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=40, CPU=20 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=40, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=440.00, marketing=400.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=148.93, marketing=138.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=440.00 - BATNA=291.07 = surplus=148.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=261.96 = surplus=138.04
âœ… Calculated utility_surplus: {'model_a': 148.9325, 'model_b': 138.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 440, 'model_b': 400}
Metrics: {'utility_surplus': {'model_a': 148.9325, 'model_b': 138.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 65 completed successfully
Sun Nov 16 03:33:42 PM CET 2025: Completed iteration 65

=== Iteration 66/300 ===
Sun Nov 16 03:33:42 PM CET 2025: Starting resource allocation negotiation iteration 66
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.89s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.45s (total since entry 15.35s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.99s (total since entry 6.69s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
18, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 40.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=20, CPU=40 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=30 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=40, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=25 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=25 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered GPU=35, CPU=25 - Creating automatic agreement!
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=35, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=430.00, marketing=410.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=143.30, marketing=151.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=430.00 - BATNA=286.70 = surplus=143.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=410.00 - BATNA=258.03 = surplus=151.97
âœ… Calculated utility_surplus: {'model_a': 143.29851250000002, 'model_b': 151.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 430, 'model_b': 410}
Metrics: {'utility_surplus': {'model_a': 143.29851250000002, 'model_b': 151.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 66 completed successfully
Sun Nov 16 03:34:24 PM CET 2025: Completed iteration 66

=== Iteration 67/300 ===
Sun Nov 16 03:34:24 PM CET 2025: Starting resource allocation negotiation iteration 67
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.98s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.79s (total since entry 15.79s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.14s (total since entry 6.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
8, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 27}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 27}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 27.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=27 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=27 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=35, CPU=27
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=442.00, marketing=426.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=150.93, marketing=164.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=426.00 - BATNA=261.96 = surplus=164.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=442.00 - BATNA=291.07 = surplus=150.93
âœ… Calculated utility_surplus: {'model_a': 164.03924999999998, 'model_b': 150.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 442, 'model_a': 426}
Metrics: {'utility_surplus': {'model_a': 164.03924999999998, 'model_b': 150.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 67 completed successfully
Sun Nov 16 03:35:09 PM CET 2025: Completed iteration 67

=== Iteration 68/300 ===
Sun Nov 16 03:35:09 PM CET 2025: Starting resource allocation negotiation iteration 68
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.11s (total since entry 16.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
6, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.77s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.30s (total since entry 7.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=70, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "gpu_hours": 40,\n  "cpu_hours": 15\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "gpu_hours": 40,\n  "cpu_hours": 15\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "gpu_hours": 40,\n  "cpu_hours": 15\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=70, CPU=20 (made in round 1)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=70, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 1 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=300.00, marketing=270.00
ğŸ” [UTILITY DEBUG] Utilities: development=680.00, marketing=580.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=380.00, marketing=310.00
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=680.00 - BATNA=300.00 = surplus=380.00
ğŸ’° [UTILITY SURPLUS] model_b: utility=580.00 - BATNA=270.00 = surplus=310.00
âœ… Calculated utility_surplus: {'model_a': 380.0, 'model_b': 310.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 680, 'model_b': 580}
Metrics: {'utility_surplus': {'model_a': 380.0, 'model_b': 310.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 68 completed successfully
Sun Nov 16 03:35:55 PM CET 2025: Completed iteration 68

=== Iteration 69/300 ===
Sun Nov 16 03:35:55 PM CET 2025: Starting resource allocation negotiation iteration 69
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.07s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.08s (total since entry 16.16s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.27s (total since entry 7.02s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_b made offer GPU=50, CPU=15 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=20, CPU=30 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=30 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 38, "cpu_hours": 19}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 38, "cpu_hours": 19}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 38, "cpu_hours": 19}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 38, 'cpu_hours': 19}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 38, 'cpu_hours': 19}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 38.0, 'cpu_hours': 19.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=38, CPU=19 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=38, CPU=19 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=38, CPU=19
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=418.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=131.30, marketing=121.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=258.03 = surplus=121.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=418.00 - BATNA=286.70 = surplus=131.30
âœ… Calculated utility_surplus: {'model_a': 121.96866125000003, 'model_b': 131.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 418, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 121.96866125000003, 'model_b': 131.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 69 completed successfully
Sun Nov 16 03:36:37 PM CET 2025: Completed iteration 69

=== Iteration 70/300 ===
Sun Nov 16 03:36:37 PM CET 2025: Starting resource allocation negotiation iteration 70
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.12s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.05s (total since entry 16.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.24s (total since entry 6.99s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
8, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 40.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=20, CPU=40 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=70, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.5}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22.5 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=60, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=50, CPU=15 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=50, CPU=10 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=50, CPU=10 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=50, CPU=10
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=460.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=173.30, marketing=121.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=460.00 - BATNA=286.70 = surplus=173.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=380.00 - BATNA=258.03 = surplus=121.97
âœ… Calculated utility_surplus: {'model_a': 173.29851250000002, 'model_b': 121.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 460, 'model_b': 380}
Metrics: {'utility_surplus': {'model_a': 173.29851250000002, 'model_b': 121.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 70 completed successfully
Sun Nov 16 03:37:28 PM CET 2025: Completed iteration 70

=== Iteration 71/300 ===
Sun Nov 16 03:37:28 PM CET 2025: Starting resource allocation negotiation iteration 71
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.99s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.13s (total since entry 16.14s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.78s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.32s (total since entry 7.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=30 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=15 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=30 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type" : "accept"\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type" : "accept"\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type" : "accept"\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=30 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=30
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=420.00, marketing=420.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=133.30, marketing=161.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=420.00 - BATNA=258.03 = surplus=161.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=420.00 - BATNA=286.70 = surplus=133.30
âœ… Calculated utility_surplus: {'model_a': 161.96866125000003, 'model_b': 133.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 420, 'model_a': 420}
Metrics: {'utility_surplus': {'model_a': 161.96866125000003, 'model_b': 133.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 71 completed successfully
Sun Nov 16 03:38:22 PM CET 2025: Completed iteration 71

=== Iteration 72/300 ===
Sun Nov 16 03:38:22 PM CET 2025: Starting resource allocation negotiation iteration 72
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.23s (total since entry 16.27s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.31s (total since entry 7.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_b made offer GPU=20, CPU=15 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=20, CPU=30 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=10 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=40, CPU=20 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=40, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=440.00, marketing=400.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=148.93, marketing=138.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=261.96 = surplus=138.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=440.00 - BATNA=291.07 = surplus=148.93
âœ… Calculated utility_surplus: {'model_a': 138.03924999999998, 'model_b': 148.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 440, 'model_a': 400}
Metrics: {'utility_surplus': {'model_a': 138.03924999999998, 'model_b': 148.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 72 completed successfully
Sun Nov 16 03:39:09 PM CET 2025: Completed iteration 72

=== Iteration 73/300 ===
Sun Nov 16 03:39:09 PM CET 2025: Starting resource allocation negotiation iteration 73
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.28s (total since entry 16.33s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.27s (total since entry 7.01s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 23.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=32, CPU=23 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 33.0, 'cpu_hours': 24.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 22.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 36, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 36, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 36, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 36, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 36, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 36.0, 'cpu_hours': 24.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
â° Maximum rounds (5) reached - Ending negotiation
ğŸ² [ROLE DEBUG] No Agreement - Development=model_a, Marketing=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 73 completed successfully
Sun Nov 16 03:40:04 PM CET 2025: Completed iteration 73

=== Iteration 74/300 ===
Sun Nov 16 03:40:04 PM CET 2025: Starting resource allocation negotiation iteration 74
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.11s (total since entry 16.14s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.33s (total since entry 7.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 55}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 55}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 55}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 55}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 55}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 25.0, 'cpu_hours': 55.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=25, CPU=55 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 27, "cpu_hours": 50}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 27, "cpu_hours": 50}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 27, "cpu_hours": 50}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 27, 'cpu_hours': 50}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 27, 'cpu_hours': 50}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 27.0, 'cpu_hours': 50.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_a made offer GPU=27, CPU=50 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=40, CPU=20 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=40, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=440.00, marketing=400.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=148.93, marketing=138.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=261.96 = surplus=138.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=440.00 - BATNA=291.07 = surplus=148.93
âœ… Calculated utility_surplus: {'model_a': 138.03924999999998, 'model_b': 148.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 440, 'model_a': 400}
Metrics: {'utility_surplus': {'model_a': 138.03924999999998, 'model_b': 148.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 74 completed successfully
Sun Nov 16 03:40:46 PM CET 2025: Completed iteration 74

=== Iteration 75/300 ===
Sun Nov 16 03:40:46 PM CET 2025: Starting resource allocation negotiation iteration 75
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.05s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.26s (total since entry 16.33s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.76s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.32s (total since entry 7.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
9, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 50}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 50}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 50}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 50}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 50}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 25.0, 'cpu_hours': 50.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=25, CPU=50 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=22 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 34, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 34, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 34.0, 'cpu_hours': 23.0}
ğŸ’¡ Player model_b made offer GPU=34, CPU=23 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=103.30, marketing=121.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=258.03 = surplus=121.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=286.70 = surplus=103.30
âœ… Calculated utility_surplus: {'model_a': 121.96866125000003, 'model_b': 103.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 121.96866125000003, 'model_b': 103.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 75 completed successfully
Sun Nov 16 03:41:31 PM CET 2025: Completed iteration 75

=== Iteration 76/300 ===
Sun Nov 16 03:41:31 PM CET 2025: Starting resource allocation negotiation iteration 76
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.23s (total since entry 16.27s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.26s (total since entry 6.98s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=15 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=20 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=113.30, marketing=111.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=370.00 - BATNA=258.03 = surplus=111.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=286.70 = surplus=113.30
âœ… Calculated utility_surplus: {'model_a': 111.96866125000003, 'model_b': 113.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 400, 'model_a': 370}
Metrics: {'utility_surplus': {'model_a': 111.96866125000003, 'model_b': 113.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 76 completed successfully
Sun Nov 16 03:42:29 PM CET 2025: Completed iteration 76

=== Iteration 77/300 ===
Sun Nov 16 03:42:29 PM CET 2025: Starting resource allocation negotiation iteration 77
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.00s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.77s (total since entry 15.79s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.27s (total since entry 7.01s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 5}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 5.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=70, CPU=5 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=40, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=40, CPU=15 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=35, CPU=20 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=108.93, marketing=108.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=291.07 = surplus=108.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=370.00 - BATNA=261.96 = surplus=108.04
âœ… Calculated utility_surplus: {'model_a': 108.9325, 'model_b': 108.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 400, 'model_b': 370}
Metrics: {'utility_surplus': {'model_a': 108.9325, 'model_b': 108.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 77 completed successfully
Sun Nov 16 03:43:13 PM CET 2025: Completed iteration 77

=== Iteration 78/300 ===
Sun Nov 16 03:43:13 PM CET 2025: Starting resource allocation negotiation iteration 78
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.72s (total since entry 15.76s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
17, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.17s (total since entry 6.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
5, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=45, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=103.30, marketing=121.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=258.03 = surplus=121.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=286.70 = surplus=103.30
âœ… Calculated utility_surplus: {'model_a': 121.96866125000003, 'model_b': 103.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 121.96866125000003, 'model_b': 103.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 78 completed successfully
Sun Nov 16 03:44:06 PM CET 2025: Completed iteration 78

=== Iteration 79/300 ===
Sun Nov 16 03:44:06 PM CET 2025: Starting resource allocation negotiation iteration 79
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.00s (total since entry 16.04s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.22s (total since entry 6.97s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=50, CPU=15 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=98.93, marketing=118.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=261.96 = surplus=118.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=291.07 = surplus=98.93
âœ… Calculated utility_surplus: {'model_a': 118.03924999999998, 'model_b': 98.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 118.03924999999998, 'model_b': 98.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 79 completed successfully
Sun Nov 16 03:44:52 PM CET 2025: Completed iteration 79

=== Iteration 80/300 ===
Sun Nov 16 03:44:52 PM CET 2025: Starting resource allocation negotiation iteration 80
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.21s (total since entry 16.24s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
16, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.35s (total since entry 7.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 60}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 60}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 60}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 60}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 60}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 60.0}
âš ï¸ Player model_b offer violates constraints: GPU=40, CPU=60
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=22 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=45, CPU=10 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=45, CPU=10 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=45, CPU=10
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=420.00, marketing=350.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=128.93, marketing=88.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=420.00 - BATNA=291.07 = surplus=128.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=350.00 - BATNA=261.96 = surplus=88.04
âœ… Calculated utility_surplus: {'model_a': 128.9325, 'model_b': 88.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 420, 'model_b': 350}
Metrics: {'utility_surplus': {'model_a': 128.9325, 'model_b': 88.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 80 completed successfully
Sun Nov 16 03:45:40 PM CET 2025: Completed iteration 80

=== Iteration 81/300 ===
Sun Nov 16 03:45:40 PM CET 2025: Starting resource allocation negotiation iteration 81
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.11s (total since entry 16.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.76s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.24s (total since entry 6.99s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 24.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=24 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=45, CPU=22 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 30.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=20 (made in round 2)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 2 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=295.50, marketing=265.95
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=104.50, marketing=104.05
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=370.00 - BATNA=265.95 = surplus=104.05
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=295.50 = surplus=104.50
âœ… Calculated utility_surplus: {'model_a': 104.05000000000001, 'model_b': 104.5}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 400, 'model_a': 370}
Metrics: {'utility_surplus': {'model_a': 104.05000000000001, 'model_b': 104.5}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 81 completed successfully
Sun Nov 16 03:46:32 PM CET 2025: Completed iteration 81

=== Iteration 82/300 ===
Sun Nov 16 03:46:32 PM CET 2025: Starting resource allocation negotiation iteration 82
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.86s (total since entry 15.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.26s (total since entry 7.01s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 0}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 0}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 0}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 75, 'cpu_hours': 0}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 75, 'cpu_hours': 0}
[DEBUG] Validation error: Invalid action type 'offer' for game 'resource_allocation'
[DEBUG] Raw response: {"type": "offer", "gpu_hours": 75, "cpu_hours": 0}
âš ï¸ [DEBUG] [model_a] Pydantic validation failed, using original: Action validation failed: Invalid action type 'offer' for game 'resource_allocation'
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 34, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 34, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 34.0, 'cpu_hours': 23.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 24}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 37, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 37, 'cpu_hours': 24}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 37.0, 'cpu_hours': 24.0}
ğŸ’¡ Player model_b made offer GPU=34, CPU=23 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=37, CPU=24 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=34, CPU=23 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=34, CPU=23
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=410.00, marketing=388.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=118.93, marketing=126.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=410.00 - BATNA=291.07 = surplus=118.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=388.00 - BATNA=261.96 = surplus=126.04
âœ… Calculated utility_surplus: {'model_a': 118.9325, 'model_b': 126.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 410, 'model_b': 388}
Metrics: {'utility_surplus': {'model_a': 118.9325, 'model_b': 126.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 82 completed successfully
Sun Nov 16 03:47:19 PM CET 2025: Completed iteration 82

=== Iteration 83/300 ===
Sun Nov 16 03:47:19 PM CET 2025: Starting resource allocation negotiation iteration 83
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.69s (total since entry 15.72s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
12, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.76s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.25s (total since entry 7.01s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 75}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 75}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 75}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 75}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 75}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 25.0, 'cpu_hours': 75.0}
âš ï¸ Player model_a offer violates constraints: GPU=25, CPU=75
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=98.93, marketing=118.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=261.96 = surplus=118.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=291.07 = surplus=98.93
âœ… Calculated utility_surplus: {'model_a': 118.03924999999998, 'model_b': 98.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 118.03924999999998, 'model_b': 98.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 83 completed successfully
Sun Nov 16 03:48:07 PM CET 2025: Completed iteration 83

=== Iteration 84/300 ===
Sun Nov 16 03:48:07 PM CET 2025: Starting resource allocation negotiation iteration 84
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.99s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.86s (total since entry 16.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.63s (total since entry 7.32s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "gpu_hours": 40,\n    "cpu_hours": 20\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "gpu_hours": 40,\n    "cpu_hours": 20\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "gpu_hours": 40,\n    "cpu_hours": 20\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 27.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=27 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 29}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 29}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 29}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 29}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 29}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 29.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "gpu_hours": 35,\n    "cpu_hours": 15\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "gpu_hours": 35,\n    "cpu_hours": 15\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "gpu_hours": 35,\n    "cpu_hours": 15\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=29 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=15 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=29 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=29
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=414.00, marketing=412.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=127.30, marketing=153.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=412.00 - BATNA=258.03 = surplus=153.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=414.00 - BATNA=286.70 = surplus=127.30
âœ… Calculated utility_surplus: {'model_a': 153.96866125000003, 'model_b': 127.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 414, 'model_a': 412}
Metrics: {'utility_surplus': {'model_a': 153.96866125000003, 'model_b': 127.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 84 completed successfully
Sun Nov 16 03:48:55 PM CET 2025: Completed iteration 84

=== Iteration 85/300 ===
Sun Nov 16 03:48:55 PM CET 2025: Starting resource allocation negotiation iteration 85
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.08s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.10s (total since entry 16.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.78s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.27s (total since entry 7.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
8, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=30 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 75}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 75}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 75}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 75}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 75}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 25.0, 'cpu_hours': 75.0}
âš ï¸ Player model_a offer violates constraints: GPU=25, CPU=75
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=25 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=35, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=430.00, marketing=410.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=143.30, marketing=151.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=410.00 - BATNA=258.03 = surplus=151.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=430.00 - BATNA=286.70 = surplus=143.30
âœ… Calculated utility_surplus: {'model_a': 151.96866125000003, 'model_b': 143.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 430, 'model_a': 410}
Metrics: {'utility_surplus': {'model_a': 151.96866125000003, 'model_b': 143.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 85 completed successfully
Sun Nov 16 03:49:45 PM CET 2025: Completed iteration 85

=== Iteration 86/300 ===
Sun Nov 16 03:49:45 PM CET 2025: Starting resource allocation negotiation iteration 86
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.18s (total since entry 16.22s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
10, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.46s (total since entry 7.40s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
15, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 35}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 35}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 35.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=35 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 33.0, 'cpu_hours': 24.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 23}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 37, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 37, 'cpu_hours': 23}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 37.0, 'cpu_hours': 23.0}
ğŸ’¡ Player model_b made offer GPU=33, CPU=24 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=37, CPU=23 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 26}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 26}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 26}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 34, 'cpu_hours': 26}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 34, 'cpu_hours': 26}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 34.0, 'cpu_hours': 26.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=33, CPU=24 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=33, CPU=24
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=408.00, marketing=390.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=116.93, marketing=128.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=408.00 - BATNA=291.07 = surplus=116.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=261.96 = surplus=128.04
âœ… Calculated utility_surplus: {'model_a': 116.9325, 'model_b': 128.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 408, 'model_b': 390}
Metrics: {'utility_surplus': {'model_a': 116.9325, 'model_b': 128.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 86 completed successfully
Sun Nov 16 03:50:29 PM CET 2025: Completed iteration 86

=== Iteration 87/300 ===
Sun Nov 16 03:50:29 PM CET 2025: Starting resource allocation negotiation iteration 87
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.15s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.15s (total since entry 16.32s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
18, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.28s (total since entry 7.04s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 40.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 5}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 5}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 5}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 75, 'cpu_hours': 5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 75, 'cpu_hours': 5}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 75.0, 'cpu_hours': 5.0}
ğŸ’¡ Player model_b made offer GPU=20, CPU=40 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=75, CPU=5 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=40, CPU=30 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=45, CPU=10 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=20 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=108.93, marketing=108.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=291.07 = surplus=108.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=370.00 - BATNA=261.96 = surplus=108.04
âœ… Calculated utility_surplus: {'model_a': 108.9325, 'model_b': 108.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 400, 'model_b': 370}
Metrics: {'utility_surplus': {'model_a': 108.9325, 'model_b': 108.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 87 completed successfully
Sun Nov 16 03:51:16 PM CET 2025: Completed iteration 87

=== Iteration 88/300 ===
Sun Nov 16 03:51:16 PM CET 2025: Starting resource allocation negotiation iteration 88
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.17s (total since entry 16.21s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.36s (total since entry 7.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 40.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=20, CPU=40 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=70, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=45, CPU=10 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=50, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=103.30, marketing=121.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=390.00 - BATNA=286.70 = surplus=103.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=380.00 - BATNA=258.03 = surplus=121.97
âœ… Calculated utility_surplus: {'model_a': 103.29851250000002, 'model_b': 121.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 390, 'model_b': 380}
Metrics: {'utility_surplus': {'model_a': 103.29851250000002, 'model_b': 121.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 88 completed successfully
Sun Nov 16 03:52:04 PM CET 2025: Completed iteration 88

=== Iteration 89/300 ===
Sun Nov 16 03:52:04 PM CET 2025: Starting resource allocation negotiation iteration 89
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.04s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.20s (total since entry 16.26s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.35s (total since entry 7.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
11, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 35}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 35}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 35.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=35 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 50}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 50}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 50}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 50}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 50}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 50.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=45, CPU=50 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=45, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 35}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 35}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 35.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=35 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=98.93, marketing=118.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=390.00 - BATNA=291.07 = surplus=98.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=380.00 - BATNA=261.96 = surplus=118.04
âœ… Calculated utility_surplus: {'model_a': 98.9325, 'model_b': 118.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 390, 'model_b': 380}
Metrics: {'utility_surplus': {'model_a': 98.9325, 'model_b': 118.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 89 completed successfully
Sun Nov 16 03:52:46 PM CET 2025: Completed iteration 89

=== Iteration 90/300 ===
Sun Nov 16 03:52:46 PM CET 2025: Starting resource allocation negotiation iteration 90
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.99s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.26s (total since entry 16.27s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.40s (total since entry 7.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=50, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=45, CPU=15 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=103.30, marketing=121.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=258.03 = surplus=121.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=286.70 = surplus=103.30
âœ… Calculated utility_surplus: {'model_a': 121.96866125000003, 'model_b': 103.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 121.96866125000003, 'model_b': 103.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 90 completed successfully
Sun Nov 16 03:53:34 PM CET 2025: Completed iteration 90

=== Iteration 91/300 ===
Sun Nov 16 03:53:34 PM CET 2025: Starting resource allocation negotiation iteration 91
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.20s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.29s (total since entry 16.51s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.76s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.33s (total since entry 7.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 26}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 26}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 26}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 34, 'cpu_hours': 26}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 34, 'cpu_hours': 26}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 34.0, 'cpu_hours': 26.0}
ğŸ’¡ Player model_b made offer GPU=34, CPU=26 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 24.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "gpu_hours": 38,\n  "cpu_hours": 22\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "gpu_hours": 38,\n  "cpu_hours": 22\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "gpu_hours": 38,\n  "cpu_hours": 22\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 38, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 38, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 38.0, 'cpu_hours': 22.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 27}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 27}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 33.0, 'cpu_hours': 27.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
â° Maximum rounds (5) reached - Ending negotiation
ğŸ² [ROLE DEBUG] No Agreement - Development=model_a, Marketing=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 91 completed successfully
Sun Nov 16 03:54:29 PM CET 2025: Completed iteration 91

=== Iteration 92/300 ===
Sun Nov 16 03:54:29 PM CET 2025: Starting resource allocation negotiation iteration 92
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.29s (total since entry 16.32s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
7, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.82s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.40s (total since entry 7.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 60}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 60}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 60}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 60}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 60}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 60.0}
âš ï¸ Player model_b offer violates constraints: GPU=40, CPU=60
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 40.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=20, CPU=40 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 31.0, 'cpu_hours': 24.0}
ğŸ’¡ Player model_b made offer GPU=31, CPU=24 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 27}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 28, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 28, 'cpu_hours': 27}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 28.0, 'cpu_hours': 27.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=28, CPU=27 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 29, "cpu_hours": 26}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 29, "cpu_hours": 26}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 29, "cpu_hours": 26}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 29, 'cpu_hours': 26}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 29, 'cpu_hours': 26}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 29.0, 'cpu_hours': 26.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 24.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 23.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
â° Maximum rounds (5) reached - Ending negotiation
ğŸ² [ROLE DEBUG] No Agreement - Development=model_a, Marketing=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 92 completed successfully
Sun Nov 16 03:55:27 PM CET 2025: Completed iteration 92

=== Iteration 93/300 ===
Sun Nov 16 03:55:27 PM CET 2025: Starting resource allocation negotiation iteration 93
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.31s (total since entry 16.34s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.37s (total since entry 7.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
9, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=15 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=15 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered GPU=35, CPU=15 - Creating automatic agreement!
ğŸ” [RESOURCE DEBUG] Agreement in round 2: GPU=35, CPU=15
ğŸ” [BATNA DEBUG] Using BATNA from round 2
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=295.50, marketing=265.95
ğŸ” [UTILITY DEBUG] Utilities: development=370.00, marketing=330.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=74.50, marketing=64.05
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=370.00 - BATNA=295.50 = surplus=74.50
ğŸ’° [UTILITY SURPLUS] model_b: utility=330.00 - BATNA=265.95 = surplus=64.05
âœ… Calculated utility_surplus: {'model_a': 74.5, 'model_b': 64.05000000000001}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 370, 'model_b': 330}
Metrics: {'utility_surplus': {'model_a': 74.5, 'model_b': 64.05000000000001}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 93 completed successfully
Sun Nov 16 03:56:04 PM CET 2025: Completed iteration 93

=== Iteration 94/300 ===
Sun Nov 16 03:56:04 PM CET 2025: Starting resource allocation negotiation iteration 94
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.04s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.27s (total since entry 16.33s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.31s (total since entry 7.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=40, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered GPU=40, CPU=20 - Creating automatic agreement!
ğŸ” [RESOURCE DEBUG] Agreement in round 3: GPU=40, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from round 3
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=440.00, marketing=400.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=148.93, marketing=138.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=440.00 - BATNA=291.07 = surplus=148.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=261.96 = surplus=138.04
âœ… Calculated utility_surplus: {'model_a': 148.9325, 'model_b': 138.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 440, 'model_b': 400}
Metrics: {'utility_surplus': {'model_a': 148.9325, 'model_b': 138.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 94 completed successfully
Sun Nov 16 03:56:47 PM CET 2025: Completed iteration 94

=== Iteration 95/300 ===
Sun Nov 16 03:56:47 PM CET 2025: Starting resource allocation negotiation iteration 95
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.15s (total since entry 16.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.32s (total since entry 7.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=20, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=25 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=40, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 27}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 28, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 28, 'cpu_hours': 27}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 28.0, 'cpu_hours': 27.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=28, CPU=27 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 31.0, 'cpu_hours': 24.0}
ğŸ’¡ Player model_b made offer GPU=31, CPU=24 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=20 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=108.93, marketing=108.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=291.07 = surplus=108.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=370.00 - BATNA=261.96 = surplus=108.04
âœ… Calculated utility_surplus: {'model_a': 108.9325, 'model_b': 108.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 400, 'model_b': 370}
Metrics: {'utility_surplus': {'model_a': 108.9325, 'model_b': 108.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 95 completed successfully
Sun Nov 16 03:57:32 PM CET 2025: Completed iteration 95

=== Iteration 96/300 ===
Sun Nov 16 03:57:32 PM CET 2025: Starting resource allocation negotiation iteration 96
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.04s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.30s (total since entry 16.36s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.37s (total since entry 7.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 5, "cpu_hours": 95}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 5, "cpu_hours": 95}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 5, "cpu_hours": 95}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 5, 'cpu_hours': 95}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 5, 'cpu_hours': 95}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 5.0, 'cpu_hours': 95.0}
âš ï¸ Player model_a offer violates constraints: GPU=5, CPU=95
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 5, "cpu_hours": 90}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 5, "cpu_hours": 90}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 5, "cpu_hours": 90}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 5, 'cpu_hours': 90}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 5, 'cpu_hours': 90}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 5.0, 'cpu_hours': 90.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=5, CPU=90 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=45, CPU=10 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 35}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 35}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 35}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 35}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 35}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 25.0, 'cpu_hours': 35.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_a made offer GPU=25, CPU=35 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=35, CPU=22 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=35, CPU=22
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=412.00, marketing=386.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=125.30, marketing=127.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=386.00 - BATNA=258.03 = surplus=127.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=412.00 - BATNA=286.70 = surplus=125.30
âœ… Calculated utility_surplus: {'model_a': 127.96866125000003, 'model_b': 125.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 412, 'model_a': 386}
Metrics: {'utility_surplus': {'model_a': 127.96866125000003, 'model_b': 125.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 96 completed successfully
Sun Nov 16 03:58:13 PM CET 2025: Completed iteration 96

=== Iteration 97/300 ===
Sun Nov 16 03:58:13 PM CET 2025: Starting resource allocation negotiation iteration 97
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.27s (total since entry 16.32s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
10, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.37s (total since entry 7.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "gpu_hours": 50,\n  "cpu_hours": 20\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "gpu_hours": 50,\n  "cpu_hours": 20\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "gpu_hours": 50,\n  "cpu_hours": 20\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=50, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=98.93, marketing=118.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=261.96 = surplus=118.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=291.07 = surplus=98.93
âœ… Calculated utility_surplus: {'model_a': 118.03924999999998, 'model_b': 98.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 118.03924999999998, 'model_b': 98.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 97 completed successfully
Sun Nov 16 03:59:02 PM CET 2025: Completed iteration 97

=== Iteration 98/300 ===
Sun Nov 16 03:59:02 PM CET 2025: Starting resource allocation negotiation iteration 98
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.31s (total since entry 16.35s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
14, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.34s (total since entry 7.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=70, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.5}
ğŸ’¡ Player model_a made offer GPU=45, CPU=15 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=22.5 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=25 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=45, CPU=15 (made in round 2)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=45, CPU=15
ğŸ” [BATNA DEBUG] Using BATNA from offer round 2 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=295.50, marketing=265.95
ğŸ” [UTILITY DEBUG] Utilities: development=450.00, marketing=390.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=154.50, marketing=124.05
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=450.00 - BATNA=295.50 = surplus=154.50
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=265.95 = surplus=124.05
âœ… Calculated utility_surplus: {'model_a': 154.5, 'model_b': 124.05000000000001}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 450, 'model_b': 390}
Metrics: {'utility_surplus': {'model_a': 154.5, 'model_b': 124.05000000000001}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 98 completed successfully
Sun Nov 16 03:59:45 PM CET 2025: Completed iteration 98

=== Iteration 99/300 ===
Sun Nov 16 03:59:45 PM CET 2025: Starting resource allocation negotiation iteration 99
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.99s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.24s (total since entry 16.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.35s (total since entry 7.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
15, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered GPU=35, CPU=20 - Creating automatic agreement!
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=113.30, marketing=111.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=370.00 - BATNA=258.03 = surplus=111.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=286.70 = surplus=113.30
âœ… Calculated utility_surplus: {'model_a': 111.96866125000003, 'model_b': 113.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 400, 'model_a': 370}
Metrics: {'utility_surplus': {'model_a': 111.96866125000003, 'model_b': 113.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 99 completed successfully
Sun Nov 16 04:00:32 PM CET 2025: Completed iteration 99

=== Iteration 100/300 ===
Sun Nov 16 04:00:32 PM CET 2025: Starting resource allocation negotiation iteration 100
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.00s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.48s (total since entry 16.49s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.76s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.31s (total since entry 7.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=30 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=30 (made in round 2)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=30
ğŸ” [BATNA DEBUG] Using BATNA from offer round 2 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=295.50, marketing=265.95
ğŸ” [UTILITY DEBUG] Utilities: development=420.00, marketing=420.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=124.50, marketing=154.05
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=420.00 - BATNA=265.95 = surplus=154.05
ğŸ’° [UTILITY SURPLUS] model_b: utility=420.00 - BATNA=295.50 = surplus=124.50
âœ… Calculated utility_surplus: {'model_a': 154.05, 'model_b': 124.5}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 420, 'model_a': 420}
Metrics: {'utility_surplus': {'model_a': 154.05, 'model_b': 124.5}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 100 completed successfully
Sun Nov 16 04:01:19 PM CET 2025: Completed iteration 100

=== Iteration 101/300 ===
Sun Nov 16 04:01:19 PM CET 2025: Starting resource allocation negotiation iteration 101
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.28s (total since entry 16.32s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.41s (total since entry 7.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 40.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=20, CPU=40 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 23.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=23 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 33.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=30 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=33, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=15 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=35, CPU=15 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=35, CPU=15
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=370.00, marketing=330.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=83.30, marketing=71.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=330.00 - BATNA=258.03 = surplus=71.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=370.00 - BATNA=286.70 = surplus=83.30
âœ… Calculated utility_surplus: {'model_a': 71.96866125000003, 'model_b': 83.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 370, 'model_a': 330}
Metrics: {'utility_surplus': {'model_a': 71.96866125000003, 'model_b': 83.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 101 completed successfully
Sun Nov 16 04:02:05 PM CET 2025: Completed iteration 101

=== Iteration 102/300 ===
Sun Nov 16 04:02:05 PM CET 2025: Starting resource allocation negotiation iteration 102
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.33s (total since entry 16.36s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.78s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.35s (total since entry 7.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=20 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=108.93, marketing=108.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=370.00 - BATNA=261.96 = surplus=108.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=291.07 = surplus=108.93
âœ… Calculated utility_surplus: {'model_a': 108.03924999999998, 'model_b': 108.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 400, 'model_a': 370}
Metrics: {'utility_surplus': {'model_a': 108.03924999999998, 'model_b': 108.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 102 completed successfully
Sun Nov 16 04:02:50 PM CET 2025: Completed iteration 102

=== Iteration 103/300 ===
Sun Nov 16 04:02:50 PM CET 2025: Starting resource allocation negotiation iteration 103
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.44s (total since entry 16.48s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.32s (total since entry 7.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=20, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.5}
ğŸ’¡ Player model_a made offer GPU=40, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=22.5 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=40, CPU=20 (made in round 2)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=40, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 2 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=295.50, marketing=265.95
ğŸ” [UTILITY DEBUG] Utilities: development=440.00, marketing=400.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=144.50, marketing=134.05
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=440.00 - BATNA=295.50 = surplus=144.50
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=265.95 = surplus=134.05
âœ… Calculated utility_surplus: {'model_a': 144.5, 'model_b': 134.05}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 440, 'model_b': 400}
Metrics: {'utility_surplus': {'model_a': 144.5, 'model_b': 134.05}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 103 completed successfully
Sun Nov 16 04:03:38 PM CET 2025: Completed iteration 103

=== Iteration 104/300 ===
Sun Nov 16 04:03:38 PM CET 2025: Starting resource allocation negotiation iteration 104
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.28s (total since entry 16.31s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.34s (total since entry 7.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
12, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=20, CPU=30 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=70, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 60}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 60}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 60}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 60}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 60}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 60.0}
âš ï¸ Player model_b offer violates constraints: GPU=40, CPU=60
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=50, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=45, CPU=15 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=45, CPU=15 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=45, CPU=15
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=450.00, marketing=390.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=163.30, marketing=131.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=450.00 - BATNA=286.70 = surplus=163.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=258.03 = surplus=131.97
âœ… Calculated utility_surplus: {'model_a': 163.29851250000002, 'model_b': 131.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 450, 'model_b': 390}
Metrics: {'utility_surplus': {'model_a': 163.29851250000002, 'model_b': 131.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 104 completed successfully
Sun Nov 16 04:04:30 PM CET 2025: Completed iteration 104

=== Iteration 105/300 ===
Sun Nov 16 04:04:30 PM CET 2025: Starting resource allocation negotiation iteration 105
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.06s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.32s (total since entry 16.39s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
10, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.39s (total since entry 7.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=30 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "gpu_hours": 35,\n  "cpu_hours": 25\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "gpu_hours": 35,\n  "cpu_hours": 25\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "gpu_hours": 35,\n  "cpu_hours": 25\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=30, CPU=25 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=25 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 27}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 28, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 28, 'cpu_hours': 27}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 28.0, 'cpu_hours': 27.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=25 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=35, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=430.00, marketing=410.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=143.30, marketing=151.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=430.00 - BATNA=286.70 = surplus=143.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=410.00 - BATNA=258.03 = surplus=151.97
âœ… Calculated utility_surplus: {'model_a': 143.29851250000002, 'model_b': 151.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 430, 'model_b': 410}
Metrics: {'utility_surplus': {'model_a': 143.29851250000002, 'model_b': 151.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 105 completed successfully
Sun Nov 16 04:05:24 PM CET 2025: Completed iteration 105

=== Iteration 106/300 ===
Sun Nov 16 04:05:24 PM CET 2025: Starting resource allocation negotiation iteration 106
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.31s (total since entry 16.36s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.36s (total since entry 7.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
12, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.5}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=22.5 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 27}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 27}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 33.0, 'cpu_hours': 27.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 36, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 36, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 36, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 36, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 36, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 36.0, 'cpu_hours': 24.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=20 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=113.30, marketing=111.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=370.00 - BATNA=258.03 = surplus=111.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=286.70 = surplus=113.30
âœ… Calculated utility_surplus: {'model_a': 111.96866125000003, 'model_b': 113.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 400, 'model_a': 370}
Metrics: {'utility_surplus': {'model_a': 111.96866125000003, 'model_b': 113.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 106 completed successfully
Sun Nov 16 04:06:17 PM CET 2025: Completed iteration 106

=== Iteration 107/300 ===
Sun Nov 16 04:06:17 PM CET 2025: Starting resource allocation negotiation iteration 107
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.39s (total since entry 16.43s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.32s (total since entry 7.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_a made offer GPU=40, CPU=10 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 34, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 34, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 34.0, 'cpu_hours': 23.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=34, CPU=23 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered GPU=35, CPU=20 - Creating automatic agreement!
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=113.30, marketing=111.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=286.70 = surplus=113.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=370.00 - BATNA=258.03 = surplus=111.97
âœ… Calculated utility_surplus: {'model_a': 113.29851250000002, 'model_b': 111.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 400, 'model_b': 370}
Metrics: {'utility_surplus': {'model_a': 113.29851250000002, 'model_b': 111.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 107 completed successfully
Sun Nov 16 04:07:01 PM CET 2025: Completed iteration 107

=== Iteration 108/300 ===
Sun Nov 16 04:07:01 PM CET 2025: Starting resource allocation negotiation iteration 108
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.15s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.34s (total since entry 16.50s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
17, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.33s (total since entry 7.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 60}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 60}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 60}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 60}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 60}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 60.0}
âš ï¸ Player model_b offer violates constraints: GPU=40, CPU=60
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 27}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 27}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 27.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 27}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 27}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 27.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=27 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=32, CPU=27 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=22 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=40, CPU=22 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=40, CPU=22
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=452.00, marketing=416.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=165.30, marketing=157.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=452.00 - BATNA=286.70 = surplus=165.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=416.00 - BATNA=258.03 = surplus=157.97
âœ… Calculated utility_surplus: {'model_a': 165.29851250000002, 'model_b': 157.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 452, 'model_b': 416}
Metrics: {'utility_surplus': {'model_a': 165.29851250000002, 'model_b': 157.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 108 completed successfully
Sun Nov 16 04:07:53 PM CET 2025: Completed iteration 108

=== Iteration 109/300 ===
Sun Nov 16 04:07:53 PM CET 2025: Starting resource allocation negotiation iteration 109
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.29s (total since entry 16.33s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.36s (total since entry 7.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
17, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=20, CPU=15 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "gpu_hours": 35,\n    "cpu_hours": 20\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "gpu_hours": 35,\n    "cpu_hours": 20\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "gpu_hours": 35,\n    "cpu_hours": 20\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered GPU=35, CPU=20 - Creating automatic agreement!
ğŸ” [RESOURCE DEBUG] Agreement in round 2: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from round 2
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=295.50, marketing=265.95
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=104.50, marketing=104.05
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=295.50 = surplus=104.50
ğŸ’° [UTILITY SURPLUS] model_b: utility=370.00 - BATNA=265.95 = surplus=104.05
âœ… Calculated utility_surplus: {'model_a': 104.5, 'model_b': 104.05000000000001}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 400, 'model_b': 370}
Metrics: {'utility_surplus': {'model_a': 104.5, 'model_b': 104.05000000000001}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 109 completed successfully
Sun Nov 16 04:08:30 PM CET 2025: Completed iteration 109

=== Iteration 110/300 ===
Sun Nov 16 04:08:30 PM CET 2025: Starting resource allocation negotiation iteration 110
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.97s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.36s (total since entry 16.35s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.36s (total since entry 7.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=20, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=28 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_a made offer GPU=45, CPU=25 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=30, CPU=25 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=45, CPU=25 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=45, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=510.00, marketing=470.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=223.30, marketing=211.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=510.00 - BATNA=286.70 = surplus=223.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=470.00 - BATNA=258.03 = surplus=211.97
âœ… Calculated utility_surplus: {'model_a': 223.29851250000002, 'model_b': 211.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 510, 'model_b': 470}
Metrics: {'utility_surplus': {'model_a': 223.29851250000002, 'model_b': 211.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 110 completed successfully
Sun Nov 16 04:09:18 PM CET 2025: Completed iteration 110

=== Iteration 111/300 ===
Sun Nov 16 04:09:18 PM CET 2025: Starting resource allocation negotiation iteration 111
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.07s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.34s (total since entry 16.42s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.34s (total since entry 7.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=70, CPU=15 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=20, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=70, CPU=15 (made in round 1)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=70, CPU=15
ğŸ” [BATNA DEBUG] Using BATNA from offer round 1 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=300.00, marketing=270.00
ğŸ” [UTILITY DEBUG] Utilities: development=650.00, marketing=540.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=350.00, marketing=270.00
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=650.00 - BATNA=300.00 = surplus=350.00
ğŸ’° [UTILITY SURPLUS] model_b: utility=540.00 - BATNA=270.00 = surplus=270.00
âœ… Calculated utility_surplus: {'model_a': 350.0, 'model_b': 270.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 650, 'model_b': 540}
Metrics: {'utility_surplus': {'model_a': 350.0, 'model_b': 270.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 111 completed successfully
Sun Nov 16 04:09:58 PM CET 2025: Completed iteration 111

=== Iteration 112/300 ===
Sun Nov 16 04:09:58 PM CET 2025: Starting resource allocation negotiation iteration 112
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.27s (total since entry 16.32s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
16, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.31s (total since entry 7.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 35}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 35}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 35.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=35 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 33.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=30 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=33, CPU=28 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 29}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 29}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 29}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 29}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 29}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 31.0, 'cpu_hours': 29.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 27}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 27}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 27.0}
ğŸ’¡ Player model_b made offer GPU=31, CPU=29 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=27 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 26}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 26}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 26}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 26}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 26}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 33.0, 'cpu_hours': 26.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=33, CPU=26 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=33, CPU=26 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=33, CPU=26
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=420.00, marketing=406.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=133.30, marketing=147.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=420.00 - BATNA=286.70 = surplus=133.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=406.00 - BATNA=258.03 = surplus=147.97
âœ… Calculated utility_surplus: {'model_a': 133.29851250000002, 'model_b': 147.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 420, 'model_b': 406}
Metrics: {'utility_surplus': {'model_a': 133.29851250000002, 'model_b': 147.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 112 completed successfully
Sun Nov 16 04:10:43 PM CET 2025: Completed iteration 112

=== Iteration 113/300 ===
Sun Nov 16 04:10:43 PM CET 2025: Starting resource allocation negotiation iteration 113
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.29s (total since entry 16.31s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
9, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.32s (total since entry 7.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 1)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 1 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=300.00, marketing=270.00
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=90.00, marketing=110.00
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=270.00 = surplus=110.00
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=300.00 = surplus=90.00
âœ… Calculated utility_surplus: {'model_a': 110.0, 'model_b': 90.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 110.0, 'model_b': 90.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 113 completed successfully
Sun Nov 16 04:11:27 PM CET 2025: Completed iteration 113

=== Iteration 114/300 ===
Sun Nov 16 04:11:27 PM CET 2025: Starting resource allocation negotiation iteration 114
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.29s (total since entry 16.32s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.33s (total since entry 7.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=70, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=20, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 35}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 35}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 35.0}
ğŸ’¡ Player model_a made offer GPU=50, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=35 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 32}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 32}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 32}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 32}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 32}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 32.0}
ğŸ’¡ Player model_b made offer GPU=45, CPU=32 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 35}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 35}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 35.0}
ğŸ’¡ Player model_a made offer GPU=40, CPU=30 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=35 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=40, CPU=30 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=40, CPU=30
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=500.00, marketing=480.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=213.30, marketing=221.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=500.00 - BATNA=286.70 = surplus=213.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=480.00 - BATNA=258.03 = surplus=221.97
âœ… Calculated utility_surplus: {'model_a': 213.29851250000002, 'model_b': 221.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 500, 'model_b': 480}
Metrics: {'utility_surplus': {'model_a': 213.29851250000002, 'model_b': 221.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 114 completed successfully
Sun Nov 16 04:12:16 PM CET 2025: Completed iteration 114

=== Iteration 115/300 ===
Sun Nov 16 04:12:16 PM CET 2025: Starting resource allocation negotiation iteration 115
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.28s (total since entry 16.32s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
19, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.36s (total since entry 7.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 40.0}
ğŸ’¡ Player model_a made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=20, CPU=40 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.5}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22.5 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=45, CPU=15 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=45, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=25 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=40, CPU=20 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=40, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=440.00, marketing=400.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=153.30, marketing=141.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=440.00 - BATNA=286.70 = surplus=153.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=258.03 = surplus=141.97
âœ… Calculated utility_surplus: {'model_a': 153.29851250000002, 'model_b': 141.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 440, 'model_b': 400}
Metrics: {'utility_surplus': {'model_a': 153.29851250000002, 'model_b': 141.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 115 completed successfully
Sun Nov 16 04:12:59 PM CET 2025: Completed iteration 115

=== Iteration 116/300 ===
Sun Nov 16 04:12:59 PM CET 2025: Starting resource allocation negotiation iteration 116
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.05s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.30s (total since entry 16.37s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.34s (total since entry 7.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=20, CPU=30 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 35}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 35}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 35}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 35}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 35}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 25.0, 'cpu_hours': 35.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=25, CPU=35 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 24.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=32, CPU=24 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 33.0, 'cpu_hours': 23.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=33, CPU=23 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=20 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=113.30, marketing=111.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=286.70 = surplus=113.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=370.00 - BATNA=258.03 = surplus=111.97
âœ… Calculated utility_surplus: {'model_a': 113.29851250000002, 'model_b': 111.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 400, 'model_b': 370}
Metrics: {'utility_surplus': {'model_a': 113.29851250000002, 'model_b': 111.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 116 completed successfully
Sun Nov 16 04:13:48 PM CET 2025: Completed iteration 116

=== Iteration 117/300 ===
Sun Nov 16 04:13:48 PM CET 2025: Starting resource allocation negotiation iteration 117
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.04s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.35s (total since entry 16.40s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
8, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.37s (total since entry 7.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.5}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22.5 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=45, CPU=15 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=45, CPU=15 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered GPU=45, CPU=15 - Creating automatic agreement!
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=45, CPU=15
ğŸ” [BATNA DEBUG] Using BATNA from round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=450.00, marketing=390.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=163.30, marketing=131.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=450.00 - BATNA=286.70 = surplus=163.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=258.03 = surplus=131.97
âœ… Calculated utility_surplus: {'model_a': 163.29851250000002, 'model_b': 131.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 450, 'model_b': 390}
Metrics: {'utility_surplus': {'model_a': 163.29851250000002, 'model_b': 131.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 117 completed successfully
Sun Nov 16 04:14:30 PM CET 2025: Completed iteration 117

=== Iteration 118/300 ===
Sun Nov 16 04:14:30 PM CET 2025: Starting resource allocation negotiation iteration 118
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.30s (total since entry 16.33s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.34s (total since entry 7.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
10, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 40.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=20, CPU=40 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered GPU=35, CPU=20 - Creating automatic agreement!
ğŸ” [RESOURCE DEBUG] Agreement in round 2: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from round 2
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=295.50, marketing=265.95
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=104.50, marketing=104.05
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=295.50 = surplus=104.50
ğŸ’° [UTILITY SURPLUS] model_b: utility=370.00 - BATNA=265.95 = surplus=104.05
âœ… Calculated utility_surplus: {'model_a': 104.5, 'model_b': 104.05000000000001}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 400, 'model_b': 370}
Metrics: {'utility_surplus': {'model_a': 104.5, 'model_b': 104.05000000000001}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 118 completed successfully
Sun Nov 16 04:15:07 PM CET 2025: Completed iteration 118

=== Iteration 119/300 ===
Sun Nov 16 04:15:07 PM CET 2025: Starting resource allocation negotiation iteration 119
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.04s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.32s (total since entry 16.38s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
5, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.80s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.37s (total since entry 7.18s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
9, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.5}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=22.5 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=45, CPU=10 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=45, CPU=10 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered GPU=45, CPU=10 - Creating automatic agreement!
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=45, CPU=10
ğŸ” [BATNA DEBUG] Using BATNA from round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=420.00, marketing=350.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=133.30, marketing=91.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=420.00 - BATNA=286.70 = surplus=133.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=350.00 - BATNA=258.03 = surplus=91.97
âœ… Calculated utility_surplus: {'model_a': 133.29851250000002, 'model_b': 91.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 420, 'model_b': 350}
Metrics: {'utility_surplus': {'model_a': 133.29851250000002, 'model_b': 91.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 119 completed successfully
Sun Nov 16 04:15:52 PM CET 2025: Completed iteration 119

=== Iteration 120/300 ===
Sun Nov 16 04:15:52 PM CET 2025: Starting resource allocation negotiation iteration 120
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.25s (total since entry 16.30s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.39s (total since entry 7.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 25}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 25}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=25 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 23.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=23 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 31.0, 'cpu_hours': 24.0}
ğŸ’¡ Player model_b made offer GPU=31, CPU=24 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 29, "cpu_hours": 26}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 29, "cpu_hours": 26}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 29, "cpu_hours": 26}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 29, 'cpu_hours': 26}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 29, 'cpu_hours': 26}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 29.0, 'cpu_hours': 26.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=98.93, marketing=118.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=261.96 = surplus=118.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=291.07 = surplus=98.93
âœ… Calculated utility_surplus: {'model_a': 118.03924999999998, 'model_b': 98.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 118.03924999999998, 'model_b': 98.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 120 completed successfully
Sun Nov 16 04:16:42 PM CET 2025: Completed iteration 120

=== Iteration 121/300 ===
Sun Nov 16 04:16:42 PM CET 2025: Starting resource allocation negotiation iteration 121
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.05s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.29s (total since entry 16.36s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.35s (total since entry 7.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
9, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 33.0, 'cpu_hours': 23.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=33, CPU=23 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 31.0, 'cpu_hours': 24.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=103.30, marketing=121.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=390.00 - BATNA=286.70 = surplus=103.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=380.00 - BATNA=258.03 = surplus=121.97
âœ… Calculated utility_surplus: {'model_a': 103.29851250000002, 'model_b': 121.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 390, 'model_b': 380}
Metrics: {'utility_surplus': {'model_a': 103.29851250000002, 'model_b': 121.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 121 completed successfully
Sun Nov 16 04:17:31 PM CET 2025: Completed iteration 121

=== Iteration 122/300 ===
Sun Nov 16 04:17:31 PM CET 2025: Starting resource allocation negotiation iteration 122
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.00s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.45s (total since entry 16.47s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.40s (total since entry 7.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=20, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 28, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 28, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 28.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=28, CPU=22 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 24.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=24 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 33.0, 'cpu_hours': 23.0}
ğŸ’¡ Player model_b made offer GPU=33, CPU=23 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=33, CPU=23 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=33, CPU=23
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=402.00, marketing=382.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=115.30, marketing=123.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=402.00 - BATNA=286.70 = surplus=115.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=382.00 - BATNA=258.03 = surplus=123.97
âœ… Calculated utility_surplus: {'model_a': 115.29851250000002, 'model_b': 123.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 402, 'model_b': 382}
Metrics: {'utility_surplus': {'model_a': 115.29851250000002, 'model_b': 123.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 122 completed successfully
Sun Nov 16 04:18:20 PM CET 2025: Completed iteration 122

=== Iteration 123/300 ===
Sun Nov 16 04:18:20 PM CET 2025: Starting resource allocation negotiation iteration 123
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.37s (total since entry 16.41s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.41s (total since entry 7.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 35}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 35}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 35.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 5}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 5.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=35 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=70, CPU=5 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=50, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=60, CPU=10 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 35}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 35}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 35.0}
ğŸ’¡ Player model_a made offer GPU=70, CPU=10 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=35 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=40, CPU=35 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=40, CPU=35
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=530.00, marketing=520.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=238.93, marketing=258.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=530.00 - BATNA=291.07 = surplus=238.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=520.00 - BATNA=261.96 = surplus=258.04
âœ… Calculated utility_surplus: {'model_a': 238.9325, 'model_b': 258.03925}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 530, 'model_b': 520}
Metrics: {'utility_surplus': {'model_a': 238.9325, 'model_b': 258.03925}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 123 completed successfully
Sun Nov 16 04:19:02 PM CET 2025: Completed iteration 123

=== Iteration 124/300 ===
Sun Nov 16 04:19:02 PM CET 2025: Starting resource allocation negotiation iteration 124
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.04s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.36s (total since entry 16.41s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.33s (total since entry 7.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 75, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 75, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 75.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=75, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=50, CPU=15 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=70, CPU=10 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=60, CPU=10 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=40, CPU=20 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=40, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=440.00, marketing=400.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=148.93, marketing=138.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=440.00 - BATNA=291.07 = surplus=148.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=261.96 = surplus=138.04
âœ… Calculated utility_surplus: {'model_a': 148.9325, 'model_b': 138.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 440, 'model_b': 400}
Metrics: {'utility_surplus': {'model_a': 148.9325, 'model_b': 138.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 124 completed successfully
Sun Nov 16 04:19:46 PM CET 2025: Completed iteration 124

=== Iteration 125/300 ===
Sun Nov 16 04:19:46 PM CET 2025: Starting resource allocation negotiation iteration 125
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.00s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.36s (total since entry 16.38s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.77s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.37s (total since entry 7.14s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 40.0}
ğŸ’¡ Player model_a made offer GPU=70, CPU=10 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=20, CPU=40 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=50, CPU=15 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 65, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 65, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 65, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 65, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 65, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 65.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=70, CPU=10 (made in round 1)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=70, CPU=10
ğŸ” [BATNA DEBUG] Using BATNA from offer round 1 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=300.00, marketing=270.00
ğŸ” [UTILITY DEBUG] Utilities: development=620.00, marketing=500.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=320.00, marketing=230.00
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=620.00 - BATNA=300.00 = surplus=320.00
ğŸ’° [UTILITY SURPLUS] model_b: utility=500.00 - BATNA=270.00 = surplus=230.00
âœ… Calculated utility_surplus: {'model_a': 320.0, 'model_b': 230.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 620, 'model_b': 500}
Metrics: {'utility_surplus': {'model_a': 320.0, 'model_b': 230.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 125 completed successfully
Sun Nov 16 04:20:26 PM CET 2025: Completed iteration 125

=== Iteration 126/300 ===
Sun Nov 16 04:20:26 PM CET 2025: Starting resource allocation negotiation iteration 126
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.32s (total since entry 16.36s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
10, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.35s (total since entry 7.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=40, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 26}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 26}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 26}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 26}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 26}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 31.0, 'cpu_hours': 26.0}
ğŸ’¡ Player model_b made offer GPU=31, CPU=26 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 2)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 2 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=295.50, marketing=265.95
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=94.50, marketing=114.05
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=390.00 - BATNA=295.50 = surplus=94.50
ğŸ’° [UTILITY SURPLUS] model_b: utility=380.00 - BATNA=265.95 = surplus=114.05
âœ… Calculated utility_surplus: {'model_a': 94.5, 'model_b': 114.05000000000001}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 390, 'model_b': 380}
Metrics: {'utility_surplus': {'model_a': 94.5, 'model_b': 114.05000000000001}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 126 completed successfully
Sun Nov 16 04:21:16 PM CET 2025: Completed iteration 126

=== Iteration 127/300 ===
Sun Nov 16 04:21:16 PM CET 2025: Starting resource allocation negotiation iteration 127
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.06s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.24s (total since entry 16.32s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
15, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.79s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.35s (total since entry 7.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
8, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=20, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 28, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 28, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 28.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=28, CPU=22 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 23.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 29, "cpu_hours": 26}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 29, "cpu_hours": 26}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 29, "cpu_hours": 26}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 29, 'cpu_hours': 26}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 29, 'cpu_hours': 26}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 29.0, 'cpu_hours': 26.0}
ğŸ’¡ Player model_a made offer GPU=32, CPU=23 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=29, CPU=26 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 31.0, 'cpu_hours': 24.0}
ğŸ’¡ Player model_b made offer GPU=31, CPU=24 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=32, CPU=23 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=32, CPU=23
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=394.00, marketing=376.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=102.93, marketing=114.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=394.00 - BATNA=291.07 = surplus=102.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=376.00 - BATNA=261.96 = surplus=114.04
âœ… Calculated utility_surplus: {'model_a': 102.9325, 'model_b': 114.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 394, 'model_b': 376}
Metrics: {'utility_surplus': {'model_a': 102.9325, 'model_b': 114.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 127 completed successfully
Sun Nov 16 04:21:59 PM CET 2025: Completed iteration 127

=== Iteration 128/300 ===
Sun Nov 16 04:21:59 PM CET 2025: Starting resource allocation negotiation iteration 128
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.06s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.34s (total since entry 16.42s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.34s (total since entry 7.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=70, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=45, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=30 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=40, CPU=20 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=40, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=440.00, marketing=400.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=153.30, marketing=141.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=440.00 - BATNA=286.70 = surplus=153.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=258.03 = surplus=141.97
âœ… Calculated utility_surplus: {'model_a': 153.29851250000002, 'model_b': 141.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 440, 'model_b': 400}
Metrics: {'utility_surplus': {'model_a': 153.29851250000002, 'model_b': 141.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 128 completed successfully
Sun Nov 16 04:22:48 PM CET 2025: Completed iteration 128

=== Iteration 129/300 ===
Sun Nov 16 04:22:48 PM CET 2025: Starting resource allocation negotiation iteration 129
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.38s (total since entry 16.43s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.76s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.38s (total since entry 7.14s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 5}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 5.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=70, CPU=5 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "gpu_hours": 40,\n  "cpu_hours": 20\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "gpu_hours": 40,\n  "cpu_hours": 20\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "gpu_hours": 40,\n  "cpu_hours": 20\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=60, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.5}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22.5 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=70, CPU=15 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=40, CPU=20 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered GPU=40, CPU=20 - Creating automatic agreement!
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=40, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=440.00, marketing=400.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=153.30, marketing=141.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=440.00 - BATNA=286.70 = surplus=153.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=258.03 = surplus=141.97
âœ… Calculated utility_surplus: {'model_a': 153.29851250000002, 'model_b': 141.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 440, 'model_b': 400}
Metrics: {'utility_surplus': {'model_a': 153.29851250000002, 'model_b': 141.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 129 completed successfully
Sun Nov 16 04:23:38 PM CET 2025: Completed iteration 129

=== Iteration 130/300 ===
Sun Nov 16 04:23:38 PM CET 2025: Starting resource allocation negotiation iteration 130
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.05s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.35s (total since entry 16.41s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.41s (total since entry 7.14s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=50, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=30 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=30 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=30
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=420.00, marketing=420.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=133.30, marketing=161.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=420.00 - BATNA=258.03 = surplus=161.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=420.00 - BATNA=286.70 = surplus=133.30
âœ… Calculated utility_surplus: {'model_a': 161.96866125000003, 'model_b': 133.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 420, 'model_a': 420}
Metrics: {'utility_surplus': {'model_a': 161.96866125000003, 'model_b': 133.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 130 completed successfully
Sun Nov 16 04:24:30 PM CET 2025: Completed iteration 130

=== Iteration 131/300 ===
Sun Nov 16 04:24:30 PM CET 2025: Starting resource allocation negotiation iteration 131
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.24s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.34s (total since entry 16.59s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.37s (total since entry 7.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
16, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 24.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=24 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 26}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 26}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 26}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 26}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 26}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 31.0, 'cpu_hours': 26.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=31, CPU=26 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=20 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=113.30, marketing=111.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=286.70 = surplus=113.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=370.00 - BATNA=258.03 = surplus=111.97
âœ… Calculated utility_surplus: {'model_a': 113.29851250000002, 'model_b': 111.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 400, 'model_b': 370}
Metrics: {'utility_surplus': {'model_a': 113.29851250000002, 'model_b': 111.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 131 completed successfully
Sun Nov 16 04:25:13 PM CET 2025: Completed iteration 131

=== Iteration 132/300 ===
Sun Nov 16 04:25:13 PM CET 2025: Starting resource allocation negotiation iteration 132
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.23s (total since entry 16.27s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
10, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.76s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.38s (total since entry 7.14s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=45, CPU=10 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=40, CPU=15 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered GPU=40, CPU=15 - Creating automatic agreement!
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=40, CPU=15
ğŸ” [BATNA DEBUG] Using BATNA from round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=410.00, marketing=360.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=123.30, marketing=101.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=410.00 - BATNA=286.70 = surplus=123.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=360.00 - BATNA=258.03 = surplus=101.97
âœ… Calculated utility_surplus: {'model_a': 123.29851250000002, 'model_b': 101.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 410, 'model_b': 360}
Metrics: {'utility_surplus': {'model_a': 123.29851250000002, 'model_b': 101.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 132 completed successfully
Sun Nov 16 04:26:01 PM CET 2025: Completed iteration 132

=== Iteration 133/300 ===
Sun Nov 16 04:26:01 PM CET 2025: Starting resource allocation negotiation iteration 133
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.99s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.51s (total since entry 16.52s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.38s (total since entry 7.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered GPU=35, CPU=20 - Creating automatic agreement!
ğŸ” [RESOURCE DEBUG] Agreement in round 2: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from round 2
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=295.50, marketing=265.95
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=104.50, marketing=104.05
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=370.00 - BATNA=265.95 = surplus=104.05
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=295.50 = surplus=104.50
âœ… Calculated utility_surplus: {'model_a': 104.05000000000001, 'model_b': 104.5}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 400, 'model_a': 370}
Metrics: {'utility_surplus': {'model_a': 104.05000000000001, 'model_b': 104.5}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 133 completed successfully
Sun Nov 16 04:26:37 PM CET 2025: Completed iteration 133

=== Iteration 134/300 ===
Sun Nov 16 04:26:37 PM CET 2025: Starting resource allocation negotiation iteration 134
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.32s (total since entry 16.34s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.79s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.34s (total since entry 7.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 40.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=20, CPU=40 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 23.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=23 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=32, CPU=23 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=32, CPU=23
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=394.00, marketing=376.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=102.93, marketing=114.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=376.00 - BATNA=261.96 = surplus=114.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=394.00 - BATNA=291.07 = surplus=102.93
âœ… Calculated utility_surplus: {'model_a': 114.03924999999998, 'model_b': 102.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 394, 'model_a': 376}
Metrics: {'utility_surplus': {'model_a': 114.03924999999998, 'model_b': 102.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 134 completed successfully
Sun Nov 16 04:27:21 PM CET 2025: Completed iteration 134

=== Iteration 135/300 ===
Sun Nov 16 04:27:21 PM CET 2025: Starting resource allocation negotiation iteration 135
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.00s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.55s (total since entry 16.57s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.34s (total since entry 7.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 5}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 5}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 5}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 75, 'cpu_hours': 5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 75, 'cpu_hours': 5}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 75.0, 'cpu_hours': 5.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_a made offer GPU=75, CPU=5 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=20, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 5}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 5}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 5}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 5}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 5.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=60, CPU=5 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=45, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=60, CPU=5 (made in round 2)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=60, CPU=5
ğŸ” [BATNA DEBUG] Using BATNA from offer round 2 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=295.50, marketing=265.95
ğŸ” [UTILITY DEBUG] Utilities: development=510.00, marketing=400.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=214.50, marketing=134.05
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=510.00 - BATNA=295.50 = surplus=214.50
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=265.95 = surplus=134.05
âœ… Calculated utility_surplus: {'model_a': 214.5, 'model_b': 134.05}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 510, 'model_b': 400}
Metrics: {'utility_surplus': {'model_a': 214.5, 'model_b': 134.05}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 135 completed successfully
Sun Nov 16 04:28:05 PM CET 2025: Completed iteration 135

=== Iteration 136/300 ===
Sun Nov 16 04:28:05 PM CET 2025: Starting resource allocation negotiation iteration 136
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.12s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.40s (total since entry 16.53s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.36s (total since entry 7.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 23.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=23 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 26}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 26}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 26}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 26}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 26}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 31.0, 'cpu_hours': 26.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=32, CPU=23 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=32, CPU=23
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=394.00, marketing=376.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=102.93, marketing=114.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=394.00 - BATNA=291.07 = surplus=102.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=376.00 - BATNA=261.96 = surplus=114.04
âœ… Calculated utility_surplus: {'model_a': 102.9325, 'model_b': 114.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 394, 'model_b': 376}
Metrics: {'utility_surplus': {'model_a': 102.9325, 'model_b': 114.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 136 completed successfully
Sun Nov 16 04:28:48 PM CET 2025: Completed iteration 136

=== Iteration 137/300 ===
Sun Nov 16 04:28:48 PM CET 2025: Starting resource allocation negotiation iteration 137
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.22s (total since entry 16.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
8, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.38s (total since entry 7.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=45, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=20, CPU=30 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "gpu_hours": 50,\n  "cpu_hours": 10\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "gpu_hours": 50,\n  "cpu_hours": 10\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "gpu_hours": 50,\n  "cpu_hours": 10\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 35}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 35}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 35}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 35}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 35}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 35.0}
ğŸ’¡ Player model_b made offer GPU=50, CPU=10 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=35 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=35 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=35
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=450.00, marketing=460.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=163.30, marketing=201.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=460.00 - BATNA=258.03 = surplus=201.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=450.00 - BATNA=286.70 = surplus=163.30
âœ… Calculated utility_surplus: {'model_a': 201.96866125000003, 'model_b': 163.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 450, 'model_a': 460}
Metrics: {'utility_surplus': {'model_a': 201.96866125000003, 'model_b': 163.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 137 completed successfully
Sun Nov 16 04:29:34 PM CET 2025: Completed iteration 137

=== Iteration 138/300 ===
Sun Nov 16 04:29:34 PM CET 2025: Starting resource allocation negotiation iteration 138
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.05s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.35s (total since entry 16.41s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
8, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.80s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.38s (total since entry 7.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
8, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 5, "cpu_hours": 95}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 5, "cpu_hours": 95}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 5, "cpu_hours": 95}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 5, 'cpu_hours': 95}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 5, 'cpu_hours': 95}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 5.0, 'cpu_hours': 95.0}
âš ï¸ Player model_a offer violates constraints: GPU=5, CPU=95
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=20, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.5}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=22.5 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=20 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=113.30, marketing=111.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=370.00 - BATNA=258.03 = surplus=111.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=286.70 = surplus=113.30
âœ… Calculated utility_surplus: {'model_a': 111.96866125000003, 'model_b': 113.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 400, 'model_a': 370}
Metrics: {'utility_surplus': {'model_a': 111.96866125000003, 'model_b': 113.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 138 completed successfully
Sun Nov 16 04:30:25 PM CET 2025: Completed iteration 138

=== Iteration 139/300 ===
Sun Nov 16 04:30:25 PM CET 2025: Starting resource allocation negotiation iteration 139
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.33s (total since entry 16.36s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.37s (total since entry 7.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 75, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 75, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 75.0, 'cpu_hours': 25.0}
âš ï¸ Player model_a offer violates constraints: GPU=75, CPU=25
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=60, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=30 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=50, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 28.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=50, CPU=20 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=50, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=520.00, marketing=460.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=233.30, marketing=201.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=520.00 - BATNA=286.70 = surplus=233.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=460.00 - BATNA=258.03 = surplus=201.97
âœ… Calculated utility_surplus: {'model_a': 233.29851250000002, 'model_b': 201.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 520, 'model_b': 460}
Metrics: {'utility_surplus': {'model_a': 233.29851250000002, 'model_b': 201.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 139 completed successfully
Sun Nov 16 04:31:15 PM CET 2025: Completed iteration 139

=== Iteration 140/300 ===
Sun Nov 16 04:31:15 PM CET 2025: Starting resource allocation negotiation iteration 140
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.10s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.35s (total since entry 16.47s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.81s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.34s (total since entry 7.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=45, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 17}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 17}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 17}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 17}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 17}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 17.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=17 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "gpu_hours": 50,\n  "cpu_hours": 10\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "gpu_hours": 50,\n  "cpu_hours": 10\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "gpu_hours": 50,\n  "cpu_hours": 10\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=50, CPU=10 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=103.30, marketing=121.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=258.03 = surplus=121.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=286.70 = surplus=103.30
âœ… Calculated utility_surplus: {'model_a': 121.96866125000003, 'model_b': 103.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 121.96866125000003, 'model_b': 103.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 140 completed successfully
Sun Nov 16 04:32:02 PM CET 2025: Completed iteration 140

=== Iteration 141/300 ===
Sun Nov 16 04:32:02 PM CET 2025: Starting resource allocation negotiation iteration 141
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.00s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.28s (total since entry 16.30s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.37s (total since entry 7.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=20 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=113.30, marketing=111.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=286.70 = surplus=113.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=370.00 - BATNA=258.03 = surplus=111.97
âœ… Calculated utility_surplus: {'model_a': 113.29851250000002, 'model_b': 111.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 400, 'model_b': 370}
Metrics: {'utility_surplus': {'model_a': 113.29851250000002, 'model_b': 111.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 141 completed successfully
Sun Nov 16 04:32:52 PM CET 2025: Completed iteration 141

=== Iteration 142/300 ===
Sun Nov 16 04:32:52 PM CET 2025: Starting resource allocation negotiation iteration 142
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.10s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.27s (total since entry 16.38s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.34s (total since entry 7.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
10, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 55}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 55}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 55}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 55}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 55}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 25.0, 'cpu_hours': 55.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=25, CPU=55 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=30 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 23.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 35}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 35}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 35}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 35}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 35}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 25.0, 'cpu_hours': 35.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=23 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=25, CPU=35 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=32, CPU=23 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=32, CPU=23
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=394.00, marketing=376.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=102.93, marketing=114.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=376.00 - BATNA=261.96 = surplus=114.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=394.00 - BATNA=291.07 = surplus=102.93
âœ… Calculated utility_surplus: {'model_a': 114.03924999999998, 'model_b': 102.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 394, 'model_a': 376}
Metrics: {'utility_surplus': {'model_a': 114.03924999999998, 'model_b': 102.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 142 completed successfully
Sun Nov 16 04:33:36 PM CET 2025: Completed iteration 142

=== Iteration 143/300 ===
Sun Nov 16 04:33:36 PM CET 2025: Starting resource allocation negotiation iteration 143
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.32s (total since entry 16.36s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.41s (total since entry 7.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 27.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=27 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=27 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=27
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=402.00, marketing=396.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=115.30, marketing=137.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=396.00 - BATNA=258.03 = surplus=137.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=402.00 - BATNA=286.70 = surplus=115.30
âœ… Calculated utility_surplus: {'model_a': 137.96866125000003, 'model_b': 115.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 402, 'model_a': 396}
Metrics: {'utility_surplus': {'model_a': 137.96866125000003, 'model_b': 115.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 143 completed successfully
Sun Nov 16 04:34:24 PM CET 2025: Completed iteration 143

=== Iteration 144/300 ===
Sun Nov 16 04:34:24 PM CET 2025: Starting resource allocation negotiation iteration 144
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.22s (total since entry 16.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.76s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.36s (total since entry 7.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
9, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 25}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 25}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=25 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "gpu_hours": 35,\n    "cpu_hours": 20\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "gpu_hours": 35,\n    "cpu_hours": 20\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "gpu_hours": 35,\n    "cpu_hours": 20\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered GPU=35, CPU=20 - Creating automatic agreement!
ğŸ” [RESOURCE DEBUG] Agreement in round 3: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from round 3
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=108.93, marketing=108.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=370.00 - BATNA=261.96 = surplus=108.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=291.07 = surplus=108.93
âœ… Calculated utility_surplus: {'model_a': 108.03924999999998, 'model_b': 108.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 400, 'model_a': 370}
Metrics: {'utility_surplus': {'model_a': 108.03924999999998, 'model_b': 108.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 144 completed successfully
Sun Nov 16 04:35:08 PM CET 2025: Completed iteration 144

=== Iteration 145/300 ===
Sun Nov 16 04:35:08 PM CET 2025: Starting resource allocation negotiation iteration 145
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.21s (total since entry 16.26s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.35s (total since entry 7.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_a made offer GPU=40, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 38, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 38, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 38, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 38, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 38, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 38.0, 'cpu_hours': 23.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=22 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=38, CPU=23 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=38, CPU=23 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=38, CPU=23
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=442.00, marketing=412.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=150.93, marketing=150.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=442.00 - BATNA=291.07 = surplus=150.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=412.00 - BATNA=261.96 = surplus=150.04
âœ… Calculated utility_surplus: {'model_a': 150.9325, 'model_b': 150.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 442, 'model_b': 412}
Metrics: {'utility_surplus': {'model_a': 150.9325, 'model_b': 150.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 145 completed successfully
Sun Nov 16 04:35:48 PM CET 2025: Completed iteration 145

=== Iteration 146/300 ===
Sun Nov 16 04:35:48 PM CET 2025: Starting resource allocation negotiation iteration 146
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.04s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.46s (total since entry 16.52s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.41s (total since entry 7.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 23.0}
ğŸ’¡ Player model_a made offer GPU=20, CPU=30 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=23 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 21}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 21}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 21}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 34, 'cpu_hours': 21}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 34, 'cpu_hours': 21}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 34.0, 'cpu_hours': 21.0}
ğŸ’¡ Player model_a made offer GPU=20, CPU=30 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=34, CPU=21 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=20, CPU=30 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=20, CPU=30
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=340.00, marketing=360.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=48.93, marketing=98.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=360.00 - BATNA=261.96 = surplus=98.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=340.00 - BATNA=291.07 = surplus=48.93
âœ… Calculated utility_surplus: {'model_a': 98.03924999999998, 'model_b': 48.932500000000005}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 340, 'model_a': 360}
Metrics: {'utility_surplus': {'model_a': 98.03924999999998, 'model_b': 48.932500000000005}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 146 completed successfully
Sun Nov 16 04:36:40 PM CET 2025: Completed iteration 146

=== Iteration 147/300 ===
Sun Nov 16 04:36:40 PM CET 2025: Starting resource allocation negotiation iteration 147
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.08s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.34s (total since entry 16.44s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
17, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.34s (total since entry 7.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 60}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 60}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 60}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 60}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 60}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 60.0}
âš ï¸ Player model_b offer violates constraints: GPU=40, CPU=60
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 40.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 75, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 75, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 75.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=20, CPU=40 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=75, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=60, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_a made offer GPU=70, CPU=15 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=30 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=50, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=50, CPU=20 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=50, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=520.00, marketing=460.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=233.30, marketing=201.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=520.00 - BATNA=286.70 = surplus=233.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=460.00 - BATNA=258.03 = surplus=201.97
âœ… Calculated utility_surplus: {'model_a': 233.29851250000002, 'model_b': 201.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 520, 'model_b': 460}
Metrics: {'utility_surplus': {'model_a': 233.29851250000002, 'model_b': 201.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 147 completed successfully
Sun Nov 16 04:37:30 PM CET 2025: Completed iteration 147

=== Iteration 148/300 ===
Sun Nov 16 04:37:30 PM CET 2025: Starting resource allocation negotiation iteration 148
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.35s (total since entry 16.38s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
10, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.34s (total since entry 7.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 35}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 35}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 35}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 35}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 35}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 35.0}
ğŸ’¡ Player model_b made offer GPU=45, CPU=15 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=35 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=35, CPU=22 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=35, CPU=22
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=412.00, marketing=386.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=125.30, marketing=127.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=386.00 - BATNA=258.03 = surplus=127.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=412.00 - BATNA=286.70 = surplus=125.30
âœ… Calculated utility_surplus: {'model_a': 127.96866125000003, 'model_b': 125.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 412, 'model_a': 386}
Metrics: {'utility_surplus': {'model_a': 127.96866125000003, 'model_b': 125.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 148 completed successfully
Sun Nov 16 04:38:17 PM CET 2025: Completed iteration 148

=== Iteration 149/300 ===
Sun Nov 16 04:38:17 PM CET 2025: Starting resource allocation negotiation iteration 149
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.06s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.38s (total since entry 16.45s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.36s (total since entry 7.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
8, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=45, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=30 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=45, CPU=15 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=30 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=30
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=420.00, marketing=420.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=133.30, marketing=161.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=420.00 - BATNA=258.03 = surplus=161.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=420.00 - BATNA=286.70 = surplus=133.30
âœ… Calculated utility_surplus: {'model_a': 161.96866125000003, 'model_b': 133.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 420, 'model_a': 420}
Metrics: {'utility_surplus': {'model_a': 161.96866125000003, 'model_b': 133.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 149 completed successfully
Sun Nov 16 04:39:08 PM CET 2025: Completed iteration 149

=== Iteration 150/300 ===
Sun Nov 16 04:39:08 PM CET 2025: Starting resource allocation negotiation iteration 150
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.04s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.33s (total since entry 16.39s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.36s (total since entry 7.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_b made offer GPU=20, CPU=15 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=20, CPU=30 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 28, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 28, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 28.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=28, CPU=22 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 24.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 27.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=24 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=27 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 26}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 26}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 26}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 26}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 26}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 26.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "gpu_hours": 35,\n  "cpu_hours": 20\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "gpu_hours": 35,\n  "cpu_hours": 20\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "gpu_hours": 35,\n  "cpu_hours": 20\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=26 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=26 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=26
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=396.00, marketing=388.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=109.30, marketing=129.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=388.00 - BATNA=258.03 = surplus=129.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=396.00 - BATNA=286.70 = surplus=109.30
âœ… Calculated utility_surplus: {'model_a': 129.96866125000003, 'model_b': 109.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 396, 'model_a': 388}
Metrics: {'utility_surplus': {'model_a': 129.96866125000003, 'model_b': 109.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 150 completed successfully
Sun Nov 16 04:39:56 PM CET 2025: Completed iteration 150

=== Iteration 151/300 ===
Sun Nov 16 04:39:56 PM CET 2025: Starting resource allocation negotiation iteration 151
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.31s (total since entry 16.34s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.33s (total since entry 7.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
11, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 40.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 75, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 75, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 75.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=20, CPU=40 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=75, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 30}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 30}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=30 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=75, CPU=20 (made in round 1)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=75, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 1 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=300.00, marketing=270.00
ğŸ” [UTILITY DEBUG] Utilities: development=720.00, marketing=610.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=420.00, marketing=340.00
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=720.00 - BATNA=300.00 = surplus=420.00
ğŸ’° [UTILITY SURPLUS] model_b: utility=610.00 - BATNA=270.00 = surplus=340.00
âœ… Calculated utility_surplus: {'model_a': 420.0, 'model_b': 340.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 720, 'model_b': 610}
Metrics: {'utility_surplus': {'model_a': 420.0, 'model_b': 340.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 151 completed successfully
Sun Nov 16 04:40:37 PM CET 2025: Completed iteration 151

=== Iteration 152/300 ===
Sun Nov 16 04:40:37 PM CET 2025: Starting resource allocation negotiation iteration 152
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.00s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.37s (total since entry 16.38s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.37s (total since entry 7.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 5}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 5.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=70, CPU=5 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=50, CPU=10 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=50, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 23.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=32, CPU=23 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 36, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 36, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 36, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 36, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 36, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 36.0, 'cpu_hours': 24.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=40, CPU=20 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=40, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=440.00, marketing=400.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=148.93, marketing=138.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=440.00 - BATNA=291.07 = surplus=148.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=261.96 = surplus=138.04
âœ… Calculated utility_surplus: {'model_a': 148.9325, 'model_b': 138.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 440, 'model_b': 400}
Metrics: {'utility_surplus': {'model_a': 148.9325, 'model_b': 138.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 152 completed successfully
Sun Nov 16 04:41:26 PM CET 2025: Completed iteration 152

=== Iteration 153/300 ===
Sun Nov 16 04:41:26 PM CET 2025: Starting resource allocation negotiation iteration 153
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.31s (total since entry 16.35s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
14, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.41s (total since entry 7.14s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
7, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 23.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=23 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 31.0, 'cpu_hours': 24.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=32, CPU=23 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=32, CPU=23
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=394.00, marketing=376.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=102.93, marketing=114.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=376.00 - BATNA=261.96 = surplus=114.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=394.00 - BATNA=291.07 = surplus=102.93
âœ… Calculated utility_surplus: {'model_a': 114.03924999999998, 'model_b': 102.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 394, 'model_a': 376}
Metrics: {'utility_surplus': {'model_a': 114.03924999999998, 'model_b': 102.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 153 completed successfully
Sun Nov 16 04:42:10 PM CET 2025: Completed iteration 153

=== Iteration 154/300 ===
Sun Nov 16 04:42:10 PM CET 2025: Starting resource allocation negotiation iteration 154
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.99s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.35s (total since entry 16.36s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
7, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.32s (total since entry 7.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=20, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=15 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered GPU=35, CPU=20 - Creating automatic agreement!
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=113.30, marketing=111.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=370.00 - BATNA=258.03 = surplus=111.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=286.70 = surplus=113.30
âœ… Calculated utility_surplus: {'model_a': 111.96866125000003, 'model_b': 113.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 400, 'model_a': 370}
Metrics: {'utility_surplus': {'model_a': 111.96866125000003, 'model_b': 113.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 154 completed successfully
Sun Nov 16 04:42:51 PM CET 2025: Completed iteration 154

=== Iteration 155/300 ===
Sun Nov 16 04:42:51 PM CET 2025: Starting resource allocation negotiation iteration 155
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.39s (total since entry 16.42s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
18, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.33s (total since entry 7.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 60}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 60}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 60}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 60}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 60}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 60.0}
âš ï¸ Player model_b offer violates constraints: GPU=40, CPU=60
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 23.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=23 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 22}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 22}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 33.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=33, CPU=22 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=33, CPU=22 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=33, CPU=22
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=396.00, marketing=374.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=109.30, marketing=115.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=396.00 - BATNA=286.70 = surplus=109.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=374.00 - BATNA=258.03 = surplus=115.97
âœ… Calculated utility_surplus: {'model_a': 109.29851250000002, 'model_b': 115.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 396, 'model_b': 374}
Metrics: {'utility_surplus': {'model_a': 109.29851250000002, 'model_b': 115.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 155 completed successfully
Sun Nov 16 04:43:38 PM CET 2025: Completed iteration 155

=== Iteration 156/300 ===
Sun Nov 16 04:43:38 PM CET 2025: Starting resource allocation negotiation iteration 156
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.41s (total since entry 16.44s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.38s (total since entry 7.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
7, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=20, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 22, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 22, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 22, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 22, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 22, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 22.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_b made offer GPU=22, CPU=28 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 27, "cpu_hours": 33}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 27, "cpu_hours": 33}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 27, "cpu_hours": 33}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 27, 'cpu_hours': 33}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 27, 'cpu_hours': 33}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 27.0, 'cpu_hours': 33.0}
ğŸ’¡ Player model_b made offer GPU=27, CPU=33 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=32, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=30, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=32, CPU=20 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=32, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=376.00, marketing=352.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=89.30, marketing=93.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=376.00 - BATNA=286.70 = surplus=89.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=352.00 - BATNA=258.03 = surplus=93.97
âœ… Calculated utility_surplus: {'model_a': 89.29851250000002, 'model_b': 93.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 376, 'model_b': 352}
Metrics: {'utility_surplus': {'model_a': 89.29851250000002, 'model_b': 93.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 156 completed successfully
Sun Nov 16 04:44:23 PM CET 2025: Completed iteration 156

=== Iteration 157/300 ===
Sun Nov 16 04:44:23 PM CET 2025: Starting resource allocation negotiation iteration 157
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.00s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.55s (total since entry 16.57s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.78s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.36s (total since entry 7.14s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=30 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=98.93, marketing=118.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=261.96 = surplus=118.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=291.07 = surplus=98.93
âœ… Calculated utility_surplus: {'model_a': 118.03924999999998, 'model_b': 98.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 118.03924999999998, 'model_b': 98.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 157 completed successfully
Sun Nov 16 04:45:01 PM CET 2025: Completed iteration 157

=== Iteration 158/300 ===
Sun Nov 16 04:45:01 PM CET 2025: Starting resource allocation negotiation iteration 158
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.31s (total since entry 16.35s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
10, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.53s (total since entry 7.24s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=60, CPU=15 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=50, CPU=10 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
â° Maximum rounds (5) reached - Ending negotiation
ğŸ² [ROLE DEBUG] No Agreement - Development=model_a, Marketing=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 158 completed successfully
Sun Nov 16 04:45:59 PM CET 2025: Completed iteration 158

=== Iteration 159/300 ===
Sun Nov 16 04:45:59 PM CET 2025: Starting resource allocation negotiation iteration 159
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.04s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.36s (total since entry 16.42s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
21, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.36s (total since entry 7.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=70, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=20, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 28.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=28 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=40, CPU=30 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 38, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 38, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 38, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 38, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 38, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 38.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_b made offer GPU=38, CPU=22 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=40, CPU=30 (made in round 2)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=40, CPU=30
ğŸ” [BATNA DEBUG] Using BATNA from offer round 2 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=295.50, marketing=265.95
ğŸ” [UTILITY DEBUG] Utilities: development=500.00, marketing=480.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=204.50, marketing=214.05
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=500.00 - BATNA=295.50 = surplus=204.50
ğŸ’° [UTILITY SURPLUS] model_b: utility=480.00 - BATNA=265.95 = surplus=214.05
âœ… Calculated utility_surplus: {'model_a': 204.5, 'model_b': 214.05}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 500, 'model_b': 480}
Metrics: {'utility_surplus': {'model_a': 204.5, 'model_b': 214.05}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 159 completed successfully
Sun Nov 16 04:46:44 PM CET 2025: Completed iteration 159

=== Iteration 160/300 ===
Sun Nov 16 04:46:44 PM CET 2025: Starting resource allocation negotiation iteration 160
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.04s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.31s (total since entry 16.36s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.38s (total since entry 7.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 26}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 26}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 26}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 26}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 26}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 26.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=26 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=40, CPU=10 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=40, CPU=10
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=380.00, marketing=320.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=88.93, marketing=58.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=320.00 - BATNA=261.96 = surplus=58.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=380.00 - BATNA=291.07 = surplus=88.93
âœ… Calculated utility_surplus: {'model_a': 58.03924999999998, 'model_b': 88.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 380, 'model_a': 320}
Metrics: {'utility_surplus': {'model_a': 58.03924999999998, 'model_b': 88.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 160 completed successfully
Sun Nov 16 04:47:31 PM CET 2025: Completed iteration 160

=== Iteration 161/300 ===
Sun Nov 16 04:47:31 PM CET 2025: Starting resource allocation negotiation iteration 161
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.33s (total since entry 16.38s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.38s (total since entry 7.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
13, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 35}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 35}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 35.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=35 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=30 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 26}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 26}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 26}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 34, 'cpu_hours': 26}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 34, 'cpu_hours': 26}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 34.0, 'cpu_hours': 26.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 23}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 37, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 37, 'cpu_hours': 23}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 37.0, 'cpu_hours': 23.0}
ğŸ’¡ Player model_b made offer GPU=34, CPU=26 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=37, CPU=23 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=37, CPU=23 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=37, CPU=23
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=434.00, marketing=406.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=142.93, marketing=144.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=434.00 - BATNA=291.07 = surplus=142.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=406.00 - BATNA=261.96 = surplus=144.04
âœ… Calculated utility_surplus: {'model_a': 142.9325, 'model_b': 144.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 434, 'model_b': 406}
Metrics: {'utility_surplus': {'model_a': 142.9325, 'model_b': 144.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 161 completed successfully
Sun Nov 16 04:48:18 PM CET 2025: Completed iteration 161

=== Iteration 162/300 ===
Sun Nov 16 04:48:18 PM CET 2025: Starting resource allocation negotiation iteration 162
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.04s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.36s (total since entry 16.42s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.34s (total since entry 7.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=45, CPU=20 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=45, CPU=20 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=45, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=480.00, marketing=430.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=193.30, marketing=171.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=430.00 - BATNA=258.03 = surplus=171.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=480.00 - BATNA=286.70 = surplus=193.30
âœ… Calculated utility_surplus: {'model_a': 171.96866125000003, 'model_b': 193.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 480, 'model_a': 430}
Metrics: {'utility_surplus': {'model_a': 171.96866125000003, 'model_b': 193.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 162 completed successfully
Sun Nov 16 04:49:04 PM CET 2025: Completed iteration 162

=== Iteration 163/300 ===
Sun Nov 16 04:49:04 PM CET 2025: Starting resource allocation negotiation iteration 163
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.06s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.29s (total since entry 16.37s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
17, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.76s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.37s (total since entry 7.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
5, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=40, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 24.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=24 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=32, CPU=24 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=32, CPU=24
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=384.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=108.93, marketing=122.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=291.07 = surplus=108.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=384.00 - BATNA=261.96 = surplus=122.04
âœ… Calculated utility_surplus: {'model_a': 108.9325, 'model_b': 122.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 400, 'model_b': 384}
Metrics: {'utility_surplus': {'model_a': 108.9325, 'model_b': 122.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 163 completed successfully
Sun Nov 16 04:49:43 PM CET 2025: Completed iteration 163

=== Iteration 164/300 ===
Sun Nov 16 04:49:43 PM CET 2025: Starting resource allocation negotiation iteration 164
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.36s (total since entry 16.40s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
16, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.38s (total since entry 7.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
6, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "gpu_hours": 35,\n  "cpu_hours": 20\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "gpu_hours": 35,\n  "cpu_hours": 20\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "gpu_hours": 35,\n  "cpu_hours": 20\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered GPU=35, CPU=20 - Creating automatic agreement!
ğŸ” [RESOURCE DEBUG] Agreement in round 2: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from round 2
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=295.50, marketing=265.95
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=104.50, marketing=104.05
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=370.00 - BATNA=265.95 = surplus=104.05
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=295.50 = surplus=104.50
âœ… Calculated utility_surplus: {'model_a': 104.05000000000001, 'model_b': 104.5}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 400, 'model_a': 370}
Metrics: {'utility_surplus': {'model_a': 104.05000000000001, 'model_b': 104.5}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 164 completed successfully
Sun Nov 16 04:50:21 PM CET 2025: Completed iteration 164

=== Iteration 165/300 ===
Sun Nov 16 04:50:21 PM CET 2025: Starting resource allocation negotiation iteration 165
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.00s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.39s (total since entry 16.40s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.50s (total since entry 7.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 35}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 35}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 35}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 35}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 35}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 35.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_a made offer GPU=20, CPU=35 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=45, CPU=10 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "gpu_hours": 50,\n    "cpu_hours": 10\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "gpu_hours": 50,\n    "cpu_hours": 10\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "gpu_hours": 50,\n    "cpu_hours": 10\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=50, CPU=10 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=103.30, marketing=121.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=258.03 = surplus=121.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=286.70 = surplus=103.30
âœ… Calculated utility_surplus: {'model_a': 121.96866125000003, 'model_b': 103.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 121.96866125000003, 'model_b': 103.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 165 completed successfully
Sun Nov 16 04:51:12 PM CET 2025: Completed iteration 165

=== Iteration 166/300 ===
Sun Nov 16 04:51:12 PM CET 2025: Starting resource allocation negotiation iteration 166
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.05s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.40s (total since entry 16.46s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
16, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.36s (total since entry 7.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=20, CPU=15 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=60, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 5}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 5.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=70, CPU=5 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=60, CPU=15 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 80, "cpu_hours": 0}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 80, "cpu_hours": 0}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 80, "cpu_hours": 0}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 80, 'cpu_hours': 0}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 80, 'cpu_hours': 0}
[DEBUG] Validation error: Invalid action type 'offer' for game 'resource_allocation'
[DEBUG] Raw response: {"type": "offer", "gpu_hours": 80, "cpu_hours": 0}
âš ï¸ [DEBUG] [model_a] Pydantic validation failed, using original: Action validation failed: Invalid action type 'offer' for game 'resource_allocation'
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "accept"\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "accept"\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "accept"\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=70, CPU=5 (made in round 2)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=70, CPU=5
ğŸ” [BATNA DEBUG] Using BATNA from offer round 2 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=295.50, marketing=265.95
ğŸ” [UTILITY DEBUG] Utilities: development=590.00, marketing=460.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=294.50, marketing=194.05
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=590.00 - BATNA=295.50 = surplus=294.50
ğŸ’° [UTILITY SURPLUS] model_b: utility=460.00 - BATNA=265.95 = surplus=194.05
âœ… Calculated utility_surplus: {'model_a': 294.5, 'model_b': 194.05}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 590, 'model_b': 460}
Metrics: {'utility_surplus': {'model_a': 294.5, 'model_b': 194.05}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 166 completed successfully
Sun Nov 16 04:51:57 PM CET 2025: Completed iteration 166

=== Iteration 167/300 ===
Sun Nov 16 04:51:57 PM CET 2025: Starting resource allocation negotiation iteration 167
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.38s (total since entry 16.41s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.39s (total since entry 7.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=20, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 34, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 34, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 34.0, 'cpu_hours': 23.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=20 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=113.30, marketing=111.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=286.70 = surplus=113.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=370.00 - BATNA=258.03 = surplus=111.97
âœ… Calculated utility_surplus: {'model_a': 113.29851250000002, 'model_b': 111.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 400, 'model_b': 370}
Metrics: {'utility_surplus': {'model_a': 113.29851250000002, 'model_b': 111.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 167 completed successfully
Sun Nov 16 04:52:47 PM CET 2025: Completed iteration 167

=== Iteration 168/300 ===
Sun Nov 16 04:52:47 PM CET 2025: Starting resource allocation negotiation iteration 168
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.99s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.37s (total since entry 16.38s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.40s (total since entry 7.14s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 23.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 27.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=23 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=27 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=27 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=27
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=402.00, marketing=396.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=110.93, marketing=134.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=396.00 - BATNA=261.96 = surplus=134.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=402.00 - BATNA=291.07 = surplus=110.93
âœ… Calculated utility_surplus: {'model_a': 134.03924999999998, 'model_b': 110.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 402, 'model_a': 396}
Metrics: {'utility_surplus': {'model_a': 134.03924999999998, 'model_b': 110.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 168 completed successfully
Sun Nov 16 04:53:35 PM CET 2025: Completed iteration 168

=== Iteration 169/300 ===
Sun Nov 16 04:53:35 PM CET 2025: Starting resource allocation negotiation iteration 169
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.06s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.41s (total since entry 16.49s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
14, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.43s (total since entry 7.18s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
11, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 5, "cpu_hours": 95}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 5, "cpu_hours": 95}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 5, "cpu_hours": 95}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 5, 'cpu_hours': 95}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 5, 'cpu_hours': 95}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 5.0, 'cpu_hours': 95.0}
âš ï¸ Player model_a offer violates constraints: GPU=5, CPU=95
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.5}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=22.5 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.5}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 40}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 40}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 40}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 40}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 40}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 25.0, 'cpu_hours': 40.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22.5 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=25, CPU=40 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=25, CPU=40 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=25, CPU=40
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=440.00, marketing=470.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=153.30, marketing=211.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=470.00 - BATNA=258.03 = surplus=211.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=440.00 - BATNA=286.70 = surplus=153.30
âœ… Calculated utility_surplus: {'model_a': 211.96866125000003, 'model_b': 153.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 440, 'model_a': 470}
Metrics: {'utility_surplus': {'model_a': 211.96866125000003, 'model_b': 153.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 169 completed successfully
Sun Nov 16 04:54:19 PM CET 2025: Completed iteration 169

=== Iteration 170/300 ===
Sun Nov 16 04:54:19 PM CET 2025: Starting resource allocation negotiation iteration 170
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.07s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.38s (total since entry 16.47s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.77s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.42s (total since entry 7.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 26}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 26}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 26}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 26}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 26}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 26.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=26 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=26 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=30, CPU=26
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=396.00, marketing=388.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=104.93, marketing=126.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=388.00 - BATNA=261.96 = surplus=126.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=396.00 - BATNA=291.07 = surplus=104.93
âœ… Calculated utility_surplus: {'model_a': 126.03924999999998, 'model_b': 104.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 396, 'model_a': 388}
Metrics: {'utility_surplus': {'model_a': 126.03924999999998, 'model_b': 104.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 170 completed successfully
Sun Nov 16 04:55:06 PM CET 2025: Completed iteration 170

=== Iteration 171/300 ===
Sun Nov 16 04:55:06 PM CET 2025: Starting resource allocation negotiation iteration 171
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.36s (total since entry 16.38s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.39s (total since entry 7.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
13, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=70, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=60, CPU=10 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=50, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=50, CPU=10 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=50, CPU=10 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=50, CPU=10
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=460.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=173.30, marketing=121.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=460.00 - BATNA=286.70 = surplus=173.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=380.00 - BATNA=258.03 = surplus=121.97
âœ… Calculated utility_surplus: {'model_a': 173.29851250000002, 'model_b': 121.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 460, 'model_b': 380}
Metrics: {'utility_surplus': {'model_a': 173.29851250000002, 'model_b': 121.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 171 completed successfully
Sun Nov 16 04:55:56 PM CET 2025: Completed iteration 171

=== Iteration 172/300 ===
Sun Nov 16 04:55:56 PM CET 2025: Starting resource allocation negotiation iteration 172
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.41s (total since entry 16.46s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
13, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.76s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.39s (total since entry 7.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
8, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=60, CPU=10 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=30 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=70, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=50, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=50, CPU=20 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=50, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=520.00, marketing=460.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=228.93, marketing=198.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=520.00 - BATNA=291.07 = surplus=228.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=460.00 - BATNA=261.96 = surplus=198.04
âœ… Calculated utility_surplus: {'model_a': 228.9325, 'model_b': 198.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 520, 'model_b': 460}
Metrics: {'utility_surplus': {'model_a': 228.9325, 'model_b': 198.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 172 completed successfully
Sun Nov 16 04:56:43 PM CET 2025: Completed iteration 172

=== Iteration 173/300 ===
Sun Nov 16 04:56:43 PM CET 2025: Starting resource allocation negotiation iteration 173
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.00s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.34s (total since entry 16.36s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.76s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.40s (total since entry 7.16s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=30 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 29}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 29}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 29}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 29}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 29}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 31.0, 'cpu_hours': 29.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
â° Maximum rounds (5) reached - Ending negotiation
ğŸ² [ROLE DEBUG] No Agreement - Development=model_a, Marketing=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 173 completed successfully
Sun Nov 16 04:57:35 PM CET 2025: Completed iteration 173

=== Iteration 174/300 ===
Sun Nov 16 04:57:35 PM CET 2025: Starting resource allocation negotiation iteration 174
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.08s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.34s (total since entry 16.44s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.36s (total since entry 7.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 5}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 5.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 60}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 60}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 60}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 60}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 60}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 60.0}
âš ï¸ Player model_b offer violates constraints: GPU=40, CPU=60
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=70, CPU=5 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 25}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 25}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=25 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=60, CPU=10 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=60, CPU=10 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=50, CPU=10 (proposal 4/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=40, CPU=15 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=40, CPU=15
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=410.00, marketing=360.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=123.30, marketing=101.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=410.00 - BATNA=286.70 = surplus=123.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=360.00 - BATNA=258.03 = surplus=101.97
âœ… Calculated utility_surplus: {'model_a': 123.29851250000002, 'model_b': 101.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 410, 'model_b': 360}
Metrics: {'utility_surplus': {'model_a': 123.29851250000002, 'model_b': 101.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 174 completed successfully
Sun Nov 16 04:58:27 PM CET 2025: Completed iteration 174

=== Iteration 175/300 ===
Sun Nov 16 04:58:27 PM CET 2025: Starting resource allocation negotiation iteration 175
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.41s (total since entry 16.45s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
9, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.41s (total since entry 7.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
5, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.5}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22.5 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=30 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 18}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 18}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 18}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 37, 'cpu_hours': 18}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 37, 'cpu_hours': 18}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 37.0, 'cpu_hours': 18.0}
ğŸ’¡ Player model_b made offer GPU=37, CPU=18 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 35}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 35}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 35}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 35}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 35}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 35.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=35 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=35 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=35
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=450.00, marketing=460.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=163.30, marketing=201.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=460.00 - BATNA=258.03 = surplus=201.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=450.00 - BATNA=286.70 = surplus=163.30
âœ… Calculated utility_surplus: {'model_a': 201.96866125000003, 'model_b': 163.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 450, 'model_a': 460}
Metrics: {'utility_surplus': {'model_a': 201.96866125000003, 'model_b': 163.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 175 completed successfully
Sun Nov 16 04:59:14 PM CET 2025: Completed iteration 175

=== Iteration 176/300 ===
Sun Nov 16 04:59:14 PM CET 2025: Starting resource allocation negotiation iteration 176
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.98s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.42s (total since entry 16.42s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.39s (total since entry 7.14s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 5}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 5.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=70, CPU=5 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=50, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=60, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=60, CPU=15 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=60, CPU=15
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=570.00, marketing=480.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=278.93, marketing=218.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=570.00 - BATNA=291.07 = surplus=278.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=480.00 - BATNA=261.96 = surplus=218.04
âœ… Calculated utility_surplus: {'model_a': 278.9325, 'model_b': 218.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 570, 'model_b': 480}
Metrics: {'utility_surplus': {'model_a': 278.9325, 'model_b': 218.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 176 completed successfully
Sun Nov 16 04:59:57 PM CET 2025: Completed iteration 176

=== Iteration 177/300 ===
Sun Nov 16 04:59:57 PM CET 2025: Starting resource allocation negotiation iteration 177
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.37s (total since entry 16.40s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.76s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.40s (total since entry 7.16s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 35}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 35}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 35.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=35 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=45, CPU=30 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 27}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 27}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 27.0}
ğŸ’¡ Player model_a made offer GPU=40, CPU=30 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=27 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=35, CPU=27 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=35, CPU=27
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=442.00, marketing=426.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=150.93, marketing=164.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=442.00 - BATNA=291.07 = surplus=150.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=426.00 - BATNA=261.96 = surplus=164.04
âœ… Calculated utility_surplus: {'model_a': 150.9325, 'model_b': 164.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 442, 'model_b': 426}
Metrics: {'utility_surplus': {'model_a': 150.9325, 'model_b': 164.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 177 completed successfully
Sun Nov 16 05:00:40 PM CET 2025: Completed iteration 177

=== Iteration 178/300 ===
Sun Nov 16 05:00:40 PM CET 2025: Starting resource allocation negotiation iteration 178
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.36s (total since entry 16.40s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.42s (total since entry 7.16s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 25.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=25, CPU=30 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 35}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 35}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 35}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 35}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 35}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 25.0, 'cpu_hours': 35.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_a made offer GPU=25, CPU=35 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 34, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 34, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 34.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=34, CPU=22 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=34, CPU=22 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=34, CPU=22
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=404.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=112.93, marketing=118.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=261.96 = surplus=118.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=404.00 - BATNA=291.07 = surplus=112.93
âœ… Calculated utility_surplus: {'model_a': 118.03924999999998, 'model_b': 112.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 404, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 118.03924999999998, 'model_b': 112.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 178 completed successfully
Sun Nov 16 05:01:19 PM CET 2025: Completed iteration 178

=== Iteration 179/300 ===
Sun Nov 16 05:01:19 PM CET 2025: Starting resource allocation negotiation iteration 179
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.37s (total since entry 16.40s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
6, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.40s (total since entry 7.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=45, CPU=10 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=45, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=50, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "gpu_hours": 35,\n    "cpu_hours": 25\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "gpu_hours": 35,\n    "cpu_hours": 25\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "gpu_hours": 35,\n    "cpu_hours": 25\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=25 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=50, CPU=10 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=35, CPU=25 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=35, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=430.00, marketing=410.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=143.30, marketing=151.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=430.00 - BATNA=286.70 = surplus=143.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=410.00 - BATNA=258.03 = surplus=151.97
âœ… Calculated utility_surplus: {'model_a': 143.29851250000002, 'model_b': 151.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 430, 'model_b': 410}
Metrics: {'utility_surplus': {'model_a': 143.29851250000002, 'model_b': 151.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 179 completed successfully
Sun Nov 16 05:02:19 PM CET 2025: Completed iteration 179

=== Iteration 180/300 ===
Sun Nov 16 05:02:19 PM CET 2025: Starting resource allocation negotiation iteration 180
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.40s (total since entry 16.45s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
7, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.34s (total since entry 7.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 27.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=27 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 24.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=24 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=32, CPU=24 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=32, CPU=24
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=384.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=108.93, marketing=122.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=384.00 - BATNA=261.96 = surplus=122.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=291.07 = surplus=108.93
âœ… Calculated utility_surplus: {'model_a': 122.03924999999998, 'model_b': 108.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 400, 'model_a': 384}
Metrics: {'utility_surplus': {'model_a': 122.03924999999998, 'model_b': 108.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 180 completed successfully
Sun Nov 16 05:03:06 PM CET 2025: Completed iteration 180

=== Iteration 181/300 ===
Sun Nov 16 05:03:06 PM CET 2025: Starting resource allocation negotiation iteration 181
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.40s (total since entry 16.43s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.39s (total since entry 7.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
11, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=40, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 31.0, 'cpu_hours': 24.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=31, CPU=24 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=20 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=113.30, marketing=111.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=286.70 = surplus=113.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=370.00 - BATNA=258.03 = surplus=111.97
âœ… Calculated utility_surplus: {'model_a': 113.29851250000002, 'model_b': 111.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 400, 'model_b': 370}
Metrics: {'utility_surplus': {'model_a': 113.29851250000002, 'model_b': 111.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 181 completed successfully
Sun Nov 16 05:03:49 PM CET 2025: Completed iteration 181

=== Iteration 182/300 ===
Sun Nov 16 05:03:49 PM CET 2025: Starting resource allocation negotiation iteration 182
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.40s (total since entry 16.44s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.42s (total since entry 7.16s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=45, CPU=10 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 25.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=20 (made in round 2)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 2 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=295.50, marketing=265.95
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=104.50, marketing=104.05
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=370.00 - BATNA=265.95 = surplus=104.05
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=295.50 = surplus=104.50
âœ… Calculated utility_surplus: {'model_a': 104.05000000000001, 'model_b': 104.5}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 400, 'model_a': 370}
Metrics: {'utility_surplus': {'model_a': 104.05000000000001, 'model_b': 104.5}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 182 completed successfully
Sun Nov 16 05:04:27 PM CET 2025: Completed iteration 182

=== Iteration 183/300 ===
Sun Nov 16 05:04:27 PM CET 2025: Starting resource allocation negotiation iteration 183
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.37s (total since entry 16.40s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.40s (total since entry 7.14s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 34, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 34, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 34.0, 'cpu_hours': 23.0}
ğŸ’¡ Player model_b made offer GPU=34, CPU=23 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered GPU=35, CPU=20 - Creating automatic agreement!
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=113.30, marketing=111.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=286.70 = surplus=113.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=370.00 - BATNA=258.03 = surplus=111.97
âœ… Calculated utility_surplus: {'model_a': 113.29851250000002, 'model_b': 111.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 400, 'model_b': 370}
Metrics: {'utility_surplus': {'model_a': 113.29851250000002, 'model_b': 111.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 183 completed successfully
Sun Nov 16 05:05:10 PM CET 2025: Completed iteration 183

=== Iteration 184/300 ===
Sun Nov 16 05:05:10 PM CET 2025: Starting resource allocation negotiation iteration 184
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.40s (total since entry 16.45s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.38s (total since entry 7.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=70, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=20, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 28.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=28 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=70, CPU=10 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=15 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=70, CPU=10 (made in round 2)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=70, CPU=10
ğŸ” [BATNA DEBUG] Using BATNA from offer round 2 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=295.50, marketing=265.95
ğŸ” [UTILITY DEBUG] Utilities: development=620.00, marketing=500.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=324.50, marketing=234.05
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=620.00 - BATNA=295.50 = surplus=324.50
ğŸ’° [UTILITY SURPLUS] model_b: utility=500.00 - BATNA=265.95 = surplus=234.05
âœ… Calculated utility_surplus: {'model_a': 324.5, 'model_b': 234.05}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 620, 'model_b': 500}
Metrics: {'utility_surplus': {'model_a': 324.5, 'model_b': 234.05}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 184 completed successfully
Sun Nov 16 05:05:59 PM CET 2025: Completed iteration 184

=== Iteration 185/300 ===
Sun Nov 16 05:05:59 PM CET 2025: Starting resource allocation negotiation iteration 185
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.06s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.37s (total since entry 16.45s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
6, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.42s (total since entry 7.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=30 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=30 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=30
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=420.00, marketing=420.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=133.30, marketing=161.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=420.00 - BATNA=258.03 = surplus=161.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=420.00 - BATNA=286.70 = surplus=133.30
âœ… Calculated utility_surplus: {'model_a': 161.96866125000003, 'model_b': 133.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 420, 'model_a': 420}
Metrics: {'utility_surplus': {'model_a': 161.96866125000003, 'model_b': 133.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 185 completed successfully
Sun Nov 16 05:06:45 PM CET 2025: Completed iteration 185

=== Iteration 186/300 ===
Sun Nov 16 05:06:45 PM CET 2025: Starting resource allocation negotiation iteration 186
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.41s (total since entry 16.44s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.76s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.37s (total since entry 7.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
18, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=70, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=45, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=70, CPU=25 (made in round 1)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=70, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 1 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=300.00, marketing=270.00
ğŸ” [UTILITY DEBUG] Utilities: development=710.00, marketing=620.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=410.00, marketing=350.00
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=710.00 - BATNA=300.00 = surplus=410.00
ğŸ’° [UTILITY SURPLUS] model_b: utility=620.00 - BATNA=270.00 = surplus=350.00
âœ… Calculated utility_surplus: {'model_a': 410.0, 'model_b': 350.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 710, 'model_b': 620}
Metrics: {'utility_surplus': {'model_a': 410.0, 'model_b': 350.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 186 completed successfully
Sun Nov 16 05:07:33 PM CET 2025: Completed iteration 186

=== Iteration 187/300 ===
Sun Nov 16 05:07:33 PM CET 2025: Starting resource allocation negotiation iteration 187
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.05s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.37s (total since entry 16.43s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.40s (total since entry 7.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=60, CPU=10 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=70, CPU=15 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=45, CPU=10 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=60, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=60, CPU=20 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=60, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=600.00, marketing=520.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=308.93, marketing=258.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=600.00 - BATNA=291.07 = surplus=308.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=520.00 - BATNA=261.96 = surplus=258.04
âœ… Calculated utility_surplus: {'model_a': 308.9325, 'model_b': 258.03925}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 600, 'model_b': 520}
Metrics: {'utility_surplus': {'model_a': 308.9325, 'model_b': 258.03925}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 187 completed successfully
Sun Nov 16 05:08:20 PM CET 2025: Completed iteration 187

=== Iteration 188/300 ===
Sun Nov 16 05:08:20 PM CET 2025: Starting resource allocation negotiation iteration 188
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.04s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.36s (total since entry 16.42s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.35s (total since entry 7.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 35}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 35}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 35}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 35}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 35}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 25.0, 'cpu_hours': 35.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=25, CPU=35 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 30.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=25, CPU=35 (made in round 1)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=25, CPU=35
ğŸ” [BATNA DEBUG] Using BATNA from offer round 1 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=300.00, marketing=270.00
ğŸ” [UTILITY DEBUG] Utilities: development=410.00, marketing=430.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=110.00, marketing=160.00
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=430.00 - BATNA=270.00 = surplus=160.00
ğŸ’° [UTILITY SURPLUS] model_b: utility=410.00 - BATNA=300.00 = surplus=110.00
âœ… Calculated utility_surplus: {'model_a': 160.0, 'model_b': 110.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 410, 'model_a': 430}
Metrics: {'utility_surplus': {'model_a': 160.0, 'model_b': 110.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 188 completed successfully
Sun Nov 16 05:09:04 PM CET 2025: Completed iteration 188

=== Iteration 189/300 ===
Sun Nov 16 05:09:04 PM CET 2025: Starting resource allocation negotiation iteration 189
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.98s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.34s (total since entry 16.34s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.76s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.43s (total since entry 7.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=15 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=45, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=15 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=35, CPU=15
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=370.00, marketing=330.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=78.93, marketing=68.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=330.00 - BATNA=261.96 = surplus=68.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=370.00 - BATNA=291.07 = surplus=78.93
âœ… Calculated utility_surplus: {'model_a': 68.03924999999998, 'model_b': 78.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 370, 'model_a': 330}
Metrics: {'utility_surplus': {'model_a': 68.03924999999998, 'model_b': 78.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 189 completed successfully
Sun Nov 16 05:09:48 PM CET 2025: Completed iteration 189

=== Iteration 190/300 ===
Sun Nov 16 05:09:48 PM CET 2025: Starting resource allocation negotiation iteration 190
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.00s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.39s (total since entry 16.41s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
8, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.76s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.32s (total since entry 7.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=25 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=40, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "gpu_hours": 50,\n    "cpu_hours": 15\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "gpu_hours": 50,\n    "cpu_hours": 15\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "gpu_hours": 50,\n    "cpu_hours": 15\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=50, CPU=15 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=45, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 55, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 55, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 55, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 55, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 55, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 55.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=45, CPU=15 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=45, CPU=15
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=450.00, marketing=390.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=163.30, marketing=131.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=450.00 - BATNA=286.70 = surplus=163.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=258.03 = surplus=131.97
âœ… Calculated utility_surplus: {'model_a': 163.29851250000002, 'model_b': 131.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 450, 'model_b': 390}
Metrics: {'utility_surplus': {'model_a': 163.29851250000002, 'model_b': 131.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 190 completed successfully
Sun Nov 16 05:10:46 PM CET 2025: Completed iteration 190

=== Iteration 191/300 ===
Sun Nov 16 05:10:46 PM CET 2025: Starting resource allocation negotiation iteration 191
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.97s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.34s (total since entry 16.33s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
7, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.76s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.38s (total since entry 7.14s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 5}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 5.0}
ğŸ’¡ Player model_b made offer GPU=20, CPU=15 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=70, CPU=5 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.5}
ğŸ’¡ Player model_a made offer GPU=50, CPU=10 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=22.5 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=20 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=113.30, marketing=111.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=286.70 = surplus=113.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=370.00 - BATNA=258.03 = surplus=111.97
âœ… Calculated utility_surplus: {'model_a': 113.29851250000002, 'model_b': 111.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 400, 'model_b': 370}
Metrics: {'utility_surplus': {'model_a': 113.29851250000002, 'model_b': 111.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 191 completed successfully
Sun Nov 16 05:11:33 PM CET 2025: Completed iteration 191

=== Iteration 192/300 ===
Sun Nov 16 05:11:33 PM CET 2025: Starting resource allocation negotiation iteration 192
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.04s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.40s (total since entry 16.46s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.76s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.35s (total since entry 7.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
11, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=20, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_a made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 36, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 36, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 36, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 36, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 36, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 36.0, 'cpu_hours': 24.0}
ğŸ’¡ Player model_a made offer GPU=45, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=36, CPU=24 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=45, CPU=20 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=45, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=480.00, marketing=430.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=188.93, marketing=168.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=480.00 - BATNA=291.07 = surplus=188.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=430.00 - BATNA=261.96 = surplus=168.04
âœ… Calculated utility_surplus: {'model_a': 188.9325, 'model_b': 168.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 480, 'model_b': 430}
Metrics: {'utility_surplus': {'model_a': 188.9325, 'model_b': 168.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 192 completed successfully
Sun Nov 16 05:12:17 PM CET 2025: Completed iteration 192

=== Iteration 193/300 ===
Sun Nov 16 05:12:17 PM CET 2025: Starting resource allocation negotiation iteration 193
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.30s (total since entry 16.34s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.39s (total since entry 7.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=20, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 29}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 29}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 29}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 29}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 29}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 29.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=29 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=103.30, marketing=121.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=258.03 = surplus=121.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=286.70 = surplus=103.30
âœ… Calculated utility_surplus: {'model_a': 121.96866125000003, 'model_b': 103.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 121.96866125000003, 'model_b': 103.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 193 completed successfully
Sun Nov 16 05:12:58 PM CET 2025: Completed iteration 193

=== Iteration 194/300 ===
Sun Nov 16 05:12:58 PM CET 2025: Starting resource allocation negotiation iteration 194
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.33s (total since entry 16.38s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
7, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.38s (total since entry 7.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=20, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered GPU=40, CPU=20 - Creating automatic agreement!
ğŸ” [RESOURCE DEBUG] Agreement in round 3: GPU=40, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from round 3
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=440.00, marketing=400.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=148.93, marketing=138.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=440.00 - BATNA=291.07 = surplus=148.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=261.96 = surplus=138.04
âœ… Calculated utility_surplus: {'model_a': 148.9325, 'model_b': 138.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 440, 'model_b': 400}
Metrics: {'utility_surplus': {'model_a': 148.9325, 'model_b': 138.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 194 completed successfully
Sun Nov 16 05:13:38 PM CET 2025: Completed iteration 194

=== Iteration 195/300 ===
Sun Nov 16 05:13:38 PM CET 2025: Starting resource allocation negotiation iteration 195
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.20s (total since entry 16.24s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.77s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.42s (total since entry 7.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.5}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=22.5 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=30 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=40, CPU=20 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=40, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=440.00, marketing=400.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=148.93, marketing=138.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=261.96 = surplus=138.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=440.00 - BATNA=291.07 = surplus=148.93
âœ… Calculated utility_surplus: {'model_a': 138.03924999999998, 'model_b': 148.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 440, 'model_a': 400}
Metrics: {'utility_surplus': {'model_a': 138.03924999999998, 'model_b': 148.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 195 completed successfully
Sun Nov 16 05:14:18 PM CET 2025: Completed iteration 195

=== Iteration 196/300 ===
Sun Nov 16 05:14:18 PM CET 2025: Starting resource allocation negotiation iteration 196
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.35s (total since entry 16.39s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
14, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.36s (total since entry 7.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=20, CPU=15 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 2)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 2 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=295.50, marketing=265.95
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=94.50, marketing=114.05
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=265.95 = surplus=114.05
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=295.50 = surplus=94.50
âœ… Calculated utility_surplus: {'model_a': 114.05000000000001, 'model_b': 94.5}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 114.05000000000001, 'model_b': 94.5}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 196 completed successfully
Sun Nov 16 05:15:01 PM CET 2025: Completed iteration 196

=== Iteration 197/300 ===
Sun Nov 16 05:15:01 PM CET 2025: Starting resource allocation negotiation iteration 197
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.04s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.33s (total since entry 16.39s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
20, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.40s (total since entry 7.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
8, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 27}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 28, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 28, 'cpu_hours': 27}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 28.0, 'cpu_hours': 27.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 19}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 19}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 19}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 37, 'cpu_hours': 19}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 37, 'cpu_hours': 19}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 37.0, 'cpu_hours': 19.0}
ğŸ’¡ Player model_b made offer GPU=28, CPU=27 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=37, CPU=19 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=30, CPU=25 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 28, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 28, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 28.0, 'cpu_hours': 22.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=37, CPU=19 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=37, CPU=19
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=410.00, marketing=374.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=118.93, marketing=112.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=410.00 - BATNA=291.07 = surplus=118.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=374.00 - BATNA=261.96 = surplus=112.04
âœ… Calculated utility_surplus: {'model_a': 118.9325, 'model_b': 112.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 410, 'model_b': 374}
Metrics: {'utility_surplus': {'model_a': 118.9325, 'model_b': 112.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 197 completed successfully
Sun Nov 16 05:15:52 PM CET 2025: Completed iteration 197

=== Iteration 198/300 ===
Sun Nov 16 05:15:52 PM CET 2025: Starting resource allocation negotiation iteration 198
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.05s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.42s (total since entry 16.49s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.43s (total since entry 7.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=20, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 26}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 26}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 26}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 28, 'cpu_hours': 26}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 28, 'cpu_hours': 26}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 28.0, 'cpu_hours': 26.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=28, CPU=26 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 24.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "gpu_hours": 31,\n    "cpu_hours": 24\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "gpu_hours": 31,\n    "cpu_hours": 24\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "gpu_hours": 31,\n    "cpu_hours": 24\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 31.0, 'cpu_hours': 24.0}
ğŸ’¡ Player model_a made offer GPU=32, CPU=24 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=31, CPU=24 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=32, CPU=24 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=32, CPU=24
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=384.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=113.30, marketing=125.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=286.70 = surplus=113.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=384.00 - BATNA=258.03 = surplus=125.97
âœ… Calculated utility_surplus: {'model_a': 113.29851250000002, 'model_b': 125.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 400, 'model_b': 384}
Metrics: {'utility_surplus': {'model_a': 113.29851250000002, 'model_b': 125.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 198 completed successfully
Sun Nov 16 05:16:39 PM CET 2025: Completed iteration 198

=== Iteration 199/300 ===
Sun Nov 16 05:16:39 PM CET 2025: Starting resource allocation negotiation iteration 199
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.98s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.40s (total since entry 16.41s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.76s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.56s (total since entry 7.32s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
14, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=50, CPU=10 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=45, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=40, CPU=10 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=45, CPU=15 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=32, CPU=28 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=32, CPU=28
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=424.00, marketing=416.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=137.30, marketing=157.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=424.00 - BATNA=286.70 = surplus=137.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=416.00 - BATNA=258.03 = surplus=157.97
âœ… Calculated utility_surplus: {'model_a': 137.29851250000002, 'model_b': 157.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 424, 'model_b': 416}
Metrics: {'utility_surplus': {'model_a': 137.29851250000002, 'model_b': 157.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 199 completed successfully
Sun Nov 16 05:17:24 PM CET 2025: Completed iteration 199

=== Iteration 200/300 ===
Sun Nov 16 05:17:24 PM CET 2025: Starting resource allocation negotiation iteration 200
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.35s (total since entry 16.40s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.37s (total since entry 7.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
17, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 5, "cpu_hours": 95}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 5, "cpu_hours": 95}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 5, "cpu_hours": 95}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 5, 'cpu_hours': 95}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 5, 'cpu_hours': 95}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 5.0, 'cpu_hours': 95.0}
âš ï¸ Player model_a offer violates constraints: GPU=5, CPU=95
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=50, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 70}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 70}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 70}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 70}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 70}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 70.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=25 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=20, CPU=70 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=20, CPU=70 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=20, CPU=70
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=580.00, marketing=680.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=293.30, marketing=421.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=680.00 - BATNA=258.03 = surplus=421.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=580.00 - BATNA=286.70 = surplus=293.30
âœ… Calculated utility_surplus: {'model_a': 421.96866125, 'model_b': 293.2985125}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 580, 'model_a': 680}
Metrics: {'utility_surplus': {'model_a': 421.96866125, 'model_b': 293.2985125}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 200 completed successfully
Sun Nov 16 05:18:17 PM CET 2025: Completed iteration 200

=== Iteration 201/300 ===
Sun Nov 16 05:18:17 PM CET 2025: Starting resource allocation negotiation iteration 201
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.97s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.39s (total since entry 16.37s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
16, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.42s (total since entry 7.14s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
8, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=98.93, marketing=118.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=261.96 = surplus=118.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=291.07 = surplus=98.93
âœ… Calculated utility_surplus: {'model_a': 118.03924999999998, 'model_b': 98.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 118.03924999999998, 'model_b': 98.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 201 completed successfully
Sun Nov 16 05:19:04 PM CET 2025: Completed iteration 201

=== Iteration 202/300 ===
Sun Nov 16 05:19:04 PM CET 2025: Starting resource allocation negotiation iteration 202
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.00s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.37s (total since entry 16.38s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.38s (total since entry 7.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
16, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=98.93, marketing=118.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=261.96 = surplus=118.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=291.07 = surplus=98.93
âœ… Calculated utility_surplus: {'model_a': 118.03924999999998, 'model_b': 98.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 118.03924999999998, 'model_b': 98.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 202 completed successfully
Sun Nov 16 05:19:55 PM CET 2025: Completed iteration 202

=== Iteration 203/300 ===
Sun Nov 16 05:19:55 PM CET 2025: Starting resource allocation negotiation iteration 203
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.38s (total since entry 16.41s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.56s (total since entry 7.30s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=50, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
â° Maximum rounds (5) reached - Ending negotiation
ğŸ² [ROLE DEBUG] No Agreement - Development=model_a, Marketing=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 203 completed successfully
Sun Nov 16 05:20:48 PM CET 2025: Completed iteration 203

=== Iteration 204/300 ===
Sun Nov 16 05:20:48 PM CET 2025: Starting resource allocation negotiation iteration 204
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.12s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.42s (total since entry 16.55s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.76s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.40s (total since entry 7.16s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=70, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=45, CPU=10 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=70, CPU=15 (made in round 1)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=70, CPU=15
ğŸ” [BATNA DEBUG] Using BATNA from offer round 1 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=300.00, marketing=270.00
ğŸ” [UTILITY DEBUG] Utilities: development=650.00, marketing=540.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=350.00, marketing=270.00
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=650.00 - BATNA=300.00 = surplus=350.00
ğŸ’° [UTILITY SURPLUS] model_b: utility=540.00 - BATNA=270.00 = surplus=270.00
âœ… Calculated utility_surplus: {'model_a': 350.0, 'model_b': 270.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 650, 'model_b': 540}
Metrics: {'utility_surplus': {'model_a': 350.0, 'model_b': 270.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 204 completed successfully
Sun Nov 16 05:21:36 PM CET 2025: Completed iteration 204

=== Iteration 205/300 ===
Sun Nov 16 05:21:36 PM CET 2025: Starting resource allocation negotiation iteration 205
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.43s (total since entry 16.47s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
11, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.41s (total since entry 7.14s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 60}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 60}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 60}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 60}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 60}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 60.0}
âš ï¸ Player model_b offer violates constraints: GPU=40, CPU=60
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 40.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=20, CPU=40 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=60, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=45, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=60, CPU=10 (made in round 1)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=60, CPU=10
ğŸ” [BATNA DEBUG] Using BATNA from offer round 1 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=300.00, marketing=270.00
ğŸ” [UTILITY DEBUG] Utilities: development=540.00, marketing=440.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=240.00, marketing=170.00
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=540.00 - BATNA=300.00 = surplus=240.00
ğŸ’° [UTILITY SURPLUS] model_b: utility=440.00 - BATNA=270.00 = surplus=170.00
âœ… Calculated utility_surplus: {'model_a': 240.0, 'model_b': 170.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 540, 'model_b': 440}
Metrics: {'utility_surplus': {'model_a': 240.0, 'model_b': 170.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 205 completed successfully
Sun Nov 16 05:22:20 PM CET 2025: Completed iteration 205

=== Iteration 206/300 ===
Sun Nov 16 05:22:20 PM CET 2025: Starting resource allocation negotiation iteration 206
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.41s (total since entry 16.45s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.39s (total since entry 7.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
17, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 5}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 5.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 40.0}
ğŸ’¡ Player model_a made offer GPU=70, CPU=5 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=20, CPU=40 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=60, CPU=10 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=50, CPU=15 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=60, CPU=10 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=60, CPU=10
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=540.00, marketing=440.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=248.93, marketing=178.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=540.00 - BATNA=291.07 = surplus=248.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=440.00 - BATNA=261.96 = surplus=178.04
âœ… Calculated utility_surplus: {'model_a': 248.9325, 'model_b': 178.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 540, 'model_b': 440}
Metrics: {'utility_surplus': {'model_a': 248.9325, 'model_b': 178.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 206 completed successfully
Sun Nov 16 05:22:59 PM CET 2025: Completed iteration 206

=== Iteration 207/300 ===
Sun Nov 16 05:22:59 PM CET 2025: Starting resource allocation negotiation iteration 207
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.00s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.47s (total since entry 16.49s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.43s (total since entry 7.18s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.5}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=22.5 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 29}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 29}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 29}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 29}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 29}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 31.0, 'cpu_hours': 29.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=30 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=31, CPU=29 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 26}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 26}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 26}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 26}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 26}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 26.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=30 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=30
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=420.00, marketing=420.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=133.30, marketing=161.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=420.00 - BATNA=258.03 = surplus=161.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=420.00 - BATNA=286.70 = surplus=133.30
âœ… Calculated utility_surplus: {'model_a': 161.96866125000003, 'model_b': 133.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 420, 'model_a': 420}
Metrics: {'utility_surplus': {'model_a': 161.96866125000003, 'model_b': 133.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 207 completed successfully
Sun Nov 16 05:23:49 PM CET 2025: Completed iteration 207

=== Iteration 208/300 ===
Sun Nov 16 05:23:49 PM CET 2025: Starting resource allocation negotiation iteration 208
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.98s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.36s (total since entry 16.36s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.40s (total since entry 7.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 0}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 0}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 0}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 75, 'cpu_hours': 0}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 75, 'cpu_hours': 0}
[DEBUG] Validation error: Invalid action type 'offer' for game 'resource_allocation'
[DEBUG] Raw response: {"type": "offer", "gpu_hours": 75, "cpu_hours": 0}
âš ï¸ [DEBUG] [model_a] Pydantic validation failed, using original: Action validation failed: Invalid action type 'offer' for game 'resource_allocation'
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=45, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=30 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=45, CPU=25 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=45, CPU=15 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=45, CPU=25 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=45, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=510.00, marketing=470.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=223.30, marketing=211.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=510.00 - BATNA=286.70 = surplus=223.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=470.00 - BATNA=258.03 = surplus=211.97
âœ… Calculated utility_surplus: {'model_a': 223.29851250000002, 'model_b': 211.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 510, 'model_b': 470}
Metrics: {'utility_surplus': {'model_a': 223.29851250000002, 'model_b': 211.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 208 completed successfully
Sun Nov 16 05:24:39 PM CET 2025: Completed iteration 208

=== Iteration 209/300 ===
Sun Nov 16 05:24:39 PM CET 2025: Starting resource allocation negotiation iteration 209
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.41s (total since entry 16.44s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.38s (total since entry 7.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 75, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 75, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 75.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=75, CPU=10 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=60, CPU=15 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=45, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=103.30, marketing=121.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=390.00 - BATNA=286.70 = surplus=103.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=380.00 - BATNA=258.03 = surplus=121.97
âœ… Calculated utility_surplus: {'model_a': 103.29851250000002, 'model_b': 121.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 390, 'model_b': 380}
Metrics: {'utility_surplus': {'model_a': 103.29851250000002, 'model_b': 121.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 209 completed successfully
Sun Nov 16 05:25:23 PM CET 2025: Completed iteration 209

=== Iteration 210/300 ===
Sun Nov 16 05:25:23 PM CET 2025: Starting resource allocation negotiation iteration 210
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.00s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.41s (total since entry 16.42s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.76s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.39s (total since entry 7.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
17, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=50, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=98.93, marketing=118.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=261.96 = surplus=118.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=291.07 = surplus=98.93
âœ… Calculated utility_surplus: {'model_a': 118.03924999999998, 'model_b': 98.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 118.03924999999998, 'model_b': 98.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 210 completed successfully
Sun Nov 16 05:26:01 PM CET 2025: Completed iteration 210

=== Iteration 211/300 ===
Sun Nov 16 05:26:01 PM CET 2025: Starting resource allocation negotiation iteration 211
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.43s (total since entry 16.46s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
16, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.40s (total since entry 7.14s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
8, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=60, CPU=10 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 55, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 55, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 55, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 55, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 55, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 55.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.5}
ğŸ’¡ Player model_a made offer GPU=55, CPU=15 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=22.5 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 17.5}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 17.5}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 17.5}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 17.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 17.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 17.5}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=45, CPU=17.5 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=55, CPU=15 (made in round 2)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=55, CPU=15
ğŸ” [BATNA DEBUG] Using BATNA from offer round 2 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=295.50, marketing=265.95
ğŸ” [UTILITY DEBUG] Utilities: development=530.00, marketing=450.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=234.50, marketing=184.05
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=530.00 - BATNA=295.50 = surplus=234.50
ğŸ’° [UTILITY SURPLUS] model_b: utility=450.00 - BATNA=265.95 = surplus=184.05
âœ… Calculated utility_surplus: {'model_a': 234.5, 'model_b': 184.05}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 530, 'model_b': 450}
Metrics: {'utility_surplus': {'model_a': 234.5, 'model_b': 184.05}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 211 completed successfully
Sun Nov 16 05:26:51 PM CET 2025: Completed iteration 211

=== Iteration 212/300 ===
Sun Nov 16 05:26:51 PM CET 2025: Starting resource allocation negotiation iteration 212
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.00s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.49s (total since entry 16.51s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.91s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.43s (total since entry 7.34s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=10 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=45, CPU=15 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=103.30, marketing=121.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=258.03 = surplus=121.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=286.70 = surplus=103.30
âœ… Calculated utility_surplus: {'model_a': 121.96866125000003, 'model_b': 103.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 121.96866125000003, 'model_b': 103.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 212 completed successfully
Sun Nov 16 05:27:40 PM CET 2025: Completed iteration 212

=== Iteration 213/300 ===
Sun Nov 16 05:27:40 PM CET 2025: Starting resource allocation negotiation iteration 213
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.05s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.62s (total since entry 16.69s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.41s (total since entry 7.16s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 26}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 26}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 26}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 26}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 26}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 26.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 23.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=26 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=23 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 33.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_b made offer GPU=33, CPU=22 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 24.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=32, CPU=24 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 36, "cpu_hours": 21}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 36, "cpu_hours": 21}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 36, "cpu_hours": 21}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 36, 'cpu_hours': 21}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 36, 'cpu_hours': 21}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 36.0, 'cpu_hours': 21.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 37, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 37, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 37.0, 'cpu_hours': 23.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=32, CPU=24 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=32, CPU=24
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=384.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=113.30, marketing=125.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=384.00 - BATNA=258.03 = surplus=125.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=286.70 = surplus=113.30
âœ… Calculated utility_surplus: {'model_a': 125.96866125000003, 'model_b': 113.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 400, 'model_a': 384}
Metrics: {'utility_surplus': {'model_a': 125.96866125000003, 'model_b': 113.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 213 completed successfully
Sun Nov 16 05:28:36 PM CET 2025: Completed iteration 213

=== Iteration 214/300 ===
Sun Nov 16 05:28:36 PM CET 2025: Starting resource allocation negotiation iteration 214
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.43s (total since entry 16.47s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.40s (total since entry 7.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=20, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 34, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 34, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 34.0, 'cpu_hours': 23.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=34, CPU=23 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "gpu_hours": 40,\n  "cpu_hours": 20\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "gpu_hours": 40,\n  "cpu_hours": 20\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "gpu_hours": 40,\n  "cpu_hours": 20\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=30 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=40, CPU=20 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=40, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=440.00, marketing=400.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=153.30, marketing=141.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=258.03 = surplus=141.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=440.00 - BATNA=286.70 = surplus=153.30
âœ… Calculated utility_surplus: {'model_a': 141.96866125000003, 'model_b': 153.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 440, 'model_a': 400}
Metrics: {'utility_surplus': {'model_a': 141.96866125000003, 'model_b': 153.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 214 completed successfully
Sun Nov 16 05:29:21 PM CET 2025: Completed iteration 214

=== Iteration 215/300 ===
Sun Nov 16 05:29:21 PM CET 2025: Starting resource allocation negotiation iteration 215
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.56s (total since entry 16.60s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
15, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.39s (total since entry 7.33s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
6, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=70, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 28.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=28 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=45, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 32}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 32}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 32}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 32}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 32}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 32.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=32 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=40, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "gpu_hours": 35,\n  "cpu_hours": 20\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "gpu_hours": 35,\n  "cpu_hours": 20\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "gpu_hours": 35,\n  "cpu_hours": 20\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=40, CPU=25 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=40, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=470.00, marketing=440.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=178.93, marketing=178.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=470.00 - BATNA=291.07 = surplus=178.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=440.00 - BATNA=261.96 = surplus=178.04
âœ… Calculated utility_surplus: {'model_a': 178.9325, 'model_b': 178.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 470, 'model_b': 440}
Metrics: {'utility_surplus': {'model_a': 178.9325, 'model_b': 178.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 215 completed successfully
Sun Nov 16 05:30:14 PM CET 2025: Completed iteration 215

=== Iteration 216/300 ===
Sun Nov 16 05:30:14 PM CET 2025: Starting resource allocation negotiation iteration 216
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.04s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.41s (total since entry 16.46s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.79s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.40s (total since entry 7.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
5, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.5}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=22.5 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27.5}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27.5}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27.5}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27.5}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 27.5}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=27.5 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 33.0, 'cpu_hours': 23.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=33, CPU=23 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=27.5 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=27.5
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=405.00, marketing=400.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=113.93, marketing=138.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=261.96 = surplus=138.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=405.00 - BATNA=291.07 = surplus=113.93
âœ… Calculated utility_surplus: {'model_a': 138.03924999999998, 'model_b': 113.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 405.0, 'model_a': 400.0}
Metrics: {'utility_surplus': {'model_a': 138.03924999999998, 'model_b': 113.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 216 completed successfully
Sun Nov 16 05:31:06 PM CET 2025: Completed iteration 216

=== Iteration 217/300 ===
Sun Nov 16 05:31:06 PM CET 2025: Starting resource allocation negotiation iteration 217
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.06s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.31s (total since entry 16.38s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
5, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.43s (total since entry 7.16s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 23}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 23}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 23.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 31.0, 'cpu_hours': 24.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=23 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=31, CPU=24 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=31, CPU=24 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=31, CPU=24
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=392.00, marketing=378.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=105.30, marketing=119.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=378.00 - BATNA=258.03 = surplus=119.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=392.00 - BATNA=286.70 = surplus=105.30
âœ… Calculated utility_surplus: {'model_a': 119.96866125000003, 'model_b': 105.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 392, 'model_a': 378}
Metrics: {'utility_surplus': {'model_a': 119.96866125000003, 'model_b': 105.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 217 completed successfully
Sun Nov 16 05:31:49 PM CET 2025: Completed iteration 217

=== Iteration 218/300 ===
Sun Nov 16 05:31:49 PM CET 2025: Starting resource allocation negotiation iteration 218
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.00s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.41s (total since entry 16.43s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
16, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.36s (total since entry 7.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=30 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 37, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 37, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 37.0, 'cpu_hours': 23.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=37, CPU=23 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=98.93, marketing=118.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=261.96 = surplus=118.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=291.07 = surplus=98.93
âœ… Calculated utility_surplus: {'model_a': 118.03924999999998, 'model_b': 98.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 118.03924999999998, 'model_b': 98.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 218 completed successfully
Sun Nov 16 05:32:33 PM CET 2025: Completed iteration 218

=== Iteration 219/300 ===
Sun Nov 16 05:32:33 PM CET 2025: Starting resource allocation negotiation iteration 219
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.43s (total since entry 16.45s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
5, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.37s (total since entry 7.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_a made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=30 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=40, CPU=20 (made in round 2)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=40, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 2 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=295.50, marketing=265.95
ğŸ” [UTILITY DEBUG] Utilities: development=440.00, marketing=400.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=144.50, marketing=134.05
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=440.00 - BATNA=295.50 = surplus=144.50
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=265.95 = surplus=134.05
âœ… Calculated utility_surplus: {'model_a': 144.5, 'model_b': 134.05}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 440, 'model_b': 400}
Metrics: {'utility_surplus': {'model_a': 144.5, 'model_b': 134.05}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 219 completed successfully
Sun Nov 16 05:33:19 PM CET 2025: Completed iteration 219

=== Iteration 220/300 ===
Sun Nov 16 05:33:19 PM CET 2025: Starting resource allocation negotiation iteration 220
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.34s (total since entry 16.39s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.80s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.36s (total since entry 7.16s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 36, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 36, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 36, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 36, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 36, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 36.0, 'cpu_hours': 24.0}
ğŸ’¡ Player model_a made offer GPU=20, CPU=30 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=36, CPU=24 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 26}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 26}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 26}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 37, 'cpu_hours': 26}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 37, 'cpu_hours': 26}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 37.0, 'cpu_hours': 26.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=37, CPU=26 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 25}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 25}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 25.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
â° Maximum rounds (5) reached - Ending negotiation
ğŸ² [ROLE DEBUG] No Agreement - Development=model_b, Marketing=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 220 completed successfully
Sun Nov 16 05:34:10 PM CET 2025: Completed iteration 220

=== Iteration 221/300 ===
Sun Nov 16 05:34:10 PM CET 2025: Starting resource allocation negotiation iteration 221
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.30s (total since entry 16.33s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.35s (total since entry 7.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
5, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 24.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=24 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 34, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 34, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 34.0, 'cpu_hours': 23.0}
ğŸ’¡ Player model_b made offer GPU=34, CPU=23 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=98.93, marketing=118.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=390.00 - BATNA=291.07 = surplus=98.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=380.00 - BATNA=261.96 = surplus=118.04
âœ… Calculated utility_surplus: {'model_a': 98.9325, 'model_b': 118.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 390, 'model_b': 380}
Metrics: {'utility_surplus': {'model_a': 98.9325, 'model_b': 118.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 221 completed successfully
Sun Nov 16 05:35:00 PM CET 2025: Completed iteration 221

=== Iteration 222/300 ===
Sun Nov 16 05:35:00 PM CET 2025: Starting resource allocation negotiation iteration 222
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.05s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.27s (total since entry 16.33s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
12, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.76s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.36s (total since entry 7.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 5}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 5.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=70, CPU=5 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_a made offer GPU=50, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=50, CPU=10 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=40, CPU=15 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=40, CPU=15
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=410.00, marketing=360.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=118.93, marketing=98.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=410.00 - BATNA=291.07 = surplus=118.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=360.00 - BATNA=261.96 = surplus=98.04
âœ… Calculated utility_surplus: {'model_a': 118.9325, 'model_b': 98.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 410, 'model_b': 360}
Metrics: {'utility_surplus': {'model_a': 118.9325, 'model_b': 98.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 222 completed successfully
Sun Nov 16 05:35:45 PM CET 2025: Completed iteration 222

=== Iteration 223/300 ===
Sun Nov 16 05:35:45 PM CET 2025: Starting resource allocation negotiation iteration 223
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.40s (total since entry 16.44s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.36s (total since entry 7.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 37, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 37, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 37.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=37, CPU=15 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=35, CPU=22 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=35, CPU=22
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=412.00, marketing=386.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=120.93, marketing=124.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=412.00 - BATNA=291.07 = surplus=120.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=386.00 - BATNA=261.96 = surplus=124.04
âœ… Calculated utility_surplus: {'model_a': 120.9325, 'model_b': 124.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 412, 'model_b': 386}
Metrics: {'utility_surplus': {'model_a': 120.9325, 'model_b': 124.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 223 completed successfully
Sun Nov 16 05:36:27 PM CET 2025: Completed iteration 223

=== Iteration 224/300 ===
Sun Nov 16 05:36:27 PM CET 2025: Starting resource allocation negotiation iteration 224
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.38s (total since entry 16.43s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.38s (total since entry 7.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
7, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=30 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=40, CPU=15 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=40, CPU=15
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=410.00, marketing=360.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=118.93, marketing=98.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=360.00 - BATNA=261.96 = surplus=98.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=410.00 - BATNA=291.07 = surplus=118.93
âœ… Calculated utility_surplus: {'model_a': 98.03924999999998, 'model_b': 118.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 410, 'model_a': 360}
Metrics: {'utility_surplus': {'model_a': 98.03924999999998, 'model_b': 118.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 224 completed successfully
Sun Nov 16 05:37:12 PM CET 2025: Completed iteration 224

=== Iteration 225/300 ===
Sun Nov 16 05:37:12 PM CET 2025: Starting resource allocation negotiation iteration 225
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.39s (total since entry 16.42s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.38s (total since entry 7.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=20, CPU=10 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 35}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 35}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 35}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 35}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 35}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 25.0, 'cpu_hours': 35.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=25, CPU=35 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "gpu_hours": 40,\n    "cpu_hours": 10\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "gpu_hours": 40,\n    "cpu_hours": 10\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "gpu_hours": 40,\n    "cpu_hours": 10\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=103.30, marketing=121.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=258.03 = surplus=121.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=286.70 = surplus=103.30
âœ… Calculated utility_surplus: {'model_a': 121.96866125000003, 'model_b': 103.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 121.96866125000003, 'model_b': 103.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 225 completed successfully
Sun Nov 16 05:38:02 PM CET 2025: Completed iteration 225

=== Iteration 226/300 ===
Sun Nov 16 05:38:02 PM CET 2025: Starting resource allocation negotiation iteration 226
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.45s (total since entry 16.49s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.40s (total since entry 7.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
13, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=20, CPU=30 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 32}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 32}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 32}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 28, 'cpu_hours': 32}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 28, 'cpu_hours': 32}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 28.0, 'cpu_hours': 32.0}
ğŸ’¡ Player model_b made offer GPU=28, CPU=32 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 26}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 26}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 26}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 26}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 26}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 31.0, 'cpu_hours': 26.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=31, CPU=26 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=20 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=108.93, marketing=108.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=291.07 = surplus=108.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=370.00 - BATNA=261.96 = surplus=108.04
âœ… Calculated utility_surplus: {'model_a': 108.9325, 'model_b': 108.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 400, 'model_b': 370}
Metrics: {'utility_surplus': {'model_a': 108.9325, 'model_b': 108.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 226 completed successfully
Sun Nov 16 05:38:45 PM CET 2025: Completed iteration 226

=== Iteration 227/300 ===
Sun Nov 16 05:38:45 PM CET 2025: Starting resource allocation negotiation iteration 227
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.37s (total since entry 16.42s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.78s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.33s (total since entry 7.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
18, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 35}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 35}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 35.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=35 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=70, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 35}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 35}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 35}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 35}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 35}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 35.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=45, CPU=35 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=60, CPU=10 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "gpu_hours": 35,\n  "cpu_hours": 25\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "gpu_hours": 35,\n  "cpu_hours": 25\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "gpu_hours": 35,\n  "cpu_hours": 25\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=25 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=45, CPU=15 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "gpu_hours": 40,\n  "cpu_hours": 20\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "gpu_hours": 40,\n  "cpu_hours": 20\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "gpu_hours": 40,\n  "cpu_hours": 20\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
â° Maximum rounds (5) reached - Ending negotiation
ğŸ² [ROLE DEBUG] No Agreement - Development=model_a, Marketing=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 227 completed successfully
Sun Nov 16 05:39:35 PM CET 2025: Completed iteration 227

=== Iteration 228/300 ===
Sun Nov 16 05:39:35 PM CET 2025: Starting resource allocation negotiation iteration 228
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.41s (total since entry 16.44s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.38s (total since entry 7.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.5}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22.5 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 23.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 27.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=23 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=27 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 27.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=27 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=40, CPU=20 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=40, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=440.00, marketing=400.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=153.30, marketing=141.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=258.03 = surplus=141.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=440.00 - BATNA=286.70 = surplus=153.30
âœ… Calculated utility_surplus: {'model_a': 141.96866125000003, 'model_b': 153.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 440, 'model_a': 400}
Metrics: {'utility_surplus': {'model_a': 141.96866125000003, 'model_b': 153.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 228 completed successfully
Sun Nov 16 05:40:23 PM CET 2025: Completed iteration 228

=== Iteration 229/300 ===
Sun Nov 16 05:40:23 PM CET 2025: Starting resource allocation negotiation iteration 229
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.04s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.38s (total since entry 16.43s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
9, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.36s (total since entry 7.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.5}
ğŸ’¡ Player model_a made offer GPU=45, CPU=15 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=22.5 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_a made offer GPU=40, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 38, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 38, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 38, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 38, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 38, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 38.0, 'cpu_hours': 24.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=40, CPU=20 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=40, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=440.00, marketing=400.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=153.30, marketing=141.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=440.00 - BATNA=286.70 = surplus=153.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=258.03 = surplus=141.97
âœ… Calculated utility_surplus: {'model_a': 153.29851250000002, 'model_b': 141.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 440, 'model_b': 400}
Metrics: {'utility_surplus': {'model_a': 153.29851250000002, 'model_b': 141.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 229 completed successfully
Sun Nov 16 05:41:11 PM CET 2025: Completed iteration 229

=== Iteration 230/300 ===
Sun Nov 16 05:41:11 PM CET 2025: Starting resource allocation negotiation iteration 230
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.33s (total since entry 16.38s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.36s (total since entry 7.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 0}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 0}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 0}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 0}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 0}
[DEBUG] Validation error: Invalid action type 'offer' for game 'resource_allocation'
[DEBUG] Raw response: {"type": "offer", "gpu_hours": 40, "cpu_hours": 0}
âš ï¸ [DEBUG] [model_b] Pydantic validation failed, using original: Action validation failed: Invalid action type 'offer' for game 'resource_allocation'
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 27}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 27}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 33.0, 'cpu_hours': 27.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=33, CPU=27 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=98.93, marketing=118.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=261.96 = surplus=118.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=291.07 = surplus=98.93
âœ… Calculated utility_surplus: {'model_a': 118.03924999999998, 'model_b': 98.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 118.03924999999998, 'model_b': 98.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 230 completed successfully
Sun Nov 16 05:41:59 PM CET 2025: Completed iteration 230

=== Iteration 231/300 ===
Sun Nov 16 05:41:59 PM CET 2025: Starting resource allocation negotiation iteration 231
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.98s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.37s (total since entry 16.37s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
15, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.40s (total since entry 7.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
8, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=28 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=25 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=35, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=430.00, marketing=410.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=143.30, marketing=151.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=430.00 - BATNA=286.70 = surplus=143.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=410.00 - BATNA=258.03 = surplus=151.97
âœ… Calculated utility_surplus: {'model_a': 143.29851250000002, 'model_b': 151.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 430, 'model_b': 410}
Metrics: {'utility_surplus': {'model_a': 143.29851250000002, 'model_b': 151.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 231 completed successfully
Sun Nov 16 05:42:41 PM CET 2025: Completed iteration 231

=== Iteration 232/300 ===
Sun Nov 16 05:42:41 PM CET 2025: Starting resource allocation negotiation iteration 232
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.38s (total since entry 16.42s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.41s (total since entry 7.14s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "gpu_hours": 40,\n    "cpu_hours": 10\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "gpu_hours": 40,\n    "cpu_hours": 10\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "gpu_hours": 40,\n    "cpu_hours": 10\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 27.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=27 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=27 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=27
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=402.00, marketing=396.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=115.30, marketing=137.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=396.00 - BATNA=258.03 = surplus=137.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=402.00 - BATNA=286.70 = surplus=115.30
âœ… Calculated utility_surplus: {'model_a': 137.96866125000003, 'model_b': 115.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 402, 'model_a': 396}
Metrics: {'utility_surplus': {'model_a': 137.96866125000003, 'model_b': 115.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 232 completed successfully
Sun Nov 16 05:43:22 PM CET 2025: Completed iteration 232

=== Iteration 233/300 ===
Sun Nov 16 05:43:22 PM CET 2025: Starting resource allocation negotiation iteration 233
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.05s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.36s (total since entry 16.44s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
9, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.42s (total since entry 7.16s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
6, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 26}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 26}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 26}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 26}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 26}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 26.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=26 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=40, CPU=20 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=40, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=440.00, marketing=400.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=148.93, marketing=138.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=261.96 = surplus=138.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=440.00 - BATNA=291.07 = surplus=148.93
âœ… Calculated utility_surplus: {'model_a': 138.03924999999998, 'model_b': 148.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 440, 'model_a': 400}
Metrics: {'utility_surplus': {'model_a': 138.03924999999998, 'model_b': 148.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 233 completed successfully
Sun Nov 16 05:44:01 PM CET 2025: Completed iteration 233

=== Iteration 234/300 ===
Sun Nov 16 05:44:01 PM CET 2025: Starting resource allocation negotiation iteration 234
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.07s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.41s (total since entry 16.50s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.39s (total since entry 7.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=20, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=15 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=45, CPU=10 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=15 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=35, CPU=15
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=370.00, marketing=330.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=78.93, marketing=68.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=330.00 - BATNA=261.96 = surplus=68.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=370.00 - BATNA=291.07 = surplus=78.93
âœ… Calculated utility_surplus: {'model_a': 68.03924999999998, 'model_b': 78.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 370, 'model_a': 330}
Metrics: {'utility_surplus': {'model_a': 68.03924999999998, 'model_b': 78.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 234 completed successfully
Sun Nov 16 05:44:51 PM CET 2025: Completed iteration 234

=== Iteration 235/300 ===
Sun Nov 16 05:44:51 PM CET 2025: Starting resource allocation negotiation iteration 235
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.05s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.50s (total since entry 16.56s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.42s (total since entry 7.16s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 40.0}
ğŸ’¡ Player model_a made offer GPU=70, CPU=10 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=20, CPU=40 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=28 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=30 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, ROLE B}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 30, ROLE B}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, ROLE B}'
âš ï¸ [DEBUG] [model_b] JSON decode error for start match: Expecting property name enclosed in double quotes: line 1 column 36 (char 35)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", "gpu_hours": 30, ROLE B}...': Expecting property name enclosed in double quotes: line 1 column 36 (char 35)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", "gpu_hours": 30, ROLE B}...': Expecting property name enclosed in double quotes: line 1 column 36 (char 35)
âš ï¸ [DEBUG] [model_b] Extracted JSON decode error: Expecting property name enclosed in double quotes: line 1 column 36 (char 35)
âœ… [DEBUG] [model_b] Manually extracted action: {'type': 'offer'}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=20 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=113.30, marketing=111.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=286.70 = surplus=113.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=370.00 - BATNA=258.03 = surplus=111.97
âœ… Calculated utility_surplus: {'model_a': 113.29851250000002, 'model_b': 111.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 400, 'model_b': 370}
Metrics: {'utility_surplus': {'model_a': 113.29851250000002, 'model_b': 111.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 235 completed successfully
Sun Nov 16 05:45:43 PM CET 2025: Completed iteration 235

=== Iteration 236/300 ===
Sun Nov 16 05:45:43 PM CET 2025: Starting resource allocation negotiation iteration 236
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.04s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.45s (total since entry 16.51s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.43s (total since entry 7.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=20, CPU=30 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=70, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_a made offer GPU=60, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 55, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 55, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 55, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 55, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 55, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 55.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=55, CPU=10 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=45, CPU=15 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=55, CPU=10 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=55, CPU=10
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=500.00, marketing=410.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=208.93, marketing=148.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=500.00 - BATNA=291.07 = surplus=208.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=410.00 - BATNA=261.96 = surplus=148.04
âœ… Calculated utility_surplus: {'model_a': 208.9325, 'model_b': 148.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 500, 'model_b': 410}
Metrics: {'utility_surplus': {'model_a': 208.9325, 'model_b': 148.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 236 completed successfully
Sun Nov 16 05:46:23 PM CET 2025: Completed iteration 236

=== Iteration 237/300 ===
Sun Nov 16 05:46:23 PM CET 2025: Starting resource allocation negotiation iteration 237
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.39s (total since entry 16.43s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.06s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.38s (total since entry 7.44s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
12, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=50, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=40, CPU=20 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered GPU=40, CPU=20 - Creating automatic agreement!
ğŸ” [RESOURCE DEBUG] Agreement in round 3: GPU=40, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from round 3
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=440.00, marketing=400.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=148.93, marketing=138.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=440.00 - BATNA=291.07 = surplus=148.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=261.96 = surplus=138.04
âœ… Calculated utility_surplus: {'model_a': 148.9325, 'model_b': 138.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 440, 'model_b': 400}
Metrics: {'utility_surplus': {'model_a': 148.9325, 'model_b': 138.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 237 completed successfully
Sun Nov 16 05:47:02 PM CET 2025: Completed iteration 237

=== Iteration 238/300 ===
Sun Nov 16 05:47:02 PM CET 2025: Starting resource allocation negotiation iteration 238
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.04s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.49s (total since entry 16.54s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
19, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.49s (total since entry 7.21s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=15 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=45, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=15 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=98.93, marketing=118.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=261.96 = surplus=118.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=291.07 = surplus=98.93
âœ… Calculated utility_surplus: {'model_a': 118.03924999999998, 'model_b': 98.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 118.03924999999998, 'model_b': 98.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 238 completed successfully
Sun Nov 16 05:47:53 PM CET 2025: Completed iteration 238

=== Iteration 239/300 ===
Sun Nov 16 05:47:53 PM CET 2025: Starting resource allocation negotiation iteration 239
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.99s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.44s (total since entry 16.45s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.44s (total since entry 7.17s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 23.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=23 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=20, CPU=30 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=32, CPU=23 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=32, CPU=23
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=394.00, marketing=376.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=102.93, marketing=114.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=376.00 - BATNA=261.96 = surplus=114.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=394.00 - BATNA=291.07 = surplus=102.93
âœ… Calculated utility_surplus: {'model_a': 114.03924999999998, 'model_b': 102.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 394, 'model_a': 376}
Metrics: {'utility_surplus': {'model_a': 114.03924999999998, 'model_b': 102.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 239 completed successfully
Sun Nov 16 05:48:43 PM CET 2025: Completed iteration 239

=== Iteration 240/300 ===
Sun Nov 16 05:48:43 PM CET 2025: Starting resource allocation negotiation iteration 240
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.08s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.45s (total since entry 16.55s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.77s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.44s (total since entry 7.21s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
5, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=70, CPU=15 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=30 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=60, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=45, CPU=22 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 55, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 55, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 55, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 55, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 55, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 55.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=55, CPU=10 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=40, CPU=20 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=40, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=440.00, marketing=400.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=153.30, marketing=141.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=440.00 - BATNA=286.70 = surplus=153.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=258.03 = surplus=141.97
âœ… Calculated utility_surplus: {'model_a': 153.29851250000002, 'model_b': 141.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 440, 'model_b': 400}
Metrics: {'utility_surplus': {'model_a': 153.29851250000002, 'model_b': 141.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 240 completed successfully
Sun Nov 16 05:49:30 PM CET 2025: Completed iteration 240

=== Iteration 241/300 ===
Sun Nov 16 05:49:30 PM CET 2025: Starting resource allocation negotiation iteration 241
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.00s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.46s (total since entry 16.48s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
11, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.46s (total since entry 7.21s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 33.0, 'cpu_hours': 23.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=33, CPU=23 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=33, CPU=23 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=33, CPU=23
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=402.00, marketing=382.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=110.93, marketing=120.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=382.00 - BATNA=261.96 = surplus=120.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=402.00 - BATNA=291.07 = surplus=110.93
âœ… Calculated utility_surplus: {'model_a': 120.03924999999998, 'model_b': 110.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 402, 'model_a': 382}
Metrics: {'utility_surplus': {'model_a': 120.03924999999998, 'model_b': 110.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 241 completed successfully
Sun Nov 16 05:50:13 PM CET 2025: Completed iteration 241

=== Iteration 242/300 ===
Sun Nov 16 05:50:13 PM CET 2025: Starting resource allocation negotiation iteration 242
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.46s (total since entry 16.49s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.47s (total since entry 7.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=35, CPU=20 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=108.93, marketing=108.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=370.00 - BATNA=261.96 = surplus=108.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=291.07 = surplus=108.93
âœ… Calculated utility_surplus: {'model_a': 108.03924999999998, 'model_b': 108.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 400, 'model_a': 370}
Metrics: {'utility_surplus': {'model_a': 108.03924999999998, 'model_b': 108.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 242 completed successfully
Sun Nov 16 05:50:59 PM CET 2025: Completed iteration 242

=== Iteration 243/300 ===
Sun Nov 16 05:50:59 PM CET 2025: Starting resource allocation negotiation iteration 243
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.24s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.35s (total since entry 16.61s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
13, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.41s (total since entry 7.14s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
6, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=70, CPU=10 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=45, CPU=15 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=45, CPU=15 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered GPU=45, CPU=15 - Creating automatic agreement!
ğŸ” [RESOURCE DEBUG] Agreement in round 2: GPU=45, CPU=15
ğŸ” [BATNA DEBUG] Using BATNA from round 2
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=295.50, marketing=265.95
ğŸ” [UTILITY DEBUG] Utilities: development=450.00, marketing=390.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=154.50, marketing=124.05
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=450.00 - BATNA=295.50 = surplus=154.50
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=265.95 = surplus=124.05
âœ… Calculated utility_surplus: {'model_a': 154.5, 'model_b': 124.05000000000001}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 450, 'model_b': 390}
Metrics: {'utility_surplus': {'model_a': 154.5, 'model_b': 124.05000000000001}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 243 completed successfully
Sun Nov 16 05:51:34 PM CET 2025: Completed iteration 243

=== Iteration 244/300 ===
Sun Nov 16 05:51:34 PM CET 2025: Starting resource allocation negotiation iteration 244
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.50s (total since entry 16.55s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.48s (total since entry 7.22s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=70, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "gpu_hours": 50,\n    "cpu_hours": 15\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "gpu_hours": 50,\n    "cpu_hours": 15\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "gpu_hours": 50,\n    "cpu_hours": 15\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=50, CPU=15 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=60, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_a made offer GPU=70, CPU=10 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=30 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=40, CPU=30 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=40, CPU=30
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=500.00, marketing=480.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=208.93, marketing=218.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=500.00 - BATNA=291.07 = surplus=208.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=480.00 - BATNA=261.96 = surplus=218.04
âœ… Calculated utility_surplus: {'model_a': 208.9325, 'model_b': 218.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 500, 'model_b': 480}
Metrics: {'utility_surplus': {'model_a': 208.9325, 'model_b': 218.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 244 completed successfully
Sun Nov 16 05:52:19 PM CET 2025: Completed iteration 244

=== Iteration 245/300 ===
Sun Nov 16 05:52:19 PM CET 2025: Starting resource allocation negotiation iteration 245
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.06s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.46s (total since entry 16.54s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.41s (total since entry 7.16s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 40.0}
ğŸ’¡ Player model_a made offer GPU=70, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=20, CPU=40 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 28.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=28 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=60, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=60, CPU=15 (made in round 2)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=60, CPU=15
ğŸ” [BATNA DEBUG] Using BATNA from offer round 2 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=295.50, marketing=265.95
ğŸ” [UTILITY DEBUG] Utilities: development=570.00, marketing=480.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=274.50, marketing=214.05
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=570.00 - BATNA=295.50 = surplus=274.50
ğŸ’° [UTILITY SURPLUS] model_b: utility=480.00 - BATNA=265.95 = surplus=214.05
âœ… Calculated utility_surplus: {'model_a': 274.5, 'model_b': 214.05}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 570, 'model_b': 480}
Metrics: {'utility_surplus': {'model_a': 274.5, 'model_b': 214.05}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 245 completed successfully
Sun Nov 16 05:53:11 PM CET 2025: Completed iteration 245

=== Iteration 246/300 ===
Sun Nov 16 05:53:11 PM CET 2025: Starting resource allocation negotiation iteration 246
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.38s (total since entry 16.43s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.76s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.39s (total since entry 7.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=70, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=40, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=15 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=35, CPU=22 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=35, CPU=22
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=412.00, marketing=386.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=120.93, marketing=124.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=412.00 - BATNA=291.07 = surplus=120.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=386.00 - BATNA=261.96 = surplus=124.04
âœ… Calculated utility_surplus: {'model_a': 120.9325, 'model_b': 124.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 412, 'model_b': 386}
Metrics: {'utility_surplus': {'model_a': 120.9325, 'model_b': 124.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 246 completed successfully
Sun Nov 16 05:53:57 PM CET 2025: Completed iteration 246

=== Iteration 247/300 ===
Sun Nov 16 05:53:57 PM CET 2025: Starting resource allocation negotiation iteration 247
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.00s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.46s (total since entry 16.48s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.77s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.40s (total since entry 7.17s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 5}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 5.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=70, CPU=5 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=15 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=50, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_a made offer GPU=45, CPU=15 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=50, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 35}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 35}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 35.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=45, CPU=15 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=45, CPU=15
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=450.00, marketing=390.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=158.93, marketing=128.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=450.00 - BATNA=291.07 = surplus=158.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=261.96 = surplus=128.04
âœ… Calculated utility_surplus: {'model_a': 158.9325, 'model_b': 128.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 450, 'model_b': 390}
Metrics: {'utility_surplus': {'model_a': 158.9325, 'model_b': 128.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 247 completed successfully
Sun Nov 16 05:54:44 PM CET 2025: Completed iteration 247

=== Iteration 248/300 ===
Sun Nov 16 05:54:44 PM CET 2025: Starting resource allocation negotiation iteration 248
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.40s (total since entry 16.43s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.35s (total since entry 7.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 33.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=33, CPU=22 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=103.30, marketing=121.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=258.03 = surplus=121.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=286.70 = surplus=103.30
âœ… Calculated utility_surplus: {'model_a': 121.96866125000003, 'model_b': 103.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 121.96866125000003, 'model_b': 103.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 248 completed successfully
Sun Nov 16 05:55:34 PM CET 2025: Completed iteration 248

=== Iteration 249/300 ===
Sun Nov 16 05:55:34 PM CET 2025: Starting resource allocation negotiation iteration 249
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.00s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.47s (total since entry 16.48s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
12, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.39s (total since entry 7.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
8, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=20, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 28, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 28, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 28.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 27.0}
ğŸ’¡ Player model_b made offer GPU=28, CPU=22 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=27 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 24.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=24 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 26}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 26}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 26}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 26}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 26}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 31.0, 'cpu_hours': 26.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=31, CPU=26 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=98.93, marketing=118.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=261.96 = surplus=118.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=291.07 = surplus=98.93
âœ… Calculated utility_surplus: {'model_a': 118.03924999999998, 'model_b': 98.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 118.03924999999998, 'model_b': 98.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 249 completed successfully
Sun Nov 16 05:56:25 PM CET 2025: Completed iteration 249

=== Iteration 250/300 ===
Sun Nov 16 05:56:25 PM CET 2025: Starting resource allocation negotiation iteration 250
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.04s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.38s (total since entry 16.44s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.39s (total since entry 7.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 60}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 60}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 60}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 60}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 60}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 60.0}
âš ï¸ Player model_b offer violates constraints: GPU=40, CPU=60
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=98.93, marketing=118.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=390.00 - BATNA=291.07 = surplus=98.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=380.00 - BATNA=261.96 = surplus=118.04
âœ… Calculated utility_surplus: {'model_a': 98.9325, 'model_b': 118.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 390, 'model_b': 380}
Metrics: {'utility_surplus': {'model_a': 98.9325, 'model_b': 118.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 250 completed successfully
Sun Nov 16 05:57:12 PM CET 2025: Completed iteration 250

=== Iteration 251/300 ===
Sun Nov 16 05:57:12 PM CET 2025: Starting resource allocation negotiation iteration 251
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.06s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.40s (total since entry 16.48s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.40s (total since entry 7.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=20, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 33.0, 'cpu_hours': 23.0}
ğŸ’¡ Player model_a made offer GPU=20, CPU=30 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=33, CPU=23 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=20, CPU=30 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=20, CPU=30
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=340.00, marketing=360.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=48.93, marketing=98.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=360.00 - BATNA=261.96 = surplus=98.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=340.00 - BATNA=291.07 = surplus=48.93
âœ… Calculated utility_surplus: {'model_a': 98.03924999999998, 'model_b': 48.932500000000005}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 340, 'model_a': 360}
Metrics: {'utility_surplus': {'model_a': 98.03924999999998, 'model_b': 48.932500000000005}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 251 completed successfully
Sun Nov 16 05:58:01 PM CET 2025: Completed iteration 251

=== Iteration 252/300 ===
Sun Nov 16 05:58:01 PM CET 2025: Starting resource allocation negotiation iteration 252
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.10s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.36s (total since entry 16.48s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.79s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.43s (total since entry 7.21s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
7, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 35}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 35}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 35.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=35 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=60, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=45, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.5}
ğŸ’¡ Player model_a made offer GPU=70, CPU=15 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=22.5 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 28.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=70, CPU=15 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=70, CPU=15
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=650.00, marketing=540.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=358.93, marketing=278.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=650.00 - BATNA=291.07 = surplus=358.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=540.00 - BATNA=261.96 = surplus=278.04
âœ… Calculated utility_surplus: {'model_a': 358.9325, 'model_b': 278.03925}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 650, 'model_b': 540}
Metrics: {'utility_surplus': {'model_a': 358.9325, 'model_b': 278.03925}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 252 completed successfully
Sun Nov 16 05:58:52 PM CET 2025: Completed iteration 252

=== Iteration 253/300 ===
Sun Nov 16 05:58:52 PM CET 2025: Starting resource allocation negotiation iteration 253
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.35s (total since entry 16.39s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
13, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.46s (total since entry 7.22s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=30 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 23.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=30 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=23 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=30 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=30, CPU=30
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=420.00, marketing=420.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=128.93, marketing=158.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=420.00 - BATNA=261.96 = surplus=158.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=420.00 - BATNA=291.07 = surplus=128.93
âœ… Calculated utility_surplus: {'model_a': 158.03924999999998, 'model_b': 128.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 420, 'model_a': 420}
Metrics: {'utility_surplus': {'model_a': 158.03924999999998, 'model_b': 128.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 253 completed successfully
Sun Nov 16 05:59:40 PM CET 2025: Completed iteration 253

=== Iteration 254/300 ===
Sun Nov 16 05:59:40 PM CET 2025: Starting resource allocation negotiation iteration 254
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.48s (total since entry 16.46s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
21, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.40s (total since entry 7.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=70, CPU=10 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=20, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_a made offer GPU=45, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 30.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=45, CPU=20 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=45, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=480.00, marketing=430.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=193.30, marketing=171.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=480.00 - BATNA=286.70 = surplus=193.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=430.00 - BATNA=258.03 = surplus=171.97
âœ… Calculated utility_surplus: {'model_a': 193.29851250000002, 'model_b': 171.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 480, 'model_b': 430}
Metrics: {'utility_surplus': {'model_a': 193.29851250000002, 'model_b': 171.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 254 completed successfully
Sun Nov 16 06:00:24 PM CET 2025: Completed iteration 254

=== Iteration 255/300 ===
Sun Nov 16 06:00:24 PM CET 2025: Starting resource allocation negotiation iteration 255
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.41s (total since entry 16.44s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.40s (total since entry 7.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=30 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 27.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=27 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=27 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=27
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=402.00, marketing=396.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=115.30, marketing=137.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=396.00 - BATNA=258.03 = surplus=137.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=402.00 - BATNA=286.70 = surplus=115.30
âœ… Calculated utility_surplus: {'model_a': 137.96866125000003, 'model_b': 115.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 402, 'model_a': 396}
Metrics: {'utility_surplus': {'model_a': 137.96866125000003, 'model_b': 115.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 255 completed successfully
Sun Nov 16 06:01:06 PM CET 2025: Completed iteration 255

=== Iteration 256/300 ===
Sun Nov 16 06:01:06 PM CET 2025: Starting resource allocation negotiation iteration 256
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.39s (total since entry 16.43s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.77s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.44s (total since entry 7.21s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.5}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22.5 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=40, CPU=15 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=40, CPU=15
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=410.00, marketing=360.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=118.93, marketing=98.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=360.00 - BATNA=261.96 = surplus=98.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=410.00 - BATNA=291.07 = surplus=118.93
âœ… Calculated utility_surplus: {'model_a': 98.03924999999998, 'model_b': 118.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 410, 'model_a': 360}
Metrics: {'utility_surplus': {'model_a': 98.03924999999998, 'model_b': 118.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 256 completed successfully
Sun Nov 16 06:01:48 PM CET 2025: Completed iteration 256

=== Iteration 257/300 ===
Sun Nov 16 06:01:48 PM CET 2025: Starting resource allocation negotiation iteration 257
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.38s (total since entry 16.36s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.40s (total since entry 7.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
13, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 25.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=25, CPU=30 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 28, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 28, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 28.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=28, CPU=30 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=28, CPU=30 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=28, CPU=30
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=404.00, marketing=408.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=112.93, marketing=146.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=408.00 - BATNA=261.96 = surplus=146.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=404.00 - BATNA=291.07 = surplus=112.93
âœ… Calculated utility_surplus: {'model_a': 146.03924999999998, 'model_b': 112.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 404, 'model_a': 408}
Metrics: {'utility_surplus': {'model_a': 146.03924999999998, 'model_b': 112.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 257 completed successfully
Sun Nov 16 06:02:31 PM CET 2025: Completed iteration 257

=== Iteration 258/300 ===
Sun Nov 16 06:02:31 PM CET 2025: Starting resource allocation negotiation iteration 258
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.47s (total since entry 16.52s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.91s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.47s (total since entry 7.38s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=20, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=20, CPU=30 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=25 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=103.30, marketing=121.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=258.03 = surplus=121.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=286.70 = surplus=103.30
âœ… Calculated utility_surplus: {'model_a': 121.96866125000003, 'model_b': 103.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 121.96866125000003, 'model_b': 103.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 258 completed successfully
Sun Nov 16 06:03:13 PM CET 2025: Completed iteration 258

=== Iteration 259/300 ===
Sun Nov 16 06:03:13 PM CET 2025: Starting resource allocation negotiation iteration 259
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.06s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.67s (total since entry 16.75s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
13, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.37s (total since entry 7.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=70, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 55, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 55, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 55, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 55, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 55, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 55.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=50, CPU=10 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=55, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.5}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=22.5 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 28.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=45, CPU=28 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=103.30, marketing=121.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=390.00 - BATNA=286.70 = surplus=103.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=380.00 - BATNA=258.03 = surplus=121.97
âœ… Calculated utility_surplus: {'model_a': 103.29851250000002, 'model_b': 121.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 390, 'model_b': 380}
Metrics: {'utility_surplus': {'model_a': 103.29851250000002, 'model_b': 121.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 259 completed successfully
Sun Nov 16 06:04:07 PM CET 2025: Completed iteration 259

=== Iteration 260/300 ===
Sun Nov 16 06:04:07 PM CET 2025: Starting resource allocation negotiation iteration 260
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.05s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.55s (total since entry 16.62s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.78s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.57s (total since entry 7.35s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=30 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_a made offer GPU=45, CPU=30 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=45, CPU=28 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=45, CPU=30 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=45, CPU=30
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=540.00, marketing=510.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=253.30, marketing=251.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=510.00 - BATNA=258.03 = surplus=251.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=540.00 - BATNA=286.70 = surplus=253.30
âœ… Calculated utility_surplus: {'model_a': 251.96866125000003, 'model_b': 253.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 540, 'model_a': 510}
Metrics: {'utility_surplus': {'model_a': 251.96866125000003, 'model_b': 253.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 260 completed successfully
Sun Nov 16 06:04:47 PM CET 2025: Completed iteration 260

=== Iteration 261/300 ===
Sun Nov 16 06:04:47 PM CET 2025: Starting resource allocation negotiation iteration 261
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.05s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.47s (total since entry 16.53s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.79s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.45s (total since entry 7.24s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
14, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.5}
ğŸ’¡ Player model_a made offer GPU=30, CPU=30 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=22.5 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=30 (made in round 2)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=30, CPU=30
ğŸ” [BATNA DEBUG] Using BATNA from offer round 2 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=295.50, marketing=265.95
ğŸ” [UTILITY DEBUG] Utilities: development=420.00, marketing=420.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=124.50, marketing=154.05
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=420.00 - BATNA=265.95 = surplus=154.05
ğŸ’° [UTILITY SURPLUS] model_b: utility=420.00 - BATNA=295.50 = surplus=124.50
âœ… Calculated utility_surplus: {'model_a': 154.05, 'model_b': 124.5}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 420, 'model_a': 420}
Metrics: {'utility_surplus': {'model_a': 154.05, 'model_b': 124.5}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 261 completed successfully
Sun Nov 16 06:05:29 PM CET 2025: Completed iteration 261

=== Iteration 262/300 ===
Sun Nov 16 06:05:29 PM CET 2025: Starting resource allocation negotiation iteration 262
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.11s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.46s (total since entry 16.59s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
13, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.42s (total since entry 7.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
8, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=20, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 37, "cpu_hours": 22}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 37, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 37, 'cpu_hours': 22}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 37.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 31, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 31, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 31.0, 'cpu_hours': 24.0}
ğŸ’¡ Player model_a made offer GPU=37, CPU=22 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=31, CPU=24 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 27}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 27}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 33.0, 'cpu_hours': 27.0}
ğŸ’¡ Player model_b made offer GPU=33, CPU=27 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=37, CPU=22 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=37, CPU=22
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=428.00, marketing=398.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=136.93, marketing=136.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=428.00 - BATNA=291.07 = surplus=136.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=398.00 - BATNA=261.96 = surplus=136.04
âœ… Calculated utility_surplus: {'model_a': 136.9325, 'model_b': 136.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 428, 'model_b': 398}
Metrics: {'utility_surplus': {'model_a': 136.9325, 'model_b': 136.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 262 completed successfully
Sun Nov 16 06:06:20 PM CET 2025: Completed iteration 262

=== Iteration 263/300 ===
Sun Nov 16 06:06:20 PM CET 2025: Starting resource allocation negotiation iteration 263
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.00s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.44s (total since entry 16.46s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.52s (total since entry 7.26s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.5}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22.5 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 27}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 27}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 27.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=32, CPU=27 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 34, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 34, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 34.0, 'cpu_hours': 23.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=34, CPU=23 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=103.30, marketing=121.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=390.00 - BATNA=286.70 = surplus=103.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=380.00 - BATNA=258.03 = surplus=121.97
âœ… Calculated utility_surplus: {'model_a': 103.29851250000002, 'model_b': 121.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 390, 'model_b': 380}
Metrics: {'utility_surplus': {'model_a': 103.29851250000002, 'model_b': 121.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 263 completed successfully
Sun Nov 16 06:07:07 PM CET 2025: Completed iteration 263

=== Iteration 264/300 ===
Sun Nov 16 06:07:07 PM CET 2025: Starting resource allocation negotiation iteration 264
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.40s (total since entry 16.42s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.40s (total since entry 7.14s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=20, CPU=15 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=40, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=20 (made in round 2)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 2 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=295.50, marketing=265.95
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=104.50, marketing=104.05
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=295.50 = surplus=104.50
ğŸ’° [UTILITY SURPLUS] model_b: utility=370.00 - BATNA=265.95 = surplus=104.05
âœ… Calculated utility_surplus: {'model_a': 104.5, 'model_b': 104.05000000000001}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 400, 'model_b': 370}
Metrics: {'utility_surplus': {'model_a': 104.5, 'model_b': 104.05000000000001}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 264 completed successfully
Sun Nov 16 06:08:00 PM CET 2025: Completed iteration 264

=== Iteration 265/300 ===
Sun Nov 16 06:08:00 PM CET 2025: Starting resource allocation negotiation iteration 265
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.06s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.41s (total since entry 16.48s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
18, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.41s (total since entry 7.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
14, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=70, CPU=15 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_a made offer GPU=60, CPU=10 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=22 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=50, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=70, CPU=10 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=50, CPU=20 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=50, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=520.00, marketing=460.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=228.93, marketing=198.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=520.00 - BATNA=291.07 = surplus=228.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=460.00 - BATNA=261.96 = surplus=198.04
âœ… Calculated utility_surplus: {'model_a': 228.9325, 'model_b': 198.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 520, 'model_b': 460}
Metrics: {'utility_surplus': {'model_a': 228.9325, 'model_b': 198.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 265 completed successfully
Sun Nov 16 06:08:42 PM CET 2025: Completed iteration 265

=== Iteration 266/300 ===
Sun Nov 16 06:08:42 PM CET 2025: Starting resource allocation negotiation iteration 266
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.40s (total since entry 16.43s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
18, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.40s (total since entry 7.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
14, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 40.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=20, CPU=40 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=70, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=30 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=60, CPU=10 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=60, CPU=10 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=60, CPU=10
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=540.00, marketing=440.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=253.30, marketing=181.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=540.00 - BATNA=286.70 = surplus=253.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=440.00 - BATNA=258.03 = surplus=181.97
âœ… Calculated utility_surplus: {'model_a': 253.29851250000002, 'model_b': 181.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 540, 'model_b': 440}
Metrics: {'utility_surplus': {'model_a': 253.29851250000002, 'model_b': 181.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 266 completed successfully
Sun Nov 16 06:09:36 PM CET 2025: Completed iteration 266

=== Iteration 267/300 ===
Sun Nov 16 06:09:36 PM CET 2025: Starting resource allocation negotiation iteration 267
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.45s (total since entry 16.48s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.41s (total since entry 7.14s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=45, CPU=15 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 25}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 25}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=45, CPU=15 (made in round 2)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=45, CPU=15
ğŸ” [BATNA DEBUG] Using BATNA from offer round 2 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=295.50, marketing=265.95
ğŸ” [UTILITY DEBUG] Utilities: development=450.00, marketing=390.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=154.50, marketing=124.05
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=450.00 - BATNA=295.50 = surplus=154.50
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=265.95 = surplus=124.05
âœ… Calculated utility_surplus: {'model_a': 154.5, 'model_b': 124.05000000000001}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 450, 'model_b': 390}
Metrics: {'utility_surplus': {'model_a': 154.5, 'model_b': 124.05000000000001}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 267 completed successfully
Sun Nov 16 06:10:24 PM CET 2025: Completed iteration 267

=== Iteration 268/300 ===
Sun Nov 16 06:10:24 PM CET 2025: Starting resource allocation negotiation iteration 268
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.42s (total since entry 16.46s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.39s (total since entry 7.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 60}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 60}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 60}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 60}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 60}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 60.0}
âš ï¸ Player model_b offer violates constraints: GPU=40, CPU=60
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 34, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 34, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 34, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 34.0, 'cpu_hours': 23.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=20 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=113.30, marketing=111.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=286.70 = surplus=113.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=370.00 - BATNA=258.03 = surplus=111.97
âœ… Calculated utility_surplus: {'model_a': 113.29851250000002, 'model_b': 111.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 400, 'model_b': 370}
Metrics: {'utility_surplus': {'model_a': 113.29851250000002, 'model_b': 111.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 268 completed successfully
Sun Nov 16 06:11:16 PM CET 2025: Completed iteration 268

=== Iteration 269/300 ===
Sun Nov 16 06:11:16 PM CET 2025: Starting resource allocation negotiation iteration 269
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.45s (total since entry 16.48s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.38s (total since entry 7.14s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 25}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 25}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=25 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 75}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 75}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 75}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 75}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 75}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 75.0}
âš ï¸ Player model_a offer violates constraints: GPU=30, CPU=75
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered GPU=35, CPU=20 - Creating automatic agreement!
ğŸ” [RESOURCE DEBUG] Agreement in round 3: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from round 3
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=108.93, marketing=108.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=370.00 - BATNA=261.96 = surplus=108.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=291.07 = surplus=108.93
âœ… Calculated utility_surplus: {'model_a': 108.03924999999998, 'model_b': 108.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 400, 'model_a': 370}
Metrics: {'utility_surplus': {'model_a': 108.03924999999998, 'model_b': 108.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 269 completed successfully
Sun Nov 16 06:11:55 PM CET 2025: Completed iteration 269

=== Iteration 270/300 ===
Sun Nov 16 06:11:55 PM CET 2025: Starting resource allocation negotiation iteration 270
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.04s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.43s (total since entry 16.49s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.77s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.43s (total since entry 7.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=45, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=30 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=20 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=108.93, marketing=108.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=291.07 = surplus=108.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=370.00 - BATNA=261.96 = surplus=108.04
âœ… Calculated utility_surplus: {'model_a': 108.9325, 'model_b': 108.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 400, 'model_b': 370}
Metrics: {'utility_surplus': {'model_a': 108.9325, 'model_b': 108.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 270 completed successfully
Sun Nov 16 06:12:44 PM CET 2025: Completed iteration 270

=== Iteration 271/300 ===
Sun Nov 16 06:12:44 PM CET 2025: Starting resource allocation negotiation iteration 271
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.40s (total since entry 16.45s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.78s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.40s (total since entry 7.18s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=30 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=40, CPU=20 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=40, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=440.00, marketing=400.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=148.93, marketing=138.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=261.96 = surplus=138.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=440.00 - BATNA=291.07 = surplus=148.93
âœ… Calculated utility_surplus: {'model_a': 138.03924999999998, 'model_b': 148.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 440, 'model_a': 400}
Metrics: {'utility_surplus': {'model_a': 138.03924999999998, 'model_b': 148.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 271 completed successfully
Sun Nov 16 06:13:23 PM CET 2025: Completed iteration 271

=== Iteration 272/300 ===
Sun Nov 16 06:13:23 PM CET 2025: Starting resource allocation negotiation iteration 272
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.44s (total since entry 16.49s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.41s (total since entry 7.14s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=70, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=30 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=50, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 35}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 35}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 35}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 35}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 35}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 35.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 15.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 15.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer GPU=70, CPU=10 (proposal 2/4)
â° Maximum rounds (5) reached - Ending negotiation
ğŸ² [ROLE DEBUG] No Agreement - Development=model_a, Marketing=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 272 completed successfully
Sun Nov 16 06:14:12 PM CET 2025: Completed iteration 272

=== Iteration 273/300 ===
Sun Nov 16 06:14:12 PM CET 2025: Starting resource allocation negotiation iteration 273
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.43s (total since entry 16.47s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.76s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.41s (total since entry 7.17s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=45, CPU=10 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=40, CPU=15 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered GPU=40, CPU=15 - Creating automatic agreement!
ğŸ” [RESOURCE DEBUG] Agreement in round 3: GPU=40, CPU=15
ğŸ” [BATNA DEBUG] Using BATNA from round 3
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=410.00, marketing=360.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=118.93, marketing=98.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=410.00 - BATNA=291.07 = surplus=118.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=360.00 - BATNA=261.96 = surplus=98.04
âœ… Calculated utility_surplus: {'model_a': 118.9325, 'model_b': 98.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 410, 'model_b': 360}
Metrics: {'utility_surplus': {'model_a': 118.9325, 'model_b': 98.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 273 completed successfully
Sun Nov 16 06:14:49 PM CET 2025: Completed iteration 273

=== Iteration 274/300 ===
Sun Nov 16 06:14:49 PM CET 2025: Starting resource allocation negotiation iteration 274
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.43s (total since entry 16.47s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.38s (total since entry 7.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 33, "cpu_hours": 27}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 33, 'cpu_hours': 27}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 33.0, 'cpu_hours': 27.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 27}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 27}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 27.0}
ğŸ’¡ Player model_b made offer GPU=33, CPU=27 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=27 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=27 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=35, CPU=27
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=442.00, marketing=426.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=150.93, marketing=164.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=442.00 - BATNA=291.07 = surplus=150.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=426.00 - BATNA=261.96 = surplus=164.04
âœ… Calculated utility_surplus: {'model_a': 150.9325, 'model_b': 164.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 442, 'model_b': 426}
Metrics: {'utility_surplus': {'model_a': 150.9325, 'model_b': 164.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 274 completed successfully
Sun Nov 16 06:15:37 PM CET 2025: Completed iteration 274

=== Iteration 275/300 ===
Sun Nov 16 06:15:37 PM CET 2025: Starting resource allocation negotiation iteration 275
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.06s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.51s (total since entry 16.59s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
9, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.55s (total since entry 7.28s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=20, CPU=15 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=30 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=40, CPU=15 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=40, CPU=15
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=410.00, marketing=360.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=118.93, marketing=98.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=360.00 - BATNA=261.96 = surplus=98.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=410.00 - BATNA=291.07 = surplus=118.93
âœ… Calculated utility_surplus: {'model_a': 98.03924999999998, 'model_b': 118.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 410, 'model_a': 360}
Metrics: {'utility_surplus': {'model_a': 98.03924999999998, 'model_b': 118.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 275 completed successfully
Sun Nov 16 06:16:28 PM CET 2025: Completed iteration 275

=== Iteration 276/300 ===
Sun Nov 16 06:16:28 PM CET 2025: Starting resource allocation negotiation iteration 276
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.06s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.68s (total since entry 16.76s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.45s (total since entry 7.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
5, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_b made offer GPU=45, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=20, CPU=30 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=50, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=103.30, marketing=121.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=258.03 = surplus=121.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=286.70 = surplus=103.30
âœ… Calculated utility_surplus: {'model_a': 121.96866125000003, 'model_b': 103.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 121.96866125000003, 'model_b': 103.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 276 completed successfully
Sun Nov 16 06:17:15 PM CET 2025: Completed iteration 276

=== Iteration 277/300 ===
Sun Nov 16 06:17:15 PM CET 2025: Starting resource allocation negotiation iteration 277
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.98s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.48s (total since entry 16.48s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.39s (total since entry 7.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=45, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=40, CPU=15 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=40, CPU=15
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=410.00, marketing=360.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=123.30, marketing=101.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=410.00 - BATNA=286.70 = surplus=123.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=360.00 - BATNA=258.03 = surplus=101.97
âœ… Calculated utility_surplus: {'model_a': 123.29851250000002, 'model_b': 101.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 410, 'model_b': 360}
Metrics: {'utility_surplus': {'model_a': 123.29851250000002, 'model_b': 101.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 277 completed successfully
Sun Nov 16 06:18:03 PM CET 2025: Completed iteration 277

=== Iteration 278/300 ===
Sun Nov 16 06:18:03 PM CET 2025: Starting resource allocation negotiation iteration 278
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.45s (total since entry 16.49s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.76s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.43s (total since entry 7.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
7, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.5}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22.5 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=45, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=40, CPU=20 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=40, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=440.00, marketing=400.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=148.93, marketing=138.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=440.00 - BATNA=291.07 = surplus=148.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=261.96 = surplus=138.04
âœ… Calculated utility_surplus: {'model_a': 148.9325, 'model_b': 138.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 440, 'model_b': 400}
Metrics: {'utility_surplus': {'model_a': 148.9325, 'model_b': 138.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 278 completed successfully
Sun Nov 16 06:18:45 PM CET 2025: Completed iteration 278

=== Iteration 279/300 ===
Sun Nov 16 06:18:45 PM CET 2025: Starting resource allocation negotiation iteration 279
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.68s (total since entry 16.73s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
7, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.77s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.42s (total since entry 7.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
11, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 23.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=32, CPU=23 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 27}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 28, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 28, 'cpu_hours': 27}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 28.0, 'cpu_hours': 27.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=28, CPU=27 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=30, CPU=25 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=30, CPU=25 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=103.30, marketing=121.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=390.00 - BATNA=286.70 = surplus=103.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=380.00 - BATNA=258.03 = surplus=121.97
âœ… Calculated utility_surplus: {'model_a': 103.29851250000002, 'model_b': 121.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 390, 'model_b': 380}
Metrics: {'utility_surplus': {'model_a': 103.29851250000002, 'model_b': 121.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 279 completed successfully
Sun Nov 16 06:19:31 PM CET 2025: Completed iteration 279

=== Iteration 280/300 ===
Sun Nov 16 06:19:31 PM CET 2025: Starting resource allocation negotiation iteration 280
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.00s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.50s (total since entry 16.52s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
13, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.44s (total since entry 7.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
15, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.5}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=22.5 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 27.5}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 27.5}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 27.5}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 27.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 27.5}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 27.5}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=27.5 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 38, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 38, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 38, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 38, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 38, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 38.0, 'cpu_hours': 24.0}
ğŸ’¡ Player model_b made offer GPU=38, CPU=24 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=27.5 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=35, CPU=27.5
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=445.00, marketing=430.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=153.93, marketing=168.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=430.00 - BATNA=261.96 = surplus=168.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=445.00 - BATNA=291.07 = surplus=153.93
âœ… Calculated utility_surplus: {'model_a': 168.03924999999998, 'model_b': 153.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 445.0, 'model_a': 430.0}
Metrics: {'utility_surplus': {'model_a': 168.03924999999998, 'model_b': 153.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 280 completed successfully
Sun Nov 16 06:20:24 PM CET 2025: Completed iteration 280

=== Iteration 281/300 ===
Sun Nov 16 06:20:24 PM CET 2025: Starting resource allocation negotiation iteration 281
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.04s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.49s (total since entry 16.54s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.39s (total since entry 7.14s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=28 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 29, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 29, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 29, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 29, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 29, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 29.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=29, CPU=30 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 36, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 36, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 36, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 36, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 36, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 36.0, 'cpu_hours': 23.0}
ğŸ’¡ Player model_b made offer GPU=36, CPU=23 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 38, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 38, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 38, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 38, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 38, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 38.0, 'cpu_hours': 24.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=29, CPU=30 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=29, CPU=30
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=412.00, marketing=414.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=120.93, marketing=152.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=414.00 - BATNA=261.96 = surplus=152.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=412.00 - BATNA=291.07 = surplus=120.93
âœ… Calculated utility_surplus: {'model_a': 152.03924999999998, 'model_b': 120.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 412, 'model_a': 414}
Metrics: {'utility_surplus': {'model_a': 152.03924999999998, 'model_b': 120.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 281 completed successfully
Sun Nov 16 06:21:16 PM CET 2025: Completed iteration 281

=== Iteration 282/300 ===
Sun Nov 16 06:21:16 PM CET 2025: Starting resource allocation negotiation iteration 282
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.45s (total since entry 16.50s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.40s (total since entry 7.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.5}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22.5 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=45, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 25}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 25}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=45, CPU=20 (made in round 2)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=45, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 2 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=295.50, marketing=265.95
ğŸ” [UTILITY DEBUG] Utilities: development=480.00, marketing=430.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=184.50, marketing=164.05
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=480.00 - BATNA=295.50 = surplus=184.50
ğŸ’° [UTILITY SURPLUS] model_b: utility=430.00 - BATNA=265.95 = surplus=164.05
âœ… Calculated utility_surplus: {'model_a': 184.5, 'model_b': 164.05}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 480, 'model_b': 430}
Metrics: {'utility_surplus': {'model_a': 184.5, 'model_b': 164.05}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 282 completed successfully
Sun Nov 16 06:21:59 PM CET 2025: Completed iteration 282

=== Iteration 283/300 ===
Sun Nov 16 06:21:59 PM CET 2025: Starting resource allocation negotiation iteration 283
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.44s (total since entry 16.48s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.39s (total since entry 7.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 75, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 75, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 75.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=75, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=60, CPU=20 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=60, CPU=20 (made in round 2)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=60, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 2 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=295.50, marketing=265.95
ğŸ” [UTILITY DEBUG] Utilities: development=600.00, marketing=520.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=304.50, marketing=254.05
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=600.00 - BATNA=295.50 = surplus=304.50
ğŸ’° [UTILITY SURPLUS] model_b: utility=520.00 - BATNA=265.95 = surplus=254.05
âœ… Calculated utility_surplus: {'model_a': 304.5, 'model_b': 254.05}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 600, 'model_b': 520}
Metrics: {'utility_surplus': {'model_a': 304.5, 'model_b': 254.05}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 283 completed successfully
Sun Nov 16 06:22:48 PM CET 2025: Completed iteration 283

=== Iteration 284/300 ===
Sun Nov 16 06:22:48 PM CET 2025: Starting resource allocation negotiation iteration 284
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.06s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.44s (total since entry 16.52s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.44s (total since entry 7.18s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 40.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=20, CPU=40 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.5}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22.5 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.5}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 23.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=22.5 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=32, CPU=23 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 26}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 26}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 28, "cpu_hours": 26}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 28, 'cpu_hours': 26}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 28, 'cpu_hours': 26}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 28.0, 'cpu_hours': 26.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=32, CPU=23 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=32, CPU=23
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=394.00, marketing=376.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=102.93, marketing=114.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=394.00 - BATNA=291.07 = surplus=102.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=376.00 - BATNA=261.96 = surplus=114.04
âœ… Calculated utility_surplus: {'model_a': 102.9325, 'model_b': 114.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 394, 'model_b': 376}
Metrics: {'utility_surplus': {'model_a': 102.9325, 'model_b': 114.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 284 completed successfully
Sun Nov 16 06:23:34 PM CET 2025: Completed iteration 284

=== Iteration 285/300 ===
Sun Nov 16 06:23:34 PM CET 2025: Starting resource allocation negotiation iteration 285
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.48s (total since entry 16.51s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
6, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.80s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.43s (total since entry 7.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.5}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22.5 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 27.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=27 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 36, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 36, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 36, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 36, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 36, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 36.0, 'cpu_hours': 24.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 36, "cpu_hours": 24}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 36, "cpu_hours": 24}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 36, "cpu_hours": 24}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 36, 'cpu_hours': 24}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 36, 'cpu_hours': 24}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 36.0, 'cpu_hours': 24.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=27 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=27
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=402.00, marketing=396.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=110.93, marketing=134.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=396.00 - BATNA=261.96 = surplus=134.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=402.00 - BATNA=291.07 = surplus=110.93
âœ… Calculated utility_surplus: {'model_a': 134.03924999999998, 'model_b': 110.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 402, 'model_a': 396}
Metrics: {'utility_surplus': {'model_a': 134.03924999999998, 'model_b': 110.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 285 completed successfully
Sun Nov 16 06:24:32 PM CET 2025: Completed iteration 285

=== Iteration 286/300 ===
Sun Nov 16 06:24:32 PM CET 2025: Starting resource allocation negotiation iteration 286
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.04s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.46s (total since entry 16.52s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.79s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 7.65s (total since entry 8.44s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 40.0}
ğŸ’¡ Player model_a made offer GPU=70, CPU=10 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=20, CPU=40 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=40, CPU=10 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=40, CPU=10 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=40, CPU=10
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=380.00, marketing=320.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=93.30, marketing=61.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=286.70 = surplus=93.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=320.00 - BATNA=258.03 = surplus=61.97
âœ… Calculated utility_surplus: {'model_a': 93.29851250000002, 'model_b': 61.968661250000025}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 380, 'model_b': 320}
Metrics: {'utility_surplus': {'model_a': 93.29851250000002, 'model_b': 61.968661250000025}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 286 completed successfully
Sun Nov 16 06:25:26 PM CET 2025: Completed iteration 286

=== Iteration 287/300 ===
Sun Nov 16 06:25:26 PM CET 2025: Starting resource allocation negotiation iteration 287
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.07s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.53s (total since entry 16.62s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.91s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.39s (total since entry 7.30s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
9, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=70, CPU=10 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.5}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22.5 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=60, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 27.5}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 27.5}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 27.5}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 27.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 27.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 27.5}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=27.5 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "gpu_hours": 35,\n  "cpu_hours": 22.5\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "gpu_hours": 35,\n  "cpu_hours": 22.5\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "gpu_hours": 35,\n  "cpu_hours": 22.5\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.5}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22.5 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=60, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=60, CPU=20 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=60, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=600.00, marketing=520.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=313.30, marketing=261.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=600.00 - BATNA=286.70 = surplus=313.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=520.00 - BATNA=258.03 = surplus=261.97
âœ… Calculated utility_surplus: {'model_a': 313.2985125, 'model_b': 261.96866125}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 600, 'model_b': 520}
Metrics: {'utility_surplus': {'model_a': 313.2985125, 'model_b': 261.96866125}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 287 completed successfully
Sun Nov 16 06:26:10 PM CET 2025: Completed iteration 287

=== Iteration 288/300 ===
Sun Nov 16 06:26:10 PM CET 2025: Starting resource allocation negotiation iteration 288
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.42s (total since entry 16.45s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.40s (total since entry 7.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 5, "cpu_hours": 95}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 5, "cpu_hours": 95}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 5, "cpu_hours": 95}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 5, 'cpu_hours': 95}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 5, 'cpu_hours': 95}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 5.0, 'cpu_hours': 95.0}
âš ï¸ Player model_a offer violates constraints: GPU=5, CPU=95
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 27.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=27 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=27 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=27
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=402.00, marketing=396.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=115.30, marketing=137.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=396.00 - BATNA=258.03 = surplus=137.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=402.00 - BATNA=286.70 = surplus=115.30
âœ… Calculated utility_surplus: {'model_a': 137.96866125000003, 'model_b': 115.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 402, 'model_a': 396}
Metrics: {'utility_surplus': {'model_a': 137.96866125000003, 'model_b': 115.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 288 completed successfully
Sun Nov 16 06:26:59 PM CET 2025: Completed iteration 288

=== Iteration 289/300 ===
Sun Nov 16 06:26:59 PM CET 2025: Starting resource allocation negotiation iteration 289
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.49s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.48s (total since entry 16.99s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
11, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.38s (total since entry 7.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 23}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 23}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 23.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 27}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 27}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 27.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=23 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=27 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=27 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=30, CPU=27
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=402.00, marketing=396.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=110.93, marketing=134.04
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=396.00 - BATNA=261.96 = surplus=134.04
ğŸ’° [UTILITY SURPLUS] model_b: utility=402.00 - BATNA=291.07 = surplus=110.93
âœ… Calculated utility_surplus: {'model_a': 134.03924999999998, 'model_b': 110.9325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 402, 'model_a': 396}
Metrics: {'utility_surplus': {'model_a': 134.03924999999998, 'model_b': 110.9325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 289 completed successfully
Sun Nov 16 06:27:47 PM CET 2025: Completed iteration 289

=== Iteration 290/300 ===
Sun Nov 16 06:27:47 PM CET 2025: Starting resource allocation negotiation iteration 290
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.66s (total since entry 16.70s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.40s (total since entry 7.14s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
15, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=70, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "gpu_hours": 50,\n  "cpu_hours": 15\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "gpu_hours": 50,\n  "cpu_hours": 15\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "gpu_hours": 50,\n  "cpu_hours": 15\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=50, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 5}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 5}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 5}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 75, 'cpu_hours': 5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 75, 'cpu_hours': 5}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 75.0, 'cpu_hours': 5.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=75, CPU=5 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=50, CPU=15 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
â° Maximum rounds (5) reached - Ending negotiation
ğŸ² [ROLE DEBUG] No Agreement - Development=model_a, Marketing=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 290 completed successfully
Sun Nov 16 06:28:41 PM CET 2025: Completed iteration 290

=== Iteration 291/300 ===
Sun Nov 16 06:28:41 PM CET 2025: Starting resource allocation negotiation iteration 291
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.44s (total since entry 16.47s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
12, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.76s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.42s (total since entry 7.18s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
13, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=40, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_b made offer GPU=32, CPU=22 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=30, CPU=25 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=45, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=45, CPU=15 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=45, CPU=15
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=450.00, marketing=390.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=163.30, marketing=131.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=450.00 - BATNA=286.70 = surplus=163.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=258.03 = surplus=131.97
âœ… Calculated utility_surplus: {'model_a': 163.29851250000002, 'model_b': 131.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 450, 'model_b': 390}
Metrics: {'utility_surplus': {'model_a': 163.29851250000002, 'model_b': 131.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 291 completed successfully
Sun Nov 16 06:29:26 PM CET 2025: Completed iteration 291

=== Iteration 292/300 ===
Sun Nov 16 06:29:26 PM CET 2025: Starting resource allocation negotiation iteration 292
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.16s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.47s (total since entry 16.65s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
20, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.77s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.49s (total since entry 7.26s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=50, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 40}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 40}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 40.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=20, CPU=40 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=50, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "gpu_hours": 60,\n    "cpu_hours": 10\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "gpu_hours": 60,\n    "cpu_hours": 10\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "gpu_hours": 60,\n    "cpu_hours": 10\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 10.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=20, CPU=40 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=20, CPU=40
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=440.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=113.30, marketing=181.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=440.00 - BATNA=258.03 = surplus=181.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=400.00 - BATNA=286.70 = surplus=113.30
âœ… Calculated utility_surplus: {'model_a': 181.96866125000003, 'model_b': 113.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 400, 'model_a': 440}
Metrics: {'utility_surplus': {'model_a': 181.96866125000003, 'model_b': 113.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 292 completed successfully
Sun Nov 16 06:30:18 PM CET 2025: Completed iteration 292

=== Iteration 293/300 ===
Sun Nov 16 06:30:18 PM CET 2025: Starting resource allocation negotiation iteration 293
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.00s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.43s (total since entry 16.45s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.76s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.45s (total since entry 7.21s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
9, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 25.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 30.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=25 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=20, CPU=30 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "gpu_hours": 45,\n    "cpu_hours": 10\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "gpu_hours": 45,\n    "cpu_hours": 10\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "gpu_hours": 45,\n    "cpu_hours": 10\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=45, CPU=10 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "accept"\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "accept"\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "accept"\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=20, CPU=30 (made in round 2)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=20, CPU=30
ğŸ” [BATNA DEBUG] Using BATNA from offer round 2 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=295.50, marketing=265.95
ğŸ” [UTILITY DEBUG] Utilities: development=340.00, marketing=360.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=44.50, marketing=94.05
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=360.00 - BATNA=265.95 = surplus=94.05
ğŸ’° [UTILITY SURPLUS] model_b: utility=340.00 - BATNA=295.50 = surplus=44.50
âœ… Calculated utility_surplus: {'model_a': 94.05000000000001, 'model_b': 44.5}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 340, 'model_a': 360}
Metrics: {'utility_surplus': {'model_a': 94.05000000000001, 'model_b': 44.5}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 293 completed successfully
Sun Nov 16 06:31:03 PM CET 2025: Completed iteration 293

=== Iteration 294/300 ===
Sun Nov 16 06:31:03 PM CET 2025: Starting resource allocation negotiation iteration 294
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.45s (total since entry 16.50s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.77s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.40s (total since entry 7.17s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 25, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 25, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 25.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_a made offer GPU=25, CPU=30 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=25 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.0}
ğŸ’¡ Player model_a made offer GPU=30, CPU=30 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=35, CPU=22 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=30 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=30
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=420.00, marketing=420.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=133.30, marketing=161.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=420.00 - BATNA=258.03 = surplus=161.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=420.00 - BATNA=286.70 = surplus=133.30
âœ… Calculated utility_surplus: {'model_a': 161.96866125000003, 'model_b': 133.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 420, 'model_a': 420}
Metrics: {'utility_surplus': {'model_a': 161.96866125000003, 'model_b': 133.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 294 completed successfully
Sun Nov 16 06:31:52 PM CET 2025: Completed iteration 294

=== Iteration 295/300 ===
Sun Nov 16 06:31:52 PM CET 2025: Starting resource allocation negotiation iteration 295
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.22s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.41s (total since entry 16.65s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
16, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.78s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.42s (total since entry 7.21s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=20, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=10 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 38, "cpu_hours": 12}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 38, "cpu_hours": 12}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 38, "cpu_hours": 12}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 38, 'cpu_hours': 12}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 38, 'cpu_hours': 12}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 38.0, 'cpu_hours': 12.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=38, CPU=12 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=20 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=108.93, marketing=108.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=291.07 = surplus=108.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=370.00 - BATNA=261.96 = surplus=108.04
âœ… Calculated utility_surplus: {'model_a': 108.9325, 'model_b': 108.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 400, 'model_b': 370}
Metrics: {'utility_surplus': {'model_a': 108.9325, 'model_b': 108.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 295 completed successfully
Sun Nov 16 06:32:37 PM CET 2025: Completed iteration 295

=== Iteration 296/300 ===
Sun Nov 16 06:32:37 PM CET 2025: Starting resource allocation negotiation iteration 296
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.42s (total since entry 16.45s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
6, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.41s (total since entry 7.16s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 0}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 0}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 0}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 75, 'cpu_hours': 0}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 75, 'cpu_hours': 0}
[DEBUG] Validation error: Invalid action type 'offer' for game 'resource_allocation'
[DEBUG] Raw response: {"type": "offer", "gpu_hours": 75, "cpu_hours": 0}
âš ï¸ [DEBUG] [model_a] Pydantic validation failed, using original: Action validation failed: Invalid action type 'offer' for game 'resource_allocation'
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 20, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 20, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 20.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=20, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 40}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 40}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 40}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 40}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 40}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 40.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=40 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=10 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 30}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 30}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 55}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 55}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 55}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 55}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 55}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 55.0}
âš ï¸ Player model_b offer violates constraints: GPU=45, CPU=55
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=30 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=45, CPU=15 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=35, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 32, "cpu_hours": 28}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 32, 'cpu_hours': 28}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 32.0, 'cpu_hours': 28.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=35, CPU=20 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=35, CPU=20
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=400.00, marketing=370.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=113.30, marketing=111.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=400.00 - BATNA=286.70 = surplus=113.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=370.00 - BATNA=258.03 = surplus=111.97
âœ… Calculated utility_surplus: {'model_a': 113.29851250000002, 'model_b': 111.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 400, 'model_b': 370}
Metrics: {'utility_surplus': {'model_a': 113.29851250000002, 'model_b': 111.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 296 completed successfully
Sun Nov 16 06:33:30 PM CET 2025: Completed iteration 296

=== Iteration 297/300 ===
Sun Nov 16 06:33:30 PM CET 2025: Starting resource allocation negotiation iteration 297
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.48s (total since entry 16.51s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
9, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.44s (total since entry 7.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
18, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = DEVELOPMENT, model_a = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=45, CPU=15 (proposal 2/4)
ğŸ’¡ Player model_a made offer GPU=35, CPU=25 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 42, "cpu_hours": 22}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 42, "cpu_hours": 22}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 42, "cpu_hours": 22}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 42, 'cpu_hours': 22}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 42, 'cpu_hours': 22}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 42.0, 'cpu_hours': 22.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 30, "cpu_hours": 25}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 30, 'cpu_hours': 25}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 30.0, 'cpu_hours': 25.0}
ğŸ’¡ Player model_b made offer GPU=42, CPU=22 (proposal 4/4)
ğŸ’¡ Player model_a made offer GPU=30, CPU=25 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=30, CPU=25 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=30, CPU=25
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=390.00, marketing=380.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=103.30, marketing=121.97
ğŸ² [ROLE DEBUG] Development=model_b, Marketing=model_a
ğŸ’° [UTILITY SURPLUS] model_a: utility=380.00 - BATNA=258.03 = surplus=121.97
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=286.70 = surplus=103.30
âœ… Calculated utility_surplus: {'model_a': 121.96866125000003, 'model_b': 103.29851250000002}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 390, 'model_a': 380}
Metrics: {'utility_surplus': {'model_a': 121.96866125000003, 'model_b': 103.29851250000002}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 297 completed successfully
Sun Nov 16 06:34:23 PM CET 2025: Completed iteration 297

=== Iteration 298/300 ===
Sun Nov 16 06:34:23 PM CET 2025: Starting resource allocation negotiation iteration 298
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.04s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.56s (total since entry 16.62s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
6, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.47s (total since entry 7.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
11, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 60}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 60}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 60}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 60}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 60}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 60.0}
âš ï¸ Player model_b offer violates constraints: GPU=40, CPU=60
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=70, CPU=15 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 30}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 30}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 30.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer GPU=40, CPU=30 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 75, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 75, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 75, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 75.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=75, CPU=10 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=50, CPU=20 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_a made offer GPU=60, CPU=10 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=15 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=60, CPU=10 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=60, CPU=10
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=540.00, marketing=440.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=253.30, marketing=181.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=540.00 - BATNA=286.70 = surplus=253.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=440.00 - BATNA=258.03 = surplus=181.97
âœ… Calculated utility_surplus: {'model_a': 253.29851250000002, 'model_b': 181.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 540, 'model_b': 440}
Metrics: {'utility_surplus': {'model_a': 253.29851250000002, 'model_b': 181.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 298 completed successfully
Sun Nov 16 06:35:27 PM CET 2025: Completed iteration 298

=== Iteration 299/300 ===
Sun Nov 16 06:35:27 PM CET 2025: Starting resource allocation negotiation iteration 299
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.00s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.38s (total since entry 16.40s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.43s (total since entry 7.18s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 35}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 35}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 35}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 35.0}
ğŸ’¡ Player model_a made offer GPU=70, CPU=15 (proposal 1/4)
ğŸ’¡ Player model_b made offer GPU=40, CPU=35 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 60, "cpu_hours": 15}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 60, 'cpu_hours': 15}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 60.0, 'cpu_hours': 15.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 20.0}
ğŸ’¡ Player model_a made offer GPU=60, CPU=15 (proposal 2/4)
ğŸ’¡ Player model_b made offer GPU=50, CPU=20 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 35, "cpu_hours": 22.5}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 35, 'cpu_hours': 22.5}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 35.0, 'cpu_hours': 22.5}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_b made offer GPU=35, CPU=22.5 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=70, CPU=10 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of GPU=35, CPU=22.5 (made in round 3)
ğŸ” [RESOURCE DEBUG] Agreement in round 4: GPU=35, CPU=22.5
ğŸ” [BATNA DEBUG] Using BATNA from offer round 3 (offer made), agreement in round 4
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=291.07, marketing=261.96
ğŸ” [UTILITY DEBUG] Utilities: development=415.00, marketing=390.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=123.93, marketing=128.04
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=415.00 - BATNA=291.07 = surplus=123.93
ğŸ’° [UTILITY SURPLUS] model_b: utility=390.00 - BATNA=261.96 = surplus=128.04
âœ… Calculated utility_surplus: {'model_a': 123.9325, 'model_b': 128.03924999999998}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 415.0, 'model_b': 390.0}
Metrics: {'utility_surplus': {'model_a': 123.9325, 'model_b': 128.03924999999998}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 299 completed successfully
Sun Nov 16 06:36:04 PM CET 2025: Completed iteration 299

=== Iteration 300/300 ===
Sun Nov 16 06:36:04 PM CET 2025: Starting resource allocation negotiation iteration 300
ğŸ”§ About to run Python command...
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Resource Allocation Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.98s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.50s (total since entry 16.50s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.46s (total since entry 7.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = DEVELOPMENT, model_b = MARKETING
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 70, "cpu_hours": 5}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 70, 'cpu_hours': 5}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 70.0, 'cpu_hours': 5.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 1/4)
ğŸ’¡ Player model_a made offer GPU=70, CPU=5 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 50, "cpu_hours": 15}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 50, 'cpu_hours': 15}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 50.0, 'cpu_hours': 15.0}
ğŸ’¡ Player model_b made offer GPU=50, CPU=15 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 65, "cpu_hours": 5}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 65, "cpu_hours": 5}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 65, "cpu_hours": 5}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 65, 'cpu_hours': 5}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 65, 'cpu_hours': 5}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 65.0, 'cpu_hours': 5.0}
ğŸ’¡ Player model_b made offer GPU=40, CPU=20 (proposal 3/4)
ğŸ’¡ Player model_a made offer GPU=65, CPU=5 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "gpu_hours": 45, "cpu_hours": 10}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 45, 'cpu_hours': 10}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 45.0, 'cpu_hours': 10.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 55, "cpu_hours": 10}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 55, "cpu_hours": 10}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 55, "cpu_hours": 10}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 55, 'cpu_hours': 10}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 55, 'cpu_hours': 10}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 55.0, 'cpu_hours': 10.0}
ğŸ’¡ Player model_a made offer GPU=45, CPU=10 (proposal 3/4)
ğŸ’¡ Player model_b made offer GPU=55, CPU=10 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "gpu_hours": 40, "cpu_hours": 20}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
[DEBUG] Parsed JSON: {'type': 'offer', 'gpu_hours': 40, 'cpu_hours': 20}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'propose', 'gpu_hours': 40.0, 'cpu_hours': 20.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of GPU=45, CPU=10 (made in round 4)
ğŸ” [RESOURCE DEBUG] Agreement in round 5: GPU=45, CPU=10
ğŸ” [BATNA DEBUG] Using BATNA from offer round 4 (offer made), agreement in round 5
ğŸ” [BATNA DEBUG] Config BATNAs: development=300, marketing=270
ğŸ” [BATNA DEBUG] Decay rates: development=0.015, marketing=0.015
ğŸ” [BATNA DEBUG] Calculated BATNAs: development=286.70, marketing=258.03
ğŸ” [UTILITY DEBUG] Utilities: development=420.00, marketing=350.00
ğŸ” [SURPLUS DEBUG] Surpluses: development=133.30, marketing=91.97
ğŸ² [ROLE DEBUG] Development=model_a, Marketing=model_b
ğŸ’° [UTILITY SURPLUS] model_a: utility=420.00 - BATNA=286.70 = surplus=133.30
ğŸ’° [UTILITY SURPLUS] model_b: utility=350.00 - BATNA=258.03 = surplus=91.97
âœ… Calculated utility_surplus: {'model_a': 133.29851250000002, 'model_b': 91.96866125000003}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 420, 'model_b': 350}
Metrics: {'utility_surplus': {'model_a': 133.29851250000002, 'model_b': 91.96866125000003}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
ğŸ”§ Python command exit code: 0
âœ… Iteration 300 completed successfully
Sun Nov 16 06:36:58 PM CET 2025: Completed iteration 300

=== Resource Allocation Game Batch Complete ===
Successful iterations: 300/300
Check output logs for negotiation results and final utilities
