=== Company Car Game - 10 Iterations ===
Job ID: 1996284, Node: jn117
=== Environment Check ===
CUDA: True, GPU: NVIDIA L40
NVIDIA L40, 49140 MiB, 1 MiB
=== Verifying Torch Scope Fix ===
âœ… Torch scope fix is present
=== Running Company Car Game - 10 Iterations ===
Game: Employee vs Manager company car negotiation

=== Iteration 1/300 ===
Fri Nov  7 04:51:24 PM CET 2025: Starting company car negotiation iteration 1 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.58s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 22.01s (total since entry 22.60s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.85s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 46.51s (total since entry 47.36s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38888\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38888\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38888\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38888}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38888}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38888.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,888 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38475}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38475}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38475}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38475}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38475}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38475.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,475 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38550}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38550}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38550}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38550}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38550}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38550.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-5.20, model_a surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38589.59715125, 'model_a': 38600.0}
Metrics: {'utility_surplus': {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 1 completed successfully
Fri Nov  7 04:53:03 PM CET 2025: Completed iteration 1

=== Iteration 2/300 ===
Fri Nov  7 04:53:03 PM CET 2025: Starting company car negotiation iteration 2 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.96s (total since entry 5.66s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 9.12s (total since entry 9.76s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39250\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39250\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39250\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬39,250 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,600 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-5.20, model_b surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': -5.201424375001807, 'model_b': 1887.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38589.59715125, 'model_b': 38600.0}
Metrics: {'utility_surplus': {'model_a': -5.201424375001807, 'model_b': 1887.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 2 completed successfully
Fri Nov  7 04:53:34 PM CET 2025: Completed iteration 2

=== Iteration 3/300 ===
Fri Nov  7 04:53:34 PM CET 2025: Starting company car negotiation iteration 3 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.61s (total since entry 9.24s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬39,900 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39750\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39750\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39750\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38480}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38480}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38480}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38480}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38480}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38480.0}
ğŸ’¡ Player model_b made offer â‚¬39,750 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,480 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38760\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38760\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38760\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38760}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38760}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38760.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ’¡ Player model_b made offer â‚¬38,760 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,150 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38200\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38200\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38200\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,200 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 394.80 (saved â‚¬394.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1487.87 (profit â‚¬1487.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38989.60, seller=38200.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=394.80, model_a surplus=1487.87
âœ… Calculated utility_surplus: {'model_a': 1487.8745256249967, 'model_b': 394.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38989.59715125, 'model_a': 38200.0}
Metrics: {'utility_surplus': {'model_a': 1487.8745256249967, 'model_b': 394.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 3 completed successfully
Fri Nov  7 04:54:11 PM CET 2025: Completed iteration 3

=== Iteration 4/300 ===
Fri Nov  7 04:54:11 PM CET 2025: Starting company car negotiation iteration 4 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 4.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.48s (total since entry 9.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38200\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38200\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38200\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38850}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38850}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38850}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38850}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38850}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38850.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38300\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38300\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38300\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ’¡ Player model_a made offer â‚¬38,850 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,300 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,850 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38850
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -255.20 (saved â‚¬-255.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2137.87 (profit â‚¬2137.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38339.60, seller=38850.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-255.20, model_a surplus=2137.87
âœ… Calculated utility_surplus: {'model_a': 2137.8745256249967, 'model_b': -255.2014243750018}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38339.59715125, 'model_a': 38850.0}
Metrics: {'utility_surplus': {'model_a': 2137.8745256249967, 'model_b': -255.2014243750018}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 4 completed successfully
Fri Nov  7 04:54:41 PM CET 2025: Completed iteration 4

=== Iteration 5/300 ===
Fri Nov  7 04:54:41 PM CET 2025: Starting company car negotiation iteration 5 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1385.00, model_b surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 1385.0, 'model_b': 585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41770.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1385.0, 'model_b': 585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 5 completed successfully
Fri Nov  7 04:55:05 PM CET 2025: Completed iteration 5

=== Iteration 6/300 ===
Fri Nov  7 04:55:05 PM CET 2025: Starting company car negotiation iteration 6 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39100\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39100\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39100\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬39,100 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=682.54, model_b surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39865.07324999999, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 6 completed successfully
Fri Nov  7 04:55:34 PM CET 2025: Completed iteration 6

=== Iteration 7/300 ===
Fri Nov  7 04:55:34 PM CET 2025: Starting company car negotiation iteration 7 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.29s (total since entry 4.82s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.39s (total since entry 9.00s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 35000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 35000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 35000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 35000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 35000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 35000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬35,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,300 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 7 completed successfully
Fri Nov  7 04:56:05 PM CET 2025: Completed iteration 7

=== Iteration 8/300 ===
Fri Nov  7 04:56:05 PM CET 2025: Starting company car negotiation iteration 8 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.42s (total since entry 9.04s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬40,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 385.00 (saved â‚¬385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1585.00 (profit â‚¬1585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40770.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=385.00, model_b surplus=1585.00
âœ… Calculated utility_surplus: {'model_a': 385.0, 'model_b': 1585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 40770.0, 'model_b': 40000.0}
Metrics: {'utility_surplus': {'model_a': 385.0, 'model_b': 1585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 8 completed successfully
Fri Nov  7 04:56:29 PM CET 2025: Completed iteration 8

=== Iteration 9/300 ===
Fri Nov  7 04:56:29 PM CET 2025: Starting company car negotiation iteration 9 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.33s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.41s (total since entry 9.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 594.80 (saved â‚¬594.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1287.87 (profit â‚¬1287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39189.60, seller=38000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=594.80, model_b surplus=1287.87
âœ… Calculated utility_surplus: {'model_a': 594.7985756249982, 'model_b': 1287.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39189.59715125, 'model_b': 38000.0}
Metrics: {'utility_surplus': {'model_a': 594.7985756249982, 'model_b': 1287.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 9 completed successfully
Fri Nov  7 04:56:59 PM CET 2025: Completed iteration 9

=== Iteration 10/300 ===
Fri Nov  7 04:56:59 PM CET 2025: Starting company car negotiation iteration 10 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.33s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.62s (total since entry 9.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38700\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38700\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38700\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,750 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,100 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,100 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38100
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 494.80 (saved â‚¬494.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1387.87 (profit â‚¬1387.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39089.60, seller=38100.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=494.80, model_b surplus=1387.87
âœ… Calculated utility_surplus: {'model_a': 494.7985756249982, 'model_b': 1387.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39089.59715125, 'model_b': 38100.0}
Metrics: {'utility_surplus': {'model_a': 494.7985756249982, 'model_b': 1387.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 10 completed successfully
Fri Nov  7 04:57:34 PM CET 2025: Completed iteration 10

=== Iteration 11/300 ===
Fri Nov  7 04:57:34 PM CET 2025: Starting company car negotiation iteration 11 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.34s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.43s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,650 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", role": "ROLE A", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", role": "ROLE A", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", role": "ROLE A", "price": 37500}'
âš ï¸ [DEBUG] [model_a] JSON decode error for start match: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_a] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 37500}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_a] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 37500}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_a] Extracted JSON decode error: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âœ… [DEBUG] [model_a] Manually extracted action: {'type': 'offer'}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 11 completed successfully
Fri Nov  7 04:58:06 PM CET 2025: Completed iteration 11

=== Iteration 12/300 ===
Fri Nov  7 04:58:06 PM CET 2025: Starting company car negotiation iteration 12 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.50s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.31s (total since entry 4.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.33s (total since entry 8.96s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,490 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 37990}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37990}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37990}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37990}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37990}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37990.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,990 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=682.54, model_b surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39865.07324999999, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 12 completed successfully
Fri Nov  7 04:58:35 PM CET 2025: Completed iteration 12

=== Iteration 13/300 ===
Fri Nov  7 04:58:35 PM CET 2025: Starting company car negotiation iteration 13 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.34s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,150 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38275\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38275\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38275\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38275}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38275}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38275.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,275 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,275 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38275
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 319.80 (saved â‚¬319.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1562.87 (profit â‚¬1562.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38914.60, seller=38275.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=319.80, model_a surplus=1562.87
âœ… Calculated utility_surplus: {'model_a': 1562.8745256249967, 'model_b': 319.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38914.59715125, 'model_a': 38275.0}
Metrics: {'utility_surplus': {'model_a': 1562.8745256249967, 'model_b': 319.7985756249982}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 13 completed successfully
Fri Nov  7 04:59:09 PM CET 2025: Completed iteration 13

=== Iteration 14/300 ===
Fri Nov  7 04:59:09 PM CET 2025: Starting company car negotiation iteration 14 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.34s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.60s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37950}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37950}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37950}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37950}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37950.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,950 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,250 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38250
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 344.80 (saved â‚¬344.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1537.87 (profit â‚¬1537.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38939.60, seller=38250.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=344.80, model_b surplus=1537.87
âœ… Calculated utility_surplus: {'model_a': 344.7985756249982, 'model_b': 1537.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38939.59715125, 'model_b': 38250.0}
Metrics: {'utility_surplus': {'model_a': 344.7985756249982, 'model_b': 1537.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 14 completed successfully
Fri Nov  7 04:59:35 PM CET 2025: Completed iteration 14

=== Iteration 15/300 ===
Fri Nov  7 04:59:35 PM CET 2025: Starting company car negotiation iteration 15 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.46s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38495}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38495}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38495}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38495}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38495}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38495.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,495 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37950}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37950}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37950}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37950}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37950.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,950 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38480}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38480}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38480}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38480}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38480}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38480.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_a made offer â‚¬38,480 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,480 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38480
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 114.80 (saved â‚¬114.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1767.87 (profit â‚¬1767.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38709.60, seller=38480.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=114.80, model_a surplus=1767.87
âœ… Calculated utility_surplus: {'model_a': 1767.8745256249967, 'model_b': 114.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38709.59715125, 'model_a': 38480.0}
Metrics: {'utility_surplus': {'model_a': 1767.8745256249967, 'model_b': 114.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 15 completed successfully
Fri Nov  7 05:00:07 PM CET 2025: Completed iteration 15

=== Iteration 16/300 ===
Fri Nov  7 05:00:07 PM CET 2025: Starting company car negotiation iteration 16 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.60s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39100\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39100\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39100\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37950}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37950}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37950}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37950}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37950.0}
ğŸ’¡ Player model_b made offer â‚¬39,100 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,950 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=682.54, model_b surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39865.07324999999, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 16 completed successfully
Fri Nov  7 05:00:36 PM CET 2025: Completed iteration 16

=== Iteration 17/300 ===
Fri Nov  7 05:00:36 PM CET 2025: Starting company car negotiation iteration 17 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.60s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.97s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬40,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1000.00, model_a surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 42000.0, 'model_a': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 17 completed successfully
Fri Nov  7 05:00:58 PM CET 2025: Completed iteration 17

=== Iteration 18/300 ===
Fri Nov  7 05:00:58 PM CET 2025: Starting company car negotiation iteration 18 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.52s (total since entry 5.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=682.54, model_b surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39865.07324999999, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 18 completed successfully
Fri Nov  7 05:01:27 PM CET 2025: Completed iteration 18

=== Iteration 19/300 ===
Fri Nov  7 05:01:27 PM CET 2025: Starting company car negotiation iteration 19 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39200\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39200\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39200\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 19 completed successfully
Fri Nov  7 05:01:55 PM CET 2025: Completed iteration 19

=== Iteration 20/300 ===
Fri Nov  7 05:01:55 PM CET 2025: Starting company car negotiation iteration 20 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1279.22 (saved â‚¬1279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 661.22 (profit â‚¬661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41058.45, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1279.22, model_a surplus=661.22
âœ… Calculated utility_surplus: {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 41058.45, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 20 completed successfully
Fri Nov  7 05:02:18 PM CET 2025: Completed iteration 20

=== Iteration 21/300 ===
Fri Nov  7 05:02:18 PM CET 2025: Starting company car negotiation iteration 21 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬39,250 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,150 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=144.80, model_b surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38739.59715125, 'model_b': 38450.0}
Metrics: {'utility_surplus': {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 21 completed successfully
Fri Nov  7 05:02:43 PM CET 2025: Completed iteration 21

=== Iteration 22/300 ===
Fri Nov  7 05:02:43 PM CET 2025: Starting company car negotiation iteration 22 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.50s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.34s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬37,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1094.80 (saved â‚¬1094.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 787.87 (profit â‚¬787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39689.60, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1094.80, model_a surplus=787.87
âœ… Calculated utility_surplus: {'model_a': 787.8745256249967, 'model_b': 1094.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39689.59715125, 'model_a': 37500.0}
Metrics: {'utility_surplus': {'model_a': 787.8745256249967, 'model_b': 1094.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 22 completed successfully
Fri Nov  7 05:03:11 PM CET 2025: Completed iteration 22

=== Iteration 23/300 ===
Fri Nov  7 05:03:11 PM CET 2025: Starting company car negotiation iteration 23 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.34s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.46s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,650 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,650 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38650
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -55.20 (saved â‚¬-55.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1937.87 (profit â‚¬1937.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38539.60, seller=38650.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-55.20, model_a surplus=1937.87
âœ… Calculated utility_surplus: {'model_a': 1937.8745256249967, 'model_b': -55.20142437500181}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38539.59715125, 'model_a': 38650.0}
Metrics: {'utility_surplus': {'model_a': 1937.8745256249967, 'model_b': -55.20142437500181}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 23 completed successfully
Fri Nov  7 05:03:39 PM CET 2025: Completed iteration 23

=== Iteration 24/300 ===
Fri Nov  7 05:03:39 PM CET 2025: Starting company car negotiation iteration 24 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.33s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38475\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38475\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38475\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38475}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38475}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38475.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,475 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38850}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38850}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38850}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38850}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38850}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38850.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 24 completed successfully
Fri Nov  7 05:04:12 PM CET 2025: Completed iteration 24

=== Iteration 25/300 ===
Fri Nov  7 05:04:12 PM CET 2025: Starting company car negotiation iteration 25 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.65s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 594.80 (saved â‚¬594.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1287.87 (profit â‚¬1287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39189.60, seller=38000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=594.80, model_b surplus=1287.87
âœ… Calculated utility_surplus: {'model_a': 594.7985756249982, 'model_b': 1287.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39189.59715125, 'model_b': 38000.0}
Metrics: {'utility_surplus': {'model_a': 594.7985756249982, 'model_b': 1287.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 25 completed successfully
Fri Nov  7 05:04:40 PM CET 2025: Completed iteration 25

=== Iteration 26/300 ===
Fri Nov  7 05:04:40 PM CET 2025: Starting company car negotiation iteration 26 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.42s (total since entry 9.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,490 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,650 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,650 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38650
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -55.20 (saved â‚¬-55.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1937.87 (profit â‚¬1937.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38539.60, seller=38650.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-55.20, model_a surplus=1937.87
âœ… Calculated utility_surplus: {'model_a': 1937.8745256249967, 'model_b': -55.20142437500181}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38539.59715125, 'model_a': 38650.0}
Metrics: {'utility_surplus': {'model_a': 1937.8745256249967, 'model_b': -55.20142437500181}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 26 completed successfully
Fri Nov  7 05:05:08 PM CET 2025: Completed iteration 26

=== Iteration 27/300 ===
Fri Nov  7 05:05:08 PM CET 2025: Starting company car negotiation iteration 27 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.46s (total since entry 9.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬40,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1000.00, model_b surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 42000.0, 'model_b': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 27 completed successfully
Fri Nov  7 05:05:31 PM CET 2025: Completed iteration 27

=== Iteration 28/300 ===
Fri Nov  7 05:05:31 PM CET 2025: Starting company car negotiation iteration 28 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.60s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.04s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬40,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1000.00, model_b surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 42000.0, 'model_b': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 28 completed successfully
Fri Nov  7 05:05:53 PM CET 2025: Completed iteration 28

=== Iteration 29/300 ===
Fri Nov  7 05:05:53 PM CET 2025: Starting company car negotiation iteration 29 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.34s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,100 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=144.80, model_b surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38739.59715125, 'model_b': 38450.0}
Metrics: {'utility_surplus': {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 29 completed successfully
Fri Nov  7 05:06:23 PM CET 2025: Completed iteration 29

=== Iteration 30/300 ===
Fri Nov  7 05:06:23 PM CET 2025: Starting company car negotiation iteration 30 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.51s (total since entry 9.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37950}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37950}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37950}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37950}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37950.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,950 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=682.54, model_b surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39865.07324999999, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 30 completed successfully
Fri Nov  7 05:06:52 PM CET 2025: Completed iteration 30

=== Iteration 31/300 ===
Fri Nov  7 05:06:52 PM CET 2025: Starting company car negotiation iteration 31 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.50s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39150}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39150}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39150}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39150}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39150.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,150 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38150\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38150\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38150\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=144.80, model_b surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38739.59715125, 'model_b': 38450.0}
Metrics: {'utility_surplus': {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 31 completed successfully
Fri Nov  7 05:07:27 PM CET 2025: Completed iteration 31

=== Iteration 32/300 ===
Fri Nov  7 05:07:27 PM CET 2025: Starting company car negotiation iteration 32 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.65s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.48s (total since entry 9.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,490 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38750\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38750\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38750\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,250 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38250
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 344.80 (saved â‚¬344.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1537.87 (profit â‚¬1537.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38939.60, seller=38250.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=344.80, model_a surplus=1537.87
âœ… Calculated utility_surplus: {'model_a': 1537.8745256249967, 'model_b': 344.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38939.59715125, 'model_a': 38250.0}
Metrics: {'utility_surplus': {'model_a': 1537.8745256249967, 'model_b': 344.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 32 completed successfully
Fri Nov  7 05:07:59 PM CET 2025: Completed iteration 32

=== Iteration 33/300 ===
Fri Nov  7 05:07:59 PM CET 2025: Starting company car negotiation iteration 33 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.65s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40500.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38450\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38450\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38450\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 33 completed successfully
Fri Nov  7 05:08:29 PM CET 2025: Completed iteration 33

=== Iteration 34/300 ===
Fri Nov  7 05:08:29 PM CET 2025: Starting company car negotiation iteration 34 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.43s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬40,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1000.00, model_a surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 42000.0, 'model_a': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 34 completed successfully
Fri Nov  7 05:08:49 PM CET 2025: Completed iteration 34

=== Iteration 35/300 ===
Fri Nov  7 05:08:49 PM CET 2025: Starting company car negotiation iteration 35 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.49s (total since entry 9.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37850}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37850}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37850}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37850}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37850}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37850.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬37,850 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38800}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38800}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38800}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38800.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37950}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37950}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37950}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37950.0}
ğŸ’¡ Player model_a made offer â‚¬38,800 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬37,950 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,800 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38800
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -205.20 (saved â‚¬-205.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2087.87 (profit â‚¬2087.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38389.60, seller=38800.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-205.20, model_a surplus=2087.87
âœ… Calculated utility_surplus: {'model_a': 2087.8745256249967, 'model_b': -205.2014243750018}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38389.59715125, 'model_a': 38800.0}
Metrics: {'utility_surplus': {'model_a': 2087.8745256249967, 'model_b': -205.2014243750018}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 35 completed successfully
Fri Nov  7 05:09:15 PM CET 2025: Completed iteration 35

=== Iteration 36/300 ===
Fri Nov  7 05:09:15 PM CET 2025: Starting company car negotiation iteration 36 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.34s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.46s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬40,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1000.00, model_a surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 42000.0, 'model_a': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 36 completed successfully
Fri Nov  7 05:09:37 PM CET 2025: Completed iteration 36

=== Iteration 37/300 ===
Fri Nov  7 05:09:37 PM CET 2025: Starting company car negotiation iteration 37 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39300}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39300}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39300}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39300.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬39,300 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39100\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39100\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39100\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39100.0}
ğŸ’¡ Player model_a made offer â‚¬37,600 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,100 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 37500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 37500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 37500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36750.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬37,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1094.80 (saved â‚¬1094.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 787.87 (profit â‚¬787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39689.60, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1094.80, model_b surplus=787.87
âœ… Calculated utility_surplus: {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39689.59715125, 'model_b': 37500.0}
Metrics: {'utility_surplus': {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 37 completed successfully
Fri Nov  7 05:10:12 PM CET 2025: Completed iteration 37

=== Iteration 38/300 ===
Fri Nov  7 05:10:12 PM CET 2025: Starting company car negotiation iteration 38 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.33s (total since entry 4.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.66s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.47s (total since entry 9.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39999}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39999}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39999}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39999}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39999}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39999.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,999 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38515}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38515}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38515}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38515}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38515}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38515.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_a made offer â‚¬38,515 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬38,490 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38800}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38800}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38800}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38800.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,490 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38490
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 104.80 (saved â‚¬104.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1777.87 (profit â‚¬1777.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38699.60, seller=38490.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=104.80, model_a surplus=1777.87
âœ… Calculated utility_surplus: {'model_a': 1777.8745256249967, 'model_b': 104.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38699.59715125, 'model_a': 38490.0}
Metrics: {'utility_surplus': {'model_a': 1777.8745256249967, 'model_b': 104.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 38 completed successfully
Fri Nov  7 05:10:46 PM CET 2025: Completed iteration 38

=== Iteration 39/300 ===
Fri Nov  7 05:10:46 PM CET 2025: Starting company car negotiation iteration 39 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.47s (total since entry 9.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬37,450 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=144.80, model_b surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38739.59715125, 'model_b': 38450.0}
Metrics: {'utility_surplus': {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 39 completed successfully
Fri Nov  7 05:11:17 PM CET 2025: Completed iteration 39

=== Iteration 40/300 ===
Fri Nov  7 05:11:17 PM CET 2025: Starting company car negotiation iteration 40 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.60s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37840}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37840}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37840}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37840}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37840}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37840.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬37,840 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38480}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38480}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38480}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38480}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38480}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38480.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=144.80, model_a surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 1737.8745256249967, 'model_b': 144.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38739.59715125, 'model_a': 38450.0}
Metrics: {'utility_surplus': {'model_a': 1737.8745256249967, 'model_b': 144.7985756249982}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 40 completed successfully
Fri Nov  7 05:11:51 PM CET 2025: Completed iteration 40

=== Iteration 41/300 ===
Fri Nov  7 05:11:51 PM CET 2025: Starting company car negotiation iteration 41 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.34s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.46s (total since entry 9.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,300 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,200 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 394.80 (saved â‚¬394.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1487.87 (profit â‚¬1487.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38989.60, seller=38200.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=394.80, model_a surplus=1487.87
âœ… Calculated utility_surplus: {'model_a': 1487.8745256249967, 'model_b': 394.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38989.59715125, 'model_a': 38200.0}
Metrics: {'utility_surplus': {'model_a': 1487.8745256249967, 'model_b': 394.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 41 completed successfully
Fri Nov  7 05:12:19 PM CET 2025: Completed iteration 41

=== Iteration 42/300 ===
Fri Nov  7 05:12:19 PM CET 2025: Starting company car negotiation iteration 42 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,200 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 42 completed successfully
Fri Nov  7 05:12:50 PM CET 2025: Completed iteration 42

=== Iteration 43/300 ===
Fri Nov  7 05:12:50 PM CET 2025: Starting company car negotiation iteration 43 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.46s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1385.00, model_a surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 585.0, 'model_b': 1385.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 41770.0, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 585.0, 'model_b': 1385.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 43 completed successfully
Fri Nov  7 05:13:11 PM CET 2025: Completed iteration 43

=== Iteration 44/300 ===
Fri Nov  7 05:13:11 PM CET 2025: Starting company car negotiation iteration 44 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.81s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.43s (total since entry 9.24s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38750\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38750\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38750\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_a made offer â‚¬38,150 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ’¡ Player model_a made offer â‚¬38,350 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,300 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,350 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38350
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 244.80 (saved â‚¬244.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1637.87 (profit â‚¬1637.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38839.60, seller=38350.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=244.80, model_a surplus=1637.87
âœ… Calculated utility_surplus: {'model_a': 1637.8745256249967, 'model_b': 244.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38839.59715125, 'model_a': 38350.0}
Metrics: {'utility_surplus': {'model_a': 1637.8745256249967, 'model_b': 244.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 44 completed successfully
Fri Nov  7 05:13:42 PM CET 2025: Completed iteration 44

=== Iteration 45/300 ===
Fri Nov  7 05:13:42 PM CET 2025: Starting company car negotiation iteration 45 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,100 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38499}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38499}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38499}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38499}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38499}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38499.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
ğŸ’¡ Player model_b made offer â‚¬38,499 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,350 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,350 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38350
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 244.80 (saved â‚¬244.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1637.87 (profit â‚¬1637.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38839.60, seller=38350.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=244.80, model_a surplus=1637.87
âœ… Calculated utility_surplus: {'model_a': 1637.8745256249967, 'model_b': 244.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38839.59715125, 'model_a': 38350.0}
Metrics: {'utility_surplus': {'model_a': 1637.8745256249967, 'model_b': 244.7985756249982}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 45 completed successfully
Fri Nov  7 05:14:10 PM CET 2025: Completed iteration 45

=== Iteration 46/300 ===
Fri Nov  7 05:14:10 PM CET 2025: Starting company car negotiation iteration 46 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.95s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.42s (total since entry 9.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=144.80, model_b surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38739.59715125, 'model_b': 38450.0}
Metrics: {'utility_surplus': {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 46 completed successfully
Fri Nov  7 05:14:33 PM CET 2025: Completed iteration 46

=== Iteration 47/300 ===
Fri Nov  7 05:14:33 PM CET 2025: Starting company car negotiation iteration 47 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.41s (total since entry 9.02s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38800\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38800\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38800\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38800.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,800 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,400 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 194.80 (saved â‚¬194.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1687.87 (profit â‚¬1687.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38789.60, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=194.80, model_b surplus=1687.87
âœ… Calculated utility_surplus: {'model_a': 194.7985756249982, 'model_b': 1687.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38789.59715125, 'model_b': 38400.0}
Metrics: {'utility_surplus': {'model_a': 194.7985756249982, 'model_b': 1687.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 47 completed successfully
Fri Nov  7 05:15:08 PM CET 2025: Completed iteration 47

=== Iteration 48/300 ===
Fri Nov  7 05:15:08 PM CET 2025: Starting company car negotiation iteration 48 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.47s (total since entry 9.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39750\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39750\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39750\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39750.0}
ğŸ’¡ Player model_a made offer â‚¬38,150 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38450\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38450\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38450\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38200\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38200\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38200\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38800}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38800}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38800}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38800.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,250 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38250
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 344.80 (saved â‚¬344.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1537.87 (profit â‚¬1537.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38939.60, seller=38250.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=344.80, model_a surplus=1537.87
âœ… Calculated utility_surplus: {'model_a': 1537.8745256249967, 'model_b': 344.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38939.59715125, 'model_a': 38250.0}
Metrics: {'utility_surplus': {'model_a': 1537.8745256249967, 'model_b': 344.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 48 completed successfully
Fri Nov  7 05:15:43 PM CET 2025: Completed iteration 48

=== Iteration 49/300 ===
Fri Nov  7 05:15:43 PM CET 2025: Starting company car negotiation iteration 49 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1385.00, model_b surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 1385.0, 'model_b': 585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41770.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1385.0, 'model_b': 585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 49 completed successfully
Fri Nov  7 05:16:06 PM CET 2025: Completed iteration 49

=== Iteration 50/300 ===
Fri Nov  7 05:16:06 PM CET 2025: Starting company car negotiation iteration 50 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.80s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.24s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39700\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39700\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39700\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39700.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
ğŸ’¡ Player model_b made offer â‚¬39,700 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,490 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38700\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38700\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38700\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,400 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 194.80 (saved â‚¬194.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1687.87 (profit â‚¬1687.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38789.60, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=194.80, model_a surplus=1687.87
âœ… Calculated utility_surplus: {'model_a': 1687.8745256249967, 'model_b': 194.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38789.59715125, 'model_a': 38400.0}
Metrics: {'utility_surplus': {'model_a': 1687.8745256249967, 'model_b': 194.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 50 completed successfully
Fri Nov  7 05:16:42 PM CET 2025: Completed iteration 50

=== Iteration 51/300 ===
Fri Nov  7 05:16:42 PM CET 2025: Starting company car negotiation iteration 51 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.47s (total since entry 9.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬39,400 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,490 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,600 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 582.54 (saved â‚¬582.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1328.81 (profit â‚¬1328.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39765.07, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=582.54, model_b surplus=1328.81
âœ… Calculated utility_surplus: {'model_a': 582.5366249999934, 'model_b': 1328.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39765.07324999999, 'model_b': 38600.0}
Metrics: {'utility_surplus': {'model_a': 582.5366249999934, 'model_b': 1328.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 51 completed successfully
Fri Nov  7 05:17:10 PM CET 2025: Completed iteration 51

=== Iteration 52/300 ===
Fri Nov  7 05:17:10 PM CET 2025: Starting company car negotiation iteration 52 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.44s (total since entry 4.98s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.65s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,300 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 37650\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 37650\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 37650\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37650}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37650.0}
ğŸ’¡ Player model_b made offer â‚¬37,800 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬37,650 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬37,650 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37650
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 944.80 (saved â‚¬944.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 937.87 (profit â‚¬937.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39539.60, seller=37650.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=944.80, model_a surplus=937.87
âœ… Calculated utility_surplus: {'model_a': 937.8745256249967, 'model_b': 944.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 25.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39539.59715125, 'model_a': 37650.0}
Metrics: {'utility_surplus': {'model_a': 937.8745256249967, 'model_b': 944.7985756249982}, 'risk_minimization': {'model_a': 25.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 52 completed successfully
Fri Nov  7 05:17:37 PM CET 2025: Completed iteration 52

=== Iteration 53/300 ===
Fri Nov  7 05:17:37 PM CET 2025: Starting company car negotiation iteration 53 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.34s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,650 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38800}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38800}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38800}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38800.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,650 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38650
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -55.20 (saved â‚¬-55.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1937.87 (profit â‚¬1937.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38539.60, seller=38650.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-55.20, model_a surplus=1937.87
âœ… Calculated utility_surplus: {'model_a': 1937.8745256249967, 'model_b': -55.20142437500181}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38539.59715125, 'model_a': 38650.0}
Metrics: {'utility_surplus': {'model_a': 1937.8745256249967, 'model_b': -55.20142437500181}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 53 completed successfully
Fri Nov  7 05:18:05 PM CET 2025: Completed iteration 53

=== Iteration 54/300 ===
Fri Nov  7 05:18:05 PM CET 2025: Starting company car negotiation iteration 54 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.46s (total since entry 9.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39300\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39300\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39300\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39300.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,300 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37950}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37950}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37950}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37950}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37950.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39100.0}
ğŸ’¡ Player model_a made offer â‚¬37,950 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,100 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 54 completed successfully
Fri Nov  7 05:18:34 PM CET 2025: Completed iteration 54

=== Iteration 55/300 ===
Fri Nov  7 05:18:34 PM CET 2025: Starting company car negotiation iteration 55 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.47s (total since entry 9.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬37,800 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬37,800 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬37,800 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37800
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 794.80 (saved â‚¬794.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1087.87 (profit â‚¬1087.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39389.60, seller=37800.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=794.80, model_b surplus=1087.87
âœ… Calculated utility_surplus: {'model_a': 794.7985756249982, 'model_b': 1087.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39389.59715125, 'model_b': 37800.0}
Metrics: {'utility_surplus': {'model_a': 794.7985756249982, 'model_b': 1087.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 55 completed successfully
Fri Nov  7 05:19:11 PM CET 2025: Completed iteration 55

=== Iteration 56/300 ===
Fri Nov  7 05:19:11 PM CET 2025: Starting company car negotiation iteration 56 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.33s (total since entry 4.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.42s (total since entry 9.02s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬40,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1000.00, model_a surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 42000.0, 'model_a': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 56 completed successfully
Fri Nov  7 05:19:33 PM CET 2025: Completed iteration 56

=== Iteration 57/300 ===
Fri Nov  7 05:19:33 PM CET 2025: Starting company car negotiation iteration 57 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.34s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.47s (total since entry 9.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 57 completed successfully
Fri Nov  7 05:20:01 PM CET 2025: Completed iteration 57

=== Iteration 58/300 ===
Fri Nov  7 05:20:01 PM CET 2025: Starting company car negotiation iteration 58 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.43s (total since entry 9.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38765\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38765\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38765\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38765}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38765}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38765.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,765 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38550\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38550\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38550\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38550}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38550}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38550.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,550 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,650 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,650 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38650
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -55.20 (saved â‚¬-55.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1937.87 (profit â‚¬1937.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38539.60, seller=38650.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-55.20, model_a surplus=1937.87
âœ… Calculated utility_surplus: {'model_a': 1937.8745256249967, 'model_b': -55.20142437500181}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38539.59715125, 'model_a': 38650.0}
Metrics: {'utility_surplus': {'model_a': 1937.8745256249967, 'model_b': -55.20142437500181}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 58 completed successfully
Fri Nov  7 05:20:30 PM CET 2025: Completed iteration 58

=== Iteration 59/300 ===
Fri Nov  7 05:20:30 PM CET 2025: Starting company car negotiation iteration 59 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.43s (total since entry 9.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,200 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 394.80 (saved â‚¬394.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1487.87 (profit â‚¬1487.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38989.60, seller=38200.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=394.80, model_b surplus=1487.87
âœ… Calculated utility_surplus: {'model_a': 394.7985756249982, 'model_b': 1487.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38989.59715125, 'model_b': 38200.0}
Metrics: {'utility_surplus': {'model_a': 394.7985756249982, 'model_b': 1487.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 59 completed successfully
Fri Nov  7 05:20:58 PM CET 2025: Completed iteration 59

=== Iteration 60/300 ===
Fri Nov  7 05:20:58 PM CET 2025: Starting company car negotiation iteration 60 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.50s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38200\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38200\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38200\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,200 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 394.80 (saved â‚¬394.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1487.87 (profit â‚¬1487.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38989.60, seller=38200.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=394.80, model_a surplus=1487.87
âœ… Calculated utility_surplus: {'model_a': 1487.8745256249967, 'model_b': 394.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38989.59715125, 'model_a': 38200.0}
Metrics: {'utility_surplus': {'model_a': 1487.8745256249967, 'model_b': 394.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 60 completed successfully
Fri Nov  7 05:21:22 PM CET 2025: Completed iteration 60

=== Iteration 61/300 ===
Fri Nov  7 05:21:22 PM CET 2025: Starting company car negotiation iteration 61 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.34s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.65s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38250\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38250\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38250\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,250 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38250
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 344.80 (saved â‚¬344.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1537.87 (profit â‚¬1537.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38939.60, seller=38250.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=344.80, model_b surplus=1537.87
âœ… Calculated utility_surplus: {'model_a': 344.7985756249982, 'model_b': 1537.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38939.59715125, 'model_b': 38250.0}
Metrics: {'utility_surplus': {'model_a': 344.7985756249982, 'model_b': 1537.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 61 completed successfully
Fri Nov  7 05:21:57 PM CET 2025: Completed iteration 61

=== Iteration 62/300 ===
Fri Nov  7 05:21:57 PM CET 2025: Starting company car negotiation iteration 62 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.50s (total since entry 9.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬37,600 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬37,800 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36800}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36800}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36800}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36800.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 36800}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36800}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36800}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36800.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬37,800 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37800
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 794.80 (saved â‚¬794.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1087.87 (profit â‚¬1087.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39389.60, seller=37800.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=794.80, model_b surplus=1087.87
âœ… Calculated utility_surplus: {'model_a': 794.7985756249982, 'model_b': 1087.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39389.59715125, 'model_b': 37800.0}
Metrics: {'utility_surplus': {'model_a': 794.7985756249982, 'model_b': 1087.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 62 completed successfully
Fri Nov  7 05:22:26 PM CET 2025: Completed iteration 62

=== Iteration 63/300 ===
Fri Nov  7 05:22:26 PM CET 2025: Starting company car negotiation iteration 63 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.34s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.60s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.39s (total since entry 8.99s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬39,200 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 182.54 (saved â‚¬182.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1728.81 (profit â‚¬1728.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39365.07, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=182.54, model_b surplus=1728.81
âœ… Calculated utility_surplus: {'model_a': 182.53662499999336, 'model_b': 1728.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39365.07324999999, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 182.53662499999336, 'model_b': 1728.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 63 completed successfully
Fri Nov  7 05:22:51 PM CET 2025: Completed iteration 63

=== Iteration 64/300 ===
Fri Nov  7 05:22:51 PM CET 2025: Starting company car negotiation iteration 64 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.39s (total since entry 4.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.46s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38800\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38800\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38800\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38800.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,800 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 594.80 (saved â‚¬594.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1287.87 (profit â‚¬1287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39189.60, seller=38000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=594.80, model_b surplus=1287.87
âœ… Calculated utility_surplus: {'model_a': 594.7985756249982, 'model_b': 1287.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39189.59715125, 'model_b': 38000.0}
Metrics: {'utility_surplus': {'model_a': 594.7985756249982, 'model_b': 1287.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 64 completed successfully
Fri Nov  7 05:23:24 PM CET 2025: Completed iteration 64

=== Iteration 65/300 ===
Fri Nov  7 05:23:24 PM CET 2025: Starting company car negotiation iteration 65 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.83s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.50s (total since entry 9.34s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38760}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38760}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38760}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38760}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38760}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38760.0}
ğŸ’¡ Player model_a made offer â‚¬38,150 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,760 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
ğŸ’¡ Player model_b made offer â‚¬38,300 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,900 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,300 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=38300
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 882.54 (saved â‚¬882.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1028.81 (profit â‚¬1028.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40065.07, seller=38300.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=882.54, model_a surplus=1028.81
âœ… Calculated utility_surplus: {'model_a': 1028.8066250000047, 'model_b': 882.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 40065.07324999999, 'model_a': 38300.0}
Metrics: {'utility_surplus': {'model_a': 1028.8066250000047, 'model_b': 882.5366249999934}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 65 completed successfully
Fri Nov  7 05:23:49 PM CET 2025: Completed iteration 65

=== Iteration 66/300 ===
Fri Nov  7 05:23:49 PM CET 2025: Starting company car negotiation iteration 66 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.33s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.81s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.43s (total since entry 9.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37850}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37850}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37850}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37850}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37850}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37850.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬37,850 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38150\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38150\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38150\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38200\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38200\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38200\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_a made offer â‚¬38,150 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,150 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38150
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 444.80 (saved â‚¬444.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1437.87 (profit â‚¬1437.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39039.60, seller=38150.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=444.80, model_a surplus=1437.87
âœ… Calculated utility_surplus: {'model_a': 1437.8745256249967, 'model_b': 444.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39039.59715125, 'model_a': 38150.0}
Metrics: {'utility_surplus': {'model_a': 1437.8745256249967, 'model_b': 444.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 66 completed successfully
Fri Nov  7 05:24:16 PM CET 2025: Completed iteration 66

=== Iteration 67/300 ===
Fri Nov  7 05:24:16 PM CET 2025: Starting company car negotiation iteration 67 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.46s (total since entry 9.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬40,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 385.00 (saved â‚¬385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1585.00 (profit â‚¬1585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40770.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=385.00, model_b surplus=1585.00
âœ… Calculated utility_surplus: {'model_a': 385.0, 'model_b': 1585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 40770.0, 'model_b': 40000.0}
Metrics: {'utility_surplus': {'model_a': 385.0, 'model_b': 1585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 67 completed successfully
Fri Nov  7 05:24:40 PM CET 2025: Completed iteration 67

=== Iteration 68/300 ===
Fri Nov  7 05:24:40 PM CET 2025: Starting company car negotiation iteration 68 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.55s (total since entry 5.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.48s (total since entry 9.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40250.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬40,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬37,750 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬37,750 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37750
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 844.80 (saved â‚¬844.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1037.87 (profit â‚¬1037.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39439.60, seller=37750.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=844.80, model_b surplus=1037.87
âœ… Calculated utility_surplus: {'model_a': 844.7985756249982, 'model_b': 1037.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39439.59715125, 'model_b': 37750.0}
Metrics: {'utility_surplus': {'model_a': 844.7985756249982, 'model_b': 1037.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 68 completed successfully
Fri Nov  7 05:25:13 PM CET 2025: Completed iteration 68

=== Iteration 69/300 ===
Fri Nov  7 05:25:13 PM CET 2025: Starting company car negotiation iteration 69 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 4.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.50s (total since entry 9.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38700\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38700\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38700\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=144.80, model_b surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38739.59715125, 'model_b': 38450.0}
Metrics: {'utility_surplus': {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 69 completed successfully
Fri Nov  7 05:25:48 PM CET 2025: Completed iteration 69

=== Iteration 70/300 ===
Fri Nov  7 05:25:48 PM CET 2025: Starting company car negotiation iteration 70 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.33s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.43s (total since entry 9.04s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38425\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38425\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38425\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38425}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38425}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38425.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,425 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âŒ Player model_b rejected after reaching proposal limit (4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 70 completed successfully
Fri Nov  7 05:26:14 PM CET 2025: Completed iteration 70

=== Iteration 71/300 ===
Fri Nov  7 05:26:14 PM CET 2025: Starting company car negotiation iteration 71 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.60s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.49s (total since entry 9.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39200\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39200\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39200\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ’¡ Player model_a made offer â‚¬37,750 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 38250\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38250\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38250\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,250 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38250
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 344.80 (saved â‚¬344.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1537.87 (profit â‚¬1537.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38939.60, seller=38250.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=344.80, model_b surplus=1537.87
âœ… Calculated utility_surplus: {'model_a': 344.7985756249982, 'model_b': 1537.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38939.59715125, 'model_b': 38250.0}
Metrics: {'utility_surplus': {'model_a': 344.7985756249982, 'model_b': 1537.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 71 completed successfully
Fri Nov  7 05:26:46 PM CET 2025: Completed iteration 71

=== Iteration 72/300 ===
Fri Nov  7 05:26:46 PM CET 2025: Starting company car negotiation iteration 72 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.34s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.65s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40500.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,150 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1279.22 (saved â‚¬1279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 661.22 (profit â‚¬661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41058.45, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1279.22, model_a surplus=661.22
âœ… Calculated utility_surplus: {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 33.33333333333333, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 41058.45, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}, 'risk_minimization': {'model_a': 33.33333333333333, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 72 completed successfully
Fri Nov  7 05:27:14 PM CET 2025: Completed iteration 72

=== Iteration 73/300 ===
Fri Nov  7 05:27:14 PM CET 2025: Starting company car negotiation iteration 73 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.46s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬40,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1000.00, model_b surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 42000.0, 'model_b': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 73 completed successfully
Fri Nov  7 05:27:37 PM CET 2025: Completed iteration 73

=== Iteration 74/300 ===
Fri Nov  7 05:27:37 PM CET 2025: Starting company car negotiation iteration 74 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.48s (total since entry 9.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39200\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39200\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39200\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37650}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37650}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37650}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37650}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37650.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36850}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36850}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36850}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36850}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36850}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36850.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬37,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1094.80 (saved â‚¬1094.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 787.87 (profit â‚¬787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39689.60, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1094.80, model_b surplus=787.87
âœ… Calculated utility_surplus: {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39689.59715125, 'model_b': 37500.0}
Metrics: {'utility_surplus': {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 74 completed successfully
Fri Nov  7 05:28:09 PM CET 2025: Completed iteration 74

=== Iteration 75/300 ===
Fri Nov  7 05:28:09 PM CET 2025: Starting company car negotiation iteration 75 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.66s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.46s (total since entry 9.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,600 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-5.20, model_b surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': -5.201424375001807, 'model_b': 1887.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38589.59715125, 'model_b': 38600.0}
Metrics: {'utility_surplus': {'model_a': -5.201424375001807, 'model_b': 1887.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 75 completed successfully
Fri Nov  7 05:28:43 PM CET 2025: Completed iteration 75

=== Iteration 76/300 ===
Fri Nov  7 05:28:43 PM CET 2025: Starting company car negotiation iteration 76 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.60s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.61s (total since entry 5.22s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.81s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.75s (total since entry 9.57s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39415}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39415}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39415}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39415}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39415}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39415.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬39,415 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38200\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38200\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38200\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38800}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38800}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38800}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38800.0}
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,800 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,800 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38800
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -205.20 (saved â‚¬-205.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2087.87 (profit â‚¬2087.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38389.60, seller=38800.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-205.20, model_a surplus=2087.87
âœ… Calculated utility_surplus: {'model_a': 2087.8745256249967, 'model_b': -205.2014243750018}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38389.59715125, 'model_a': 38800.0}
Metrics: {'utility_surplus': {'model_a': 2087.8745256249967, 'model_b': -205.2014243750018}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 76 completed successfully
Fri Nov  7 05:29:12 PM CET 2025: Completed iteration 76

=== Iteration 77/300 ===
Fri Nov  7 05:29:12 PM CET 2025: Starting company car negotiation iteration 77 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.34s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.47s (total since entry 9.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38779\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38779\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38779\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38779}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38779}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38779.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ’¡ Player model_b made offer â‚¬38,779 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,650 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38625\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38625\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38625\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38625}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38625}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38625.0}
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,625 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,200 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 394.80 (saved â‚¬394.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1487.87 (profit â‚¬1487.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38989.60, seller=38200.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=394.80, model_a surplus=1487.87
âœ… Calculated utility_surplus: {'model_a': 1487.8745256249967, 'model_b': 394.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38989.59715125, 'model_a': 38200.0}
Metrics: {'utility_surplus': {'model_a': 1487.8745256249967, 'model_b': 394.7985756249982}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 77 completed successfully
Fri Nov  7 05:29:41 PM CET 2025: Completed iteration 77

=== Iteration 78/300 ===
Fri Nov  7 05:29:41 PM CET 2025: Starting company car negotiation iteration 78 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.43s (total since entry 9.04s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 594.80 (saved â‚¬594.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1287.87 (profit â‚¬1287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39189.60, seller=38000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=594.80, model_b surplus=1287.87
âœ… Calculated utility_surplus: {'model_a': 594.7985756249982, 'model_b': 1287.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39189.59715125, 'model_b': 38000.0}
Metrics: {'utility_surplus': {'model_a': 594.7985756249982, 'model_b': 1287.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 78 completed successfully
Fri Nov  7 05:30:04 PM CET 2025: Completed iteration 78

=== Iteration 79/300 ===
Fri Nov  7 05:30:04 PM CET 2025: Starting company car negotiation iteration 79 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.56s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 4.95s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬37,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1094.80 (saved â‚¬1094.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 787.87 (profit â‚¬787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39689.60, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1094.80, model_b surplus=787.87
âœ… Calculated utility_surplus: {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39689.59715125, 'model_b': 37500.0}
Metrics: {'utility_surplus': {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 79 completed successfully
Fri Nov  7 05:30:36 PM CET 2025: Completed iteration 79

=== Iteration 80/300 ===
Fri Nov  7 05:30:36 PM CET 2025: Starting company car negotiation iteration 80 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.33s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 594.80 (saved â‚¬594.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1287.87 (profit â‚¬1287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39189.60, seller=38000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=594.80, model_b surplus=1287.87
âœ… Calculated utility_surplus: {'model_a': 594.7985756249982, 'model_b': 1287.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39189.59715125, 'model_b': 38000.0}
Metrics: {'utility_surplus': {'model_a': 594.7985756249982, 'model_b': 1287.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 80 completed successfully
Fri Nov  7 05:31:07 PM CET 2025: Completed iteration 80

=== Iteration 81/300 ===
Fri Nov  7 05:31:07 PM CET 2025: Starting company car negotiation iteration 81 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 5.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.48s (total since entry 9.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1385.00, model_b surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 1385.0, 'model_b': 585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41770.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1385.0, 'model_b': 585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 81 completed successfully
Fri Nov  7 05:31:28 PM CET 2025: Completed iteration 81

=== Iteration 82/300 ===
Fri Nov  7 05:31:28 PM CET 2025: Starting company car negotiation iteration 82 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.29s (total since entry 4.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.80s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.37s (total since entry 9.16s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,100 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,200 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 394.80 (saved â‚¬394.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1487.87 (profit â‚¬1487.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38989.60, seller=38200.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=394.80, model_a surplus=1487.87
âœ… Calculated utility_surplus: {'model_a': 1487.8745256249967, 'model_b': 394.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38989.59715125, 'model_a': 38200.0}
Metrics: {'utility_surplus': {'model_a': 1487.8745256249967, 'model_b': 394.7985756249982}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 82 completed successfully
Fri Nov  7 05:31:58 PM CET 2025: Completed iteration 82

=== Iteration 83/300 ===
Fri Nov  7 05:31:58 PM CET 2025: Starting company car negotiation iteration 83 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.58s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.94s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.46s (total since entry 9.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38450\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38475}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38475}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38475}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38475}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38475}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38475.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,475 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,475 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38475
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 119.80 (saved â‚¬119.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1762.87 (profit â‚¬1762.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38714.60, seller=38475.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=119.80, model_a surplus=1762.87
âœ… Calculated utility_surplus: {'model_a': 1762.8745256249967, 'model_b': 119.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38714.59715125, 'model_a': 38475.0}
Metrics: {'utility_surplus': {'model_a': 1762.8745256249967, 'model_b': 119.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 83 completed successfully
Fri Nov  7 05:32:29 PM CET 2025: Completed iteration 83

=== Iteration 84/300 ===
Fri Nov  7 05:32:29 PM CET 2025: Starting company car negotiation iteration 84 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.46s (total since entry 9.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38120}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38120}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38120}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38120}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38120}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38120.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,120 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38300\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38300\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38300\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,300 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=144.80, model_a surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 1737.8745256249967, 'model_b': 144.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38739.59715125, 'model_a': 38450.0}
Metrics: {'utility_surplus': {'model_a': 1737.8745256249967, 'model_b': 144.7985756249982}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 84 completed successfully
Fri Nov  7 05:32:59 PM CET 2025: Completed iteration 84

=== Iteration 85/300 ===
Fri Nov  7 05:32:59 PM CET 2025: Starting company car negotiation iteration 85 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.47s (total since entry 9.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2000.00 (saved â‚¬2000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 0.00 (profit â‚¬0.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43000.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=2000.00, model_a surplus=0.00
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 2000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 43000.0, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 2000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 85 completed successfully
Fri Nov  7 05:33:18 PM CET 2025: Completed iteration 85

=== Iteration 86/300 ===
Fri Nov  7 05:33:18 PM CET 2025: Starting company car negotiation iteration 86 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.41s (total since entry 4.93s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.49s (total since entry 9.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37950}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37950}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37950}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37950}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37950.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,950 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 594.80 (saved â‚¬594.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1287.87 (profit â‚¬1287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39189.60, seller=38000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=594.80, model_a surplus=1287.87
âœ… Calculated utility_surplus: {'model_a': 1287.8745256249967, 'model_b': 594.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39189.59715125, 'model_a': 38000.0}
Metrics: {'utility_surplus': {'model_a': 1287.8745256249967, 'model_b': 594.7985756249982}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 86 completed successfully
Fri Nov  7 05:33:46 PM CET 2025: Completed iteration 86

=== Iteration 87/300 ===
Fri Nov  7 05:33:46 PM CET 2025: Starting company car negotiation iteration 87 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.43s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39200\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39200\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39200\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 594.80 (saved â‚¬594.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1287.87 (profit â‚¬1287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39189.60, seller=38000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=594.80, model_b surplus=1287.87
âœ… Calculated utility_surplus: {'model_a': 594.7985756249982, 'model_b': 1287.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39189.59715125, 'model_b': 38000.0}
Metrics: {'utility_surplus': {'model_a': 594.7985756249982, 'model_b': 1287.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 87 completed successfully
Fri Nov  7 05:34:18 PM CET 2025: Completed iteration 87

=== Iteration 88/300 ===
Fri Nov  7 05:34:18 PM CET 2025: Starting company car negotiation iteration 88 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 35000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 35000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 35000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 35000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 35000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 35000.0}
ğŸ’¡ Player model_b made offer â‚¬40,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬35,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38900.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,900 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,900 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38900
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -305.20 (saved â‚¬-305.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2187.87 (profit â‚¬2187.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38289.60, seller=38900.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-305.20, model_a surplus=2187.87
âœ… Calculated utility_surplus: {'model_a': 2187.8745256249967, 'model_b': -305.2014243750018}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38289.59715125, 'model_a': 38900.0}
Metrics: {'utility_surplus': {'model_a': 2187.8745256249967, 'model_b': -305.2014243750018}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 88 completed successfully
Fri Nov  7 05:34:43 PM CET 2025: Completed iteration 88

=== Iteration 89/300 ===
Fri Nov  7 05:34:43 PM CET 2025: Starting company car negotiation iteration 89 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38800\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38800\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38800\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38800.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,800 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 594.80 (saved â‚¬594.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1287.87 (profit â‚¬1287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39189.60, seller=38000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=594.80, model_b surplus=1287.87
âœ… Calculated utility_surplus: {'model_a': 594.7985756249982, 'model_b': 1287.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39189.59715125, 'model_b': 38000.0}
Metrics: {'utility_surplus': {'model_a': 594.7985756249982, 'model_b': 1287.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 89 completed successfully
Fri Nov  7 05:35:11 PM CET 2025: Completed iteration 89

=== Iteration 90/300 ===
Fri Nov  7 05:35:11 PM CET 2025: Starting company car negotiation iteration 90 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.34s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.46s (total since entry 9.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬40,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 385.00 (saved â‚¬385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1585.00 (profit â‚¬1585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40770.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=385.00, model_b surplus=1585.00
âœ… Calculated utility_surplus: {'model_a': 385.0, 'model_b': 1585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 40770.0, 'model_b': 40000.0}
Metrics: {'utility_surplus': {'model_a': 385.0, 'model_b': 1585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 90 completed successfully
Fri Nov  7 05:35:37 PM CET 2025: Completed iteration 90

=== Iteration 91/300 ===
Fri Nov  7 05:35:37 PM CET 2025: Starting company car negotiation iteration 91 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.46s (total since entry 9.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,800 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 91 completed successfully
Fri Nov  7 05:36:09 PM CET 2025: Completed iteration 91

=== Iteration 92/300 ===
Fri Nov  7 05:36:09 PM CET 2025: Starting company car negotiation iteration 92 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.50s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.49s (total since entry 9.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,100 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=682.54, model_a surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39865.07324999999, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 92 completed successfully
Fri Nov  7 05:36:38 PM CET 2025: Completed iteration 92

=== Iteration 93/300 ===
Fri Nov  7 05:36:38 PM CET 2025: Starting company car negotiation iteration 93 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.49s (total since entry 9.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ’¡ Player model_a made offer â‚¬37,450 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=682.54, model_b surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39865.07324999999, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 93 completed successfully
Fri Nov  7 05:37:06 PM CET 2025: Completed iteration 93

=== Iteration 94/300 ===
Fri Nov  7 05:37:06 PM CET 2025: Starting company car negotiation iteration 94 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.33s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.46s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,490 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38390}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38390}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38390}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38390}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38390}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38390.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38475}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38475}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38475}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38475}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38475}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38475.0}
ğŸ’¡ Player model_a made offer â‚¬38,390 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,475 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,390 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38390
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 204.80 (saved â‚¬204.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1677.87 (profit â‚¬1677.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38799.60, seller=38390.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=204.80, model_a surplus=1677.87
âœ… Calculated utility_surplus: {'model_a': 1677.8745256249967, 'model_b': 204.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38799.59715125, 'model_a': 38390.0}
Metrics: {'utility_surplus': {'model_a': 1677.8745256249967, 'model_b': 204.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 94 completed successfully
Fri Nov  7 05:37:30 PM CET 2025: Completed iteration 94

=== Iteration 95/300 ===
Fri Nov  7 05:37:30 PM CET 2025: Starting company car negotiation iteration 95 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38850}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38850}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38850}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38850}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38850}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38850.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38100\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38100\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38100\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ’¡ Player model_a made offer â‚¬38,850 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,100 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38700\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38700\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38700\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬39,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -405.20 (saved â‚¬-405.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2287.87 (profit â‚¬2287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38189.60, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-405.20, model_a surplus=2287.87
âœ… Calculated utility_surplus: {'model_a': 2287.8745256249967, 'model_b': -405.2014243750018}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38189.59715125, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 2287.8745256249967, 'model_b': -405.2014243750018}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 95 completed successfully
Fri Nov  7 05:38:01 PM CET 2025: Completed iteration 95

=== Iteration 96/300 ===
Fri Nov  7 05:38:01 PM CET 2025: Starting company car negotiation iteration 96 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.33s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.39s (total since entry 9.03s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 96 completed successfully
Fri Nov  7 05:38:34 PM CET 2025: Completed iteration 96

=== Iteration 97/300 ===
Fri Nov  7 05:38:34 PM CET 2025: Starting company car negotiation iteration 97 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.60s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.46s (total since entry 9.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-5.20, model_b surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': -5.201424375001807, 'model_b': 1887.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38589.59715125, 'model_b': 38600.0}
Metrics: {'utility_surplus': {'model_a': -5.201424375001807, 'model_b': 1887.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 97 completed successfully
Fri Nov  7 05:39:05 PM CET 2025: Completed iteration 97

=== Iteration 98/300 ===
Fri Nov  7 05:39:05 PM CET 2025: Starting company car negotiation iteration 98 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 4.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.65s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1385.00, model_a surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 585.0, 'model_b': 1385.0}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 41770.0, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 585.0, 'model_b': 1385.0}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 98 completed successfully
Fri Nov  7 05:39:28 PM CET 2025: Completed iteration 98

=== Iteration 99/300 ===
Fri Nov  7 05:39:28 PM CET 2025: Starting company car negotiation iteration 99 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.33s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.77s (total since entry 9.41s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38150\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38150\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38150\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,150 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,150 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 99 completed successfully
Fri Nov  7 05:39:59 PM CET 2025: Completed iteration 99

=== Iteration 100/300 ===
Fri Nov  7 05:39:59 PM CET 2025: Starting company car negotiation iteration 100 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬39,400 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39760\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39760\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39760\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39760}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39760}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39760.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬39,760 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38425}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38425}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38425}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38425}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38425}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38425.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,425 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬39,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -405.20 (saved â‚¬-405.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2287.87 (profit â‚¬2287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38189.60, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-405.20, model_a surplus=2287.87
âœ… Calculated utility_surplus: {'model_a': 2287.8745256249967, 'model_b': -405.2014243750018}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38189.59715125, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 2287.8745256249967, 'model_b': -405.2014243750018}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 100 completed successfully
Fri Nov  7 05:40:25 PM CET 2025: Completed iteration 100

=== Iteration 101/300 ===
Fri Nov  7 05:40:25 PM CET 2025: Starting company car negotiation iteration 101 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.65s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,650 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38425\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38425\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38425\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38425}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38425}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38425.0}
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,425 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,425 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38425
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 169.80 (saved â‚¬169.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1712.87 (profit â‚¬1712.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38764.60, seller=38425.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=169.80, model_a surplus=1712.87
âœ… Calculated utility_surplus: {'model_a': 1712.8745256249967, 'model_b': 169.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38764.59715125, 'model_a': 38425.0}
Metrics: {'utility_surplus': {'model_a': 1712.8745256249967, 'model_b': 169.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 101 completed successfully
Fri Nov  7 05:40:55 PM CET 2025: Completed iteration 101

=== Iteration 102/300 ===
Fri Nov  7 05:40:55 PM CET 2025: Starting company car negotiation iteration 102 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 4.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.60s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,250 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38250
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 344.80 (saved â‚¬344.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1537.87 (profit â‚¬1537.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38939.60, seller=38250.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=344.80, model_a surplus=1537.87
âœ… Calculated utility_surplus: {'model_a': 1537.8745256249967, 'model_b': 344.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38939.59715125, 'model_a': 38250.0}
Metrics: {'utility_surplus': {'model_a': 1537.8745256249967, 'model_b': 344.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 102 completed successfully
Fri Nov  7 05:41:25 PM CET 2025: Completed iteration 102

=== Iteration 103/300 ===
Fri Nov  7 05:41:25 PM CET 2025: Starting company car negotiation iteration 103 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.46s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38700\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38700\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38700\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38450\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬36,750 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37950}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37950}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37950}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37950.0}
ğŸ’¡ Player model_a made offer â‚¬37,750 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬37,950 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37950}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37950}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37950}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37950}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37950.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36750.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 36950}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36950}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36950}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36950}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36950.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬37,750 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37750
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 844.80 (saved â‚¬844.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1037.87 (profit â‚¬1037.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39439.60, seller=37750.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=844.80, model_b surplus=1037.87
âœ… Calculated utility_surplus: {'model_a': 844.7985756249982, 'model_b': 1037.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39439.59715125, 'model_b': 37750.0}
Metrics: {'utility_surplus': {'model_a': 844.7985756249982, 'model_b': 1037.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 103 completed successfully
Fri Nov  7 05:41:58 PM CET 2025: Completed iteration 103

=== Iteration 104/300 ===
Fri Nov  7 05:41:58 PM CET 2025: Starting company car negotiation iteration 104 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬40,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1000.00, model_a surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 42000.0, 'model_a': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 104 completed successfully
Fri Nov  7 05:42:18 PM CET 2025: Completed iteration 104

=== Iteration 105/300 ===
Fri Nov  7 05:42:18 PM CET 2025: Starting company car negotiation iteration 105 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=39500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1500.00 (saved â‚¬1500.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 500.00 (profit â‚¬500.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42500.00, seller=39500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1500.00, model_a surplus=500.00
âœ… Calculated utility_surplus: {'model_a': 500.0, 'model_b': 1500.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 42500.0, 'model_a': 39500.0}
Metrics: {'utility_surplus': {'model_a': 500.0, 'model_b': 1500.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 105 completed successfully
Fri Nov  7 05:42:38 PM CET 2025: Completed iteration 105

=== Iteration 106/300 ===
Fri Nov  7 05:42:38 PM CET 2025: Starting company car negotiation iteration 106 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.48s (total since entry 9.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38375\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38375\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38375\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38375}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38375}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38375.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38480}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38480}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38480}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38480}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38480}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38480.0}
ğŸ’¡ Player model_b made offer â‚¬38,375 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,480 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38375}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38375}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38375}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38375}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38375}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38375.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,480 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38480
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 114.80 (saved â‚¬114.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1767.87 (profit â‚¬1767.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38709.60, seller=38480.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=114.80, model_a surplus=1767.87
âœ… Calculated utility_surplus: {'model_a': 1767.8745256249967, 'model_b': 114.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38709.59715125, 'model_a': 38480.0}
Metrics: {'utility_surplus': {'model_a': 1767.8745256249967, 'model_b': 114.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 106 completed successfully
Fri Nov  7 05:43:13 PM CET 2025: Completed iteration 106

=== Iteration 107/300 ===
Fri Nov  7 05:43:13 PM CET 2025: Starting company car negotiation iteration 107 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38520}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38520}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38520}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38520}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38520}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38520.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_b made offer â‚¬38,520 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,520 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38520
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 74.80 (saved â‚¬74.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1807.87 (profit â‚¬1807.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38669.60, seller=38520.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=74.80, model_a surplus=1807.87
âœ… Calculated utility_surplus: {'model_a': 1807.8745256249967, 'model_b': 74.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38669.59715125, 'model_a': 38520.0}
Metrics: {'utility_surplus': {'model_a': 1807.8745256249967, 'model_b': 74.7985756249982}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 107 completed successfully
Fri Nov  7 05:43:42 PM CET 2025: Completed iteration 107

=== Iteration 108/300 ===
Fri Nov  7 05:43:42 PM CET 2025: Starting company car negotiation iteration 108 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 4.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39100.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,100 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,250 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38250
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 344.80 (saved â‚¬344.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1537.87 (profit â‚¬1537.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38939.60, seller=38250.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=344.80, model_b surplus=1537.87
âœ… Calculated utility_surplus: {'model_a': 344.7985756249982, 'model_b': 1537.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38939.59715125, 'model_b': 38250.0}
Metrics: {'utility_surplus': {'model_a': 344.7985756249982, 'model_b': 1537.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 108 completed successfully
Fri Nov  7 05:44:14 PM CET 2025: Completed iteration 108

=== Iteration 109/300 ===
Fri Nov  7 05:44:14 PM CET 2025: Starting company car negotiation iteration 109 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.32s (total since entry 4.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.39s (total since entry 9.01s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 39750\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39750\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39750\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬39,750 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,350 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,350 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,350 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38350
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 244.80 (saved â‚¬244.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1637.87 (profit â‚¬1637.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38839.60, seller=38350.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=244.80, model_b surplus=1637.87
âœ… Calculated utility_surplus: {'model_a': 244.7985756249982, 'model_b': 1637.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38839.59715125, 'model_b': 38350.0}
Metrics: {'utility_surplus': {'model_a': 244.7985756249982, 'model_b': 1637.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 109 completed successfully
Fri Nov  7 05:44:39 PM CET 2025: Completed iteration 109

=== Iteration 110/300 ===
Fri Nov  7 05:44:39 PM CET 2025: Starting company car negotiation iteration 110 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.34s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.47s (total since entry 9.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬37,900 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38480}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38480}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38480}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38480}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38480}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38480.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,480 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 110 completed successfully
Fri Nov  7 05:45:05 PM CET 2025: Completed iteration 110

=== Iteration 111/300 ===
Fri Nov  7 05:45:05 PM CET 2025: Starting company car negotiation iteration 111 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.39s (total since entry 4.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.47s (total since entry 9.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,350 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39100\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39100\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39100\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
ğŸ’¡ Player model_b made offer â‚¬39,100 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,350 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38480}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38480}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38480}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38480}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38480}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38480.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,600 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-5.20, model_b surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': -5.201424375001807, 'model_b': 1887.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38589.59715125, 'model_b': 38600.0}
Metrics: {'utility_surplus': {'model_a': -5.201424375001807, 'model_b': 1887.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 111 completed successfully
Fri Nov  7 05:45:42 PM CET 2025: Completed iteration 111

=== Iteration 112/300 ===
Fri Nov  7 05:45:42 PM CET 2025: Starting company car negotiation iteration 112 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.54s (total since entry 9.17s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬40,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37890}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37890}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37890}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37890}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37890}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37890.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,890 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37990}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37990}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37990}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37990}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37990}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37990.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬37,990 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,250 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38250
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 344.80 (saved â‚¬344.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1537.87 (profit â‚¬1537.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38939.60, seller=38250.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=344.80, model_a surplus=1537.87
âœ… Calculated utility_surplus: {'model_a': 1537.8745256249967, 'model_b': 344.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38939.59715125, 'model_a': 38250.0}
Metrics: {'utility_surplus': {'model_a': 1537.8745256249967, 'model_b': 344.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 112 completed successfully
Fri Nov  7 05:46:11 PM CET 2025: Completed iteration 112

=== Iteration 113/300 ===
Fri Nov  7 05:46:11 PM CET 2025: Starting company car negotiation iteration 113 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.39s (total since entry 4.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.50s (total since entry 9.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38750\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38750\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38750\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37950}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37950}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37950}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37950}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37950.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,950 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,150 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,250 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38250
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 344.80 (saved â‚¬344.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1537.87 (profit â‚¬1537.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38939.60, seller=38250.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=344.80, model_a surplus=1537.87
âœ… Calculated utility_surplus: {'model_a': 1537.8745256249967, 'model_b': 344.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38939.59715125, 'model_a': 38250.0}
Metrics: {'utility_surplus': {'model_a': 1537.8745256249967, 'model_b': 344.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 113 completed successfully
Fri Nov  7 05:46:43 PM CET 2025: Completed iteration 113

=== Iteration 114/300 ===
Fri Nov  7 05:46:43 PM CET 2025: Starting company car negotiation iteration 114 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.32s (total since entry 4.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.42s (total since entry 9.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38450\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=144.80, model_b surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38739.59715125, 'model_b': 38450.0}
Metrics: {'utility_surplus': {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 114 completed successfully
Fri Nov  7 05:47:08 PM CET 2025: Completed iteration 114

=== Iteration 115/300 ===
Fri Nov  7 05:47:08 PM CET 2025: Starting company car negotiation iteration 115 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.99s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 37500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 37500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 37500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬39,100 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38425\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38425\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38425\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38425}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38425}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38425.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,425 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 594.80 (saved â‚¬594.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1287.87 (profit â‚¬1287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39189.60, seller=38000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=594.80, model_a surplus=1287.87
âœ… Calculated utility_surplus: {'model_a': 1287.8745256249967, 'model_b': 594.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39189.59715125, 'model_a': 38000.0}
Metrics: {'utility_surplus': {'model_a': 1287.8745256249967, 'model_b': 594.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 115 completed successfully
Fri Nov  7 05:47:31 PM CET 2025: Completed iteration 115

=== Iteration 116/300 ===
Fri Nov  7 05:47:31 PM CET 2025: Starting company car negotiation iteration 116 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.33s (total since entry 5.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 10.84s (total since entry 11.47s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39150}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39150}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39150}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39150}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39150.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬39,150 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38480}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38480}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38480}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38480}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38480}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38480.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,480 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 38490\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38490\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38490\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38480}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38480}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38480}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38480}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38480}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38480.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,480 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38480
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 114.80 (saved â‚¬114.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1767.87 (profit â‚¬1767.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38709.60, seller=38480.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=114.80, model_b surplus=1767.87
âœ… Calculated utility_surplus: {'model_a': 114.7985756249982, 'model_b': 1767.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38709.59715125, 'model_b': 38480.0}
Metrics: {'utility_surplus': {'model_a': 114.7985756249982, 'model_b': 1767.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 116 completed successfully
Fri Nov  7 05:48:04 PM CET 2025: Completed iteration 116

=== Iteration 117/300 ===
Fri Nov  7 05:48:04 PM CET 2025: Starting company car negotiation iteration 117 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.50s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38425}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38425}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38425}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38425}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38425}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38425.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38650\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38650\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38650\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ’¡ Player model_b made offer â‚¬38,425 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,650 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,425 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38425
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 169.80 (saved â‚¬169.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1712.87 (profit â‚¬1712.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38764.60, seller=38425.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=169.80, model_a surplus=1712.87
âœ… Calculated utility_surplus: {'model_a': 1712.8745256249967, 'model_b': 169.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38764.59715125, 'model_a': 38425.0}
Metrics: {'utility_surplus': {'model_a': 1712.8745256249967, 'model_b': 169.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 117 completed successfully
Fri Nov  7 05:48:38 PM CET 2025: Completed iteration 117

=== Iteration 118/300 ===
Fri Nov  7 05:48:38 PM CET 2025: Starting company car negotiation iteration 118 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.33s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38475\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38475\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38475\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38475}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38475}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38475.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,475 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,475 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38475
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 119.80 (saved â‚¬119.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1762.87 (profit â‚¬1762.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38714.60, seller=38475.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=119.80, model_a surplus=1762.87
âœ… Calculated utility_surplus: {'model_a': 1762.8745256249967, 'model_b': 119.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38714.59715125, 'model_a': 38475.0}
Metrics: {'utility_surplus': {'model_a': 1762.8745256249967, 'model_b': 119.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 118 completed successfully
Fri Nov  7 05:49:07 PM CET 2025: Completed iteration 118

=== Iteration 119/300 ===
Fri Nov  7 05:49:07 PM CET 2025: Starting company car negotiation iteration 119 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.33s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.60s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.43s (total since entry 9.03s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 885.00 (saved â‚¬885.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1085.00 (profit â‚¬1085.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41270.00, seller=39500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=885.00, model_b surplus=1085.00
âœ… Calculated utility_surplus: {'model_a': 885.0, 'model_b': 1085.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41270.0, 'model_b': 39500.0}
Metrics: {'utility_surplus': {'model_a': 885.0, 'model_b': 1085.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 119 completed successfully
Fri Nov  7 05:49:29 PM CET 2025: Completed iteration 119

=== Iteration 120/300 ===
Fri Nov  7 05:49:29 PM CET 2025: Starting company car negotiation iteration 120 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.34s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.49s (total since entry 9.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=144.80, model_b surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38739.59715125, 'model_b': 38450.0}
Metrics: {'utility_surplus': {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 120 completed successfully
Fri Nov  7 05:49:59 PM CET 2025: Completed iteration 120

=== Iteration 121/300 ===
Fri Nov  7 05:49:59 PM CET 2025: Starting company car negotiation iteration 121 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬40,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1000.00, model_a surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 42000.0, 'model_a': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 121 completed successfully
Fri Nov  7 05:50:21 PM CET 2025: Completed iteration 121

=== Iteration 122/300 ===
Fri Nov  7 05:50:21 PM CET 2025: Starting company car negotiation iteration 122 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 5.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.67s (total since entry 9.30s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,300 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39100\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39100\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39100\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
ğŸ’¡ Player model_b made offer â‚¬39,100 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,900 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 122 completed successfully
Fri Nov  7 05:50:50 PM CET 2025: Completed iteration 122

=== Iteration 123/300 ===
Fri Nov  7 05:50:50 PM CET 2025: Starting company car negotiation iteration 123 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.31s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.48s (total since entry 9.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,100 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38450\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38450\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38450\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,450 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 732.54 (saved â‚¬732.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1178.81 (profit â‚¬1178.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39915.07, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=732.54, model_a surplus=1178.81
âœ… Calculated utility_surplus: {'model_a': 1178.8066250000047, 'model_b': 732.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39915.07324999999, 'model_a': 38450.0}
Metrics: {'utility_surplus': {'model_a': 1178.8066250000047, 'model_b': 732.5366249999934}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 123 completed successfully
Fri Nov  7 05:51:21 PM CET 2025: Completed iteration 123

=== Iteration 124/300 ===
Fri Nov  7 05:51:21 PM CET 2025: Starting company car negotiation iteration 124 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.30s (total since entry 5.01s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.47s (total since entry 9.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38450\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,450 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1329.22 (saved â‚¬1329.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 611.22 (profit â‚¬611.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41108.45, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1329.22, model_a surplus=611.22
âœ… Calculated utility_surplus: {'model_a': 611.2249999999985, 'model_b': 1329.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 41108.45, 'model_a': 38450.0}
Metrics: {'utility_surplus': {'model_a': 611.2249999999985, 'model_b': 1329.2249999999985}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 124 completed successfully
Fri Nov  7 05:51:51 PM CET 2025: Completed iteration 124

=== Iteration 125/300 ===
Fri Nov  7 05:51:51 PM CET 2025: Starting company car negotiation iteration 125 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.47s (total since entry 9.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,100 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,100 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,100 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38100
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 494.80 (saved â‚¬494.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1387.87 (profit â‚¬1387.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39089.60, seller=38100.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=494.80, model_b surplus=1387.87
âœ… Calculated utility_surplus: {'model_a': 494.7985756249982, 'model_b': 1387.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39089.59715125, 'model_b': 38100.0}
Metrics: {'utility_surplus': {'model_a': 494.7985756249982, 'model_b': 1387.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 125 completed successfully
Fri Nov  7 05:52:17 PM CET 2025: Completed iteration 125

=== Iteration 126/300 ===
Fri Nov  7 05:52:17 PM CET 2025: Starting company car negotiation iteration 126 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,300 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 25.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 25.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 126 completed successfully
Fri Nov  7 05:52:49 PM CET 2025: Completed iteration 126

=== Iteration 127/300 ===
Fri Nov  7 05:52:49 PM CET 2025: Starting company car negotiation iteration 127 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.46s (total since entry 9.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬40,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1000.00, model_b surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 42000.0, 'model_b': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 127 completed successfully
Fri Nov  7 05:53:09 PM CET 2025: Completed iteration 127

=== Iteration 128/300 ===
Fri Nov  7 05:53:09 PM CET 2025: Starting company car negotiation iteration 128 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.65s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.41s (total since entry 9.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38550\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38550\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38550\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38550}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38550}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38550.0}
ğŸ’¡ Player model_a made offer â‚¬37,800 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,550 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=144.80, model_b surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38739.59715125, 'model_b': 38450.0}
Metrics: {'utility_surplus': {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 128 completed successfully
Fri Nov  7 05:53:37 PM CET 2025: Completed iteration 128

=== Iteration 129/300 ===
Fri Nov  7 05:53:37 PM CET 2025: Starting company car negotiation iteration 129 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.65s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 129 completed successfully
Fri Nov  7 05:54:09 PM CET 2025: Completed iteration 129

=== Iteration 130/300 ===
Fri Nov  7 05:54:09 PM CET 2025: Starting company car negotiation iteration 130 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 4.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.50s (total since entry 9.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38376\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38376\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38376\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38376}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38376}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38376.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,376 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬37,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1094.80 (saved â‚¬1094.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 787.87 (profit â‚¬787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39689.60, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1094.80, model_b surplus=787.87
âœ… Calculated utility_surplus: {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39689.59715125, 'model_b': 37500.0}
Metrics: {'utility_surplus': {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 130 completed successfully
Fri Nov  7 05:54:33 PM CET 2025: Completed iteration 130

=== Iteration 131/300 ===
Fri Nov  7 05:54:33 PM CET 2025: Starting company car negotiation iteration 131 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38480}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38480}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38480}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38480}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38480}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38480.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,480 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37990}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37990}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37990}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37990}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37990}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37990.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,990 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38450\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37950}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37950}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37950}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37950}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37950.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=144.80, model_b surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38739.59715125, 'model_b': 38450.0}
Metrics: {'utility_surplus': {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 131 completed successfully
Fri Nov  7 05:55:10 PM CET 2025: Completed iteration 131

=== Iteration 132/300 ===
Fri Nov  7 05:55:10 PM CET 2025: Starting company car negotiation iteration 132 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.34s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.65s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.90s (total since entry 9.55s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 37950}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37950}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37950}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37950}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37950.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39100\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39100\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39100\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39100.0}
ğŸ’¡ Player model_a made offer â‚¬37,950 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,100 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38480}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38480}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38480}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38480}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38480}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38480.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,480 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 132 completed successfully
Fri Nov  7 05:55:38 PM CET 2025: Completed iteration 132

=== Iteration 133/300 ===
Fri Nov  7 05:55:38 PM CET 2025: Starting company car negotiation iteration 133 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.32s (total since entry 4.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.64s (total since entry 9.26s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39200\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39200\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39200\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,600 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1785.00 (saved â‚¬1785.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 185.00 (profit â‚¬185.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42170.00, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1785.00, model_b surplus=185.00
âœ… Calculated utility_surplus: {'model_a': 1785.0, 'model_b': 185.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 42170.0, 'model_b': 38600.0}
Metrics: {'utility_surplus': {'model_a': 1785.0, 'model_b': 185.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 133 completed successfully
Fri Nov  7 05:56:04 PM CET 2025: Completed iteration 133

=== Iteration 134/300 ===
Fri Nov  7 05:56:04 PM CET 2025: Starting company car negotiation iteration 134 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.43s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 594.80 (saved â‚¬594.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1287.87 (profit â‚¬1287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39189.60, seller=38000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=594.80, model_b surplus=1287.87
âœ… Calculated utility_surplus: {'model_a': 594.7985756249982, 'model_b': 1287.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39189.59715125, 'model_b': 38000.0}
Metrics: {'utility_surplus': {'model_a': 594.7985756249982, 'model_b': 1287.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 134 completed successfully
Fri Nov  7 05:56:28 PM CET 2025: Completed iteration 134

=== Iteration 135/300 ===
Fri Nov  7 05:56:28 PM CET 2025: Starting company car negotiation iteration 135 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.34s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.65s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,300 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38200\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38200\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38200\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_a made offer â‚¬38,350 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,350 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38350
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 244.80 (saved â‚¬244.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1637.87 (profit â‚¬1637.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38839.60, seller=38350.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=244.80, model_a surplus=1637.87
âœ… Calculated utility_surplus: {'model_a': 1637.8745256249967, 'model_b': 244.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38839.59715125, 'model_a': 38350.0}
Metrics: {'utility_surplus': {'model_a': 1637.8745256249967, 'model_b': 244.7985756249982}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 135 completed successfully
Fri Nov  7 05:56:56 PM CET 2025: Completed iteration 135

=== Iteration 136/300 ===
Fri Nov  7 05:56:56 PM CET 2025: Starting company car negotiation iteration 136 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.34s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.47s (total since entry 9.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬40,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1000.00, model_a surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 42000.0, 'model_a': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 136 completed successfully
Fri Nov  7 05:57:19 PM CET 2025: Completed iteration 136

=== Iteration 137/300 ===
Fri Nov  7 05:57:19 PM CET 2025: Starting company car negotiation iteration 137 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.33s (total since entry 5.03s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.42s (total since entry 9.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38779\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38779\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38779\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38779}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38779}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38779.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,779 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,600 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 582.54 (saved â‚¬582.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1328.81 (profit â‚¬1328.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39765.07, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=582.54, model_a surplus=1328.81
âœ… Calculated utility_surplus: {'model_a': 1328.8066250000047, 'model_b': 582.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39765.07324999999, 'model_a': 38600.0}
Metrics: {'utility_surplus': {'model_a': 1328.8066250000047, 'model_b': 582.5366249999934}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 137 completed successfully
Fri Nov  7 05:57:45 PM CET 2025: Completed iteration 137

=== Iteration 138/300 ===
Fri Nov  7 05:57:45 PM CET 2025: Starting company car negotiation iteration 138 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.34s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.42s (total since entry 9.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38750\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38750\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38750\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_a made offer â‚¬38,490 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38300\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38300\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38300\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,300 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38900.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,400 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 194.80 (saved â‚¬194.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1687.87 (profit â‚¬1687.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38789.60, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=194.80, model_a surplus=1687.87
âœ… Calculated utility_surplus: {'model_a': 1687.8745256249967, 'model_b': 194.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38789.59715125, 'model_a': 38400.0}
Metrics: {'utility_surplus': {'model_a': 1687.8745256249967, 'model_b': 194.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 138 completed successfully
Fri Nov  7 05:58:18 PM CET 2025: Completed iteration 138

=== Iteration 139/300 ===
Fri Nov  7 05:58:18 PM CET 2025: Starting company car negotiation iteration 139 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.34s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.53s (total since entry 9.14s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,300 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38200\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38200\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38200\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,200 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 982.54 (saved â‚¬982.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 928.81 (profit â‚¬928.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40165.07, seller=38200.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=982.54, model_a surplus=928.81
âœ… Calculated utility_surplus: {'model_a': 928.8066250000047, 'model_b': 982.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 40165.07324999999, 'model_a': 38200.0}
Metrics: {'utility_surplus': {'model_a': 928.8066250000047, 'model_b': 982.5366249999934}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 139 completed successfully
Fri Nov  7 05:58:46 PM CET 2025: Completed iteration 139

=== Iteration 140/300 ===
Fri Nov  7 05:58:46 PM CET 2025: Starting company car negotiation iteration 140 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.42s (total since entry 9.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,150 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,150 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38150
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 444.80 (saved â‚¬444.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1437.87 (profit â‚¬1437.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39039.60, seller=38150.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=444.80, model_b surplus=1437.87
âœ… Calculated utility_surplus: {'model_a': 444.7985756249982, 'model_b': 1437.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39039.59715125, 'model_b': 38150.0}
Metrics: {'utility_surplus': {'model_a': 444.7985756249982, 'model_b': 1437.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 140 completed successfully
Fri Nov  7 05:59:12 PM CET 2025: Completed iteration 140

=== Iteration 141/300 ===
Fri Nov  7 05:59:12 PM CET 2025: Starting company car negotiation iteration 141 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.33s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.58s (total since entry 9.22s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37950}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37950}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37950}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37950}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37950.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,950 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 141 completed successfully
Fri Nov  7 05:59:44 PM CET 2025: Completed iteration 141

=== Iteration 142/300 ===
Fri Nov  7 05:59:44 PM CET 2025: Starting company car negotiation iteration 142 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.33s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.65s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37990}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37990}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37990}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37990}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37990}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37990.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,990 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬37,800 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37650}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37650}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37650}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37650}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37650.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬37,800 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37800
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 794.80 (saved â‚¬794.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1087.87 (profit â‚¬1087.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39389.60, seller=37800.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=794.80, model_b surplus=1087.87
âœ… Calculated utility_surplus: {'model_a': 794.7985756249982, 'model_b': 1087.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39389.59715125, 'model_b': 37800.0}
Metrics: {'utility_surplus': {'model_a': 794.7985756249982, 'model_b': 1087.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 142 completed successfully
Fri Nov  7 06:00:14 PM CET 2025: Completed iteration 142

=== Iteration 143/300 ===
Fri Nov  7 06:00:14 PM CET 2025: Starting company car negotiation iteration 143 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.43s (total since entry 9.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,400 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1379.22 (saved â‚¬1379.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 561.22 (profit â‚¬561.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41158.45, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1379.22, model_a surplus=561.22
âœ… Calculated utility_surplus: {'model_a': 561.2249999999985, 'model_b': 1379.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 33.33333333333333, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 41158.45, 'model_a': 38400.0}
Metrics: {'utility_surplus': {'model_a': 561.2249999999985, 'model_b': 1379.2249999999985}, 'risk_minimization': {'model_a': 33.33333333333333, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 143 completed successfully
Fri Nov  7 06:00:39 PM CET 2025: Completed iteration 143

=== Iteration 144/300 ===
Fri Nov  7 06:00:39 PM CET 2025: Starting company car negotiation iteration 144 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.60s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.31s (total since entry 4.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.41s (total since entry 9.04s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38700\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38700\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38700\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 37500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 37500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 37500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬37,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1094.80 (saved â‚¬1094.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 787.87 (profit â‚¬787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39689.60, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1094.80, model_b surplus=787.87
âœ… Calculated utility_surplus: {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39689.59715125, 'model_b': 37500.0}
Metrics: {'utility_surplus': {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 144 completed successfully
Fri Nov  7 06:01:07 PM CET 2025: Completed iteration 144

=== Iteration 145/300 ===
Fri Nov  7 06:01:07 PM CET 2025: Starting company car negotiation iteration 145 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.40s (total since entry 9.02s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,200 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 394.80 (saved â‚¬394.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1487.87 (profit â‚¬1487.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38989.60, seller=38200.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=394.80, model_a surplus=1487.87
âœ… Calculated utility_surplus: {'model_a': 1487.8745256249967, 'model_b': 394.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 25.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38989.59715125, 'model_a': 38200.0}
Metrics: {'utility_surplus': {'model_a': 1487.8745256249967, 'model_b': 394.7985756249982}, 'risk_minimization': {'model_a': 25.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 145 completed successfully
Fri Nov  7 06:01:39 PM CET 2025: Completed iteration 145

=== Iteration 146/300 ===
Fri Nov  7 06:01:39 PM CET 2025: Starting company car negotiation iteration 146 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.59s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.51s (total since entry 5.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.78s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.41s (total since entry 9.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬40,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,650 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 146 completed successfully
Fri Nov  7 06:02:18 PM CET 2025: Completed iteration 146

=== Iteration 147/300 ===
Fri Nov  7 06:02:18 PM CET 2025: Starting company car negotiation iteration 147 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.48s (total since entry 9.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,490 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38480}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38480}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38480}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38480}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38480}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38480.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,480 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,480 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38480
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 114.80 (saved â‚¬114.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1767.87 (profit â‚¬1767.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38709.60, seller=38480.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=114.80, model_b surplus=1767.87
âœ… Calculated utility_surplus: {'model_a': 114.7985756249982, 'model_b': 1767.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38709.59715125, 'model_b': 38480.0}
Metrics: {'utility_surplus': {'model_a': 114.7985756249982, 'model_b': 1767.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 147 completed successfully
Fri Nov  7 06:02:48 PM CET 2025: Completed iteration 147

=== Iteration 148/300 ===
Fri Nov  7 06:02:48 PM CET 2025: Starting company car negotiation iteration 148 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.60s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬40,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1000.00, model_a surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 42000.0, 'model_a': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 148 completed successfully
Fri Nov  7 06:03:07 PM CET 2025: Completed iteration 148

=== Iteration 149/300 ===
Fri Nov  7 06:03:07 PM CET 2025: Starting company car negotiation iteration 149 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.47s (total since entry 9.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬37,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 594.80 (saved â‚¬594.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1287.87 (profit â‚¬1287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39189.60, seller=38000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=594.80, model_b surplus=1287.87
âœ… Calculated utility_surplus: {'model_a': 594.7985756249982, 'model_b': 1287.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39189.59715125, 'model_b': 38000.0}
Metrics: {'utility_surplus': {'model_a': 594.7985756249982, 'model_b': 1287.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 149 completed successfully
Fri Nov  7 06:03:34 PM CET 2025: Completed iteration 149

=== Iteration 150/300 ===
Fri Nov  7 06:03:34 PM CET 2025: Starting company car negotiation iteration 150 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.47s (total since entry 9.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38275}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38275}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38275}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38275}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38275}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38275.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,275 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-5.20, model_a surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38589.59715125, 'model_a': 38600.0}
Metrics: {'utility_surplus': {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 150 completed successfully
Fri Nov  7 06:04:10 PM CET 2025: Completed iteration 150

=== Iteration 151/300 ===
Fri Nov  7 06:04:10 PM CET 2025: Starting company car negotiation iteration 151 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.50s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.65s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.43s (total since entry 9.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 41000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 41000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 41000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ’¡ Player model_a made offer â‚¬38,100 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬41,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38800\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38800\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38800\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38800.0}
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,800 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,200 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 394.80 (saved â‚¬394.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1487.87 (profit â‚¬1487.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38989.60, seller=38200.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=394.80, model_b surplus=1487.87
âœ… Calculated utility_surplus: {'model_a': 394.7985756249982, 'model_b': 1487.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38989.59715125, 'model_b': 38200.0}
Metrics: {'utility_surplus': {'model_a': 394.7985756249982, 'model_b': 1487.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 151 completed successfully
Fri Nov  7 06:04:41 PM CET 2025: Completed iteration 151

=== Iteration 152/300 ===
Fri Nov  7 06:04:41 PM CET 2025: Starting company car negotiation iteration 152 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.38s (total since entry 9.02s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬37,800 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬37,800 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37950}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37950}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37950}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37950}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37950.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬37,800 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37800
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 794.80 (saved â‚¬794.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1087.87 (profit â‚¬1087.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39389.60, seller=37800.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=794.80, model_b surplus=1087.87
âœ… Calculated utility_surplus: {'model_a': 794.7985756249982, 'model_b': 1087.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39389.59715125, 'model_b': 37800.0}
Metrics: {'utility_surplus': {'model_a': 794.7985756249982, 'model_b': 1087.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 152 completed successfully
Fri Nov  7 06:05:08 PM CET 2025: Completed iteration 152

=== Iteration 153/300 ===
Fri Nov  7 06:05:08 PM CET 2025: Starting company car negotiation iteration 153 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.46s (total since entry 9.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1385.00, model_b surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 1385.0, 'model_b': 585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41770.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1385.0, 'model_b': 585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 153 completed successfully
Fri Nov  7 06:05:34 PM CET 2025: Completed iteration 153

=== Iteration 154/300 ===
Fri Nov  7 06:05:34 PM CET 2025: Starting company car negotiation iteration 154 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.33s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.43s (total since entry 9.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬40,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,300 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,200 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 394.80 (saved â‚¬394.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1487.87 (profit â‚¬1487.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38989.60, seller=38200.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=394.80, model_a surplus=1487.87
âœ… Calculated utility_surplus: {'model_a': 1487.8745256249967, 'model_b': 394.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38989.59715125, 'model_a': 38200.0}
Metrics: {'utility_surplus': {'model_a': 1487.8745256249967, 'model_b': 394.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 154 completed successfully
Fri Nov  7 06:06:02 PM CET 2025: Completed iteration 154

=== Iteration 155/300 ===
Fri Nov  7 06:06:02 PM CET 2025: Starting company car negotiation iteration 155 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.34s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.42s (total since entry 9.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 155 completed successfully
Fri Nov  7 06:06:37 PM CET 2025: Completed iteration 155

=== Iteration 156/300 ===
Fri Nov  7 06:06:37 PM CET 2025: Starting company car negotiation iteration 156 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.52s (total since entry 5.04s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.79s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38765\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38765\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38765\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38765}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38765}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38765.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_b made offer â‚¬38,765 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,350 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38325\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38325\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38325\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38325}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38325}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38325.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,325 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=144.80, model_a surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 1737.8745256249967, 'model_b': 144.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38739.59715125, 'model_a': 38450.0}
Metrics: {'utility_surplus': {'model_a': 1737.8745256249967, 'model_b': 144.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 156 completed successfully
Fri Nov  7 06:07:06 PM CET 2025: Completed iteration 156

=== Iteration 157/300 ===
Fri Nov  7 06:07:06 PM CET 2025: Starting company car negotiation iteration 157 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.43s (total since entry 9.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,200 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 394.80 (saved â‚¬394.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1487.87 (profit â‚¬1487.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38989.60, seller=38200.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=394.80, model_b surplus=1487.87
âœ… Calculated utility_surplus: {'model_a': 394.7985756249982, 'model_b': 1487.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38989.59715125, 'model_b': 38200.0}
Metrics: {'utility_surplus': {'model_a': 394.7985756249982, 'model_b': 1487.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 157 completed successfully
Fri Nov  7 06:07:40 PM CET 2025: Completed iteration 157

=== Iteration 158/300 ===
Fri Nov  7 06:07:40 PM CET 2025: Starting company car negotiation iteration 158 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.65s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.41s (total since entry 9.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,100 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=682.54, model_b surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39865.07324999999, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 158 completed successfully
Fri Nov  7 06:08:07 PM CET 2025: Completed iteration 158

=== Iteration 159/300 ===
Fri Nov  7 06:08:07 PM CET 2025: Starting company car negotiation iteration 159 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.33s (total since entry 5.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.43s (total since entry 9.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38750\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38750\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38750\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39450.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬39,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬37,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1094.80 (saved â‚¬1094.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 787.87 (profit â‚¬787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39689.60, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1094.80, model_a surplus=787.87
âœ… Calculated utility_surplus: {'model_a': 787.8745256249967, 'model_b': 1094.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39689.59715125, 'model_a': 37500.0}
Metrics: {'utility_surplus': {'model_a': 787.8745256249967, 'model_b': 1094.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 159 completed successfully
Fri Nov  7 06:08:38 PM CET 2025: Completed iteration 159

=== Iteration 160/300 ===
Fri Nov  7 06:08:38 PM CET 2025: Starting company car negotiation iteration 160 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.66s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,150 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38550}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38550}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38550}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38550}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38550}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38550.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,550 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38550}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38550}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38550}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38550}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38550}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38550.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,550 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,550 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38550
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 44.80 (saved â‚¬44.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1837.87 (profit â‚¬1837.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38639.60, seller=38550.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=44.80, model_a surplus=1837.87
âœ… Calculated utility_surplus: {'model_a': 1837.8745256249967, 'model_b': 44.79857562499819}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38639.59715125, 'model_a': 38550.0}
Metrics: {'utility_surplus': {'model_a': 1837.8745256249967, 'model_b': 44.79857562499819}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 160 completed successfully
Fri Nov  7 06:09:04 PM CET 2025: Completed iteration 160

=== Iteration 161/300 ===
Fri Nov  7 06:09:04 PM CET 2025: Starting company car negotiation iteration 161 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.34s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.42s (total since entry 9.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 35000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 35000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 35000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 35000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 35000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 35000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬35,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38401}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38401}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38401}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38401}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38401}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38401.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,401 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,400 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 194.80 (saved â‚¬194.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1687.87 (profit â‚¬1687.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38789.60, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=194.80, model_a surplus=1687.87
âœ… Calculated utility_surplus: {'model_a': 1687.8745256249967, 'model_b': 194.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38789.59715125, 'model_a': 38400.0}
Metrics: {'utility_surplus': {'model_a': 1687.8745256249967, 'model_b': 194.7985756249982}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 161 completed successfully
Fri Nov  7 06:09:31 PM CET 2025: Completed iteration 161

=== Iteration 162/300 ===
Fri Nov  7 06:09:31 PM CET 2025: Starting company car negotiation iteration 162 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38200\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38200\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38200\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=144.80, model_a surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 1737.8745256249967, 'model_b': 144.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38739.59715125, 'model_a': 38450.0}
Metrics: {'utility_surplus': {'model_a': 1737.8745256249967, 'model_b': 144.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 162 completed successfully
Fri Nov  7 06:09:59 PM CET 2025: Completed iteration 162

=== Iteration 163/300 ===
Fri Nov  7 06:09:59 PM CET 2025: Starting company car negotiation iteration 163 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.67s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,400 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 194.80 (saved â‚¬194.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1687.87 (profit â‚¬1687.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38789.60, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=194.80, model_a surplus=1687.87
âœ… Calculated utility_surplus: {'model_a': 1687.8745256249967, 'model_b': 194.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38789.59715125, 'model_a': 38400.0}
Metrics: {'utility_surplus': {'model_a': 1687.8745256249967, 'model_b': 194.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 163 completed successfully
Fri Nov  7 06:10:30 PM CET 2025: Completed iteration 163

=== Iteration 164/300 ===
Fri Nov  7 06:10:30 PM CET 2025: Starting company car negotiation iteration 164 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.40s (total since entry 9.03s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38765\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38765\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38765\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38765}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38765}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38765.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39250.0}
ğŸ’¡ Player model_b made offer â‚¬38,765 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-5.20, model_a surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38589.59715125, 'model_a': 38600.0}
Metrics: {'utility_surplus': {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 164 completed successfully
Fri Nov  7 06:11:04 PM CET 2025: Completed iteration 164

=== Iteration 165/300 ===
Fri Nov  7 06:11:04 PM CET 2025: Starting company car negotiation iteration 165 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.33s (total since entry 4.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.40s (total since entry 9.01s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39999}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39999}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39999}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39999}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39999}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39999.0}
ğŸ’¡ Player model_b made offer â‚¬40,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,999 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37839}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37839}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37839}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37839}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37839}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37839.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,839 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 165 completed successfully
Fri Nov  7 06:11:35 PM CET 2025: Completed iteration 165

=== Iteration 166/300 ===
Fri Nov  7 06:11:35 PM CET 2025: Starting company car negotiation iteration 166 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.32s (total since entry 4.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.39s (total since entry 9.02s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1279.22 (saved â‚¬1279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 661.22 (profit â‚¬661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41058.45, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1279.22, model_b surplus=661.22
âœ… Calculated utility_surplus: {'model_a': 1279.2249999999985, 'model_b': 661.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 41058.45, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1279.2249999999985, 'model_b': 661.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 166 completed successfully
Fri Nov  7 06:11:58 PM CET 2025: Completed iteration 166

=== Iteration 167/300 ===
Fri Nov  7 06:11:58 PM CET 2025: Starting company car negotiation iteration 167 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.40s (total since entry 9.02s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38480}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38480}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38480}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38480}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38480}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38480.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,480 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38480}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38480}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38480}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38480}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38480}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38480.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,480 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 167 completed successfully
Fri Nov  7 06:12:28 PM CET 2025: Completed iteration 167

=== Iteration 168/300 ===
Fri Nov  7 06:12:28 PM CET 2025: Starting company car negotiation iteration 168 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.33s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.39s (total since entry 9.03s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,490 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39200\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39200\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39200\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 37950}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37950}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37950}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37950}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37950.0}
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,950 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37950}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37950}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37950}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37950}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37950.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37850}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37850}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37850}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37850}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37850}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37850.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=144.80, model_b surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38739.59715125, 'model_b': 38450.0}
Metrics: {'utility_surplus': {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 168 completed successfully
Fri Nov  7 06:13:02 PM CET 2025: Completed iteration 168

=== Iteration 169/300 ===
Fri Nov  7 06:13:02 PM CET 2025: Starting company car negotiation iteration 169 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.32s (total since entry 4.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.65s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.40s (total since entry 9.04s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38550\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38550\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38550\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38550}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38550}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38550.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,550 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=144.80, model_b surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38739.59715125, 'model_b': 38450.0}
Metrics: {'utility_surplus': {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 169 completed successfully
Fri Nov  7 06:13:30 PM CET 2025: Completed iteration 169

=== Iteration 170/300 ===
Fri Nov  7 06:13:30 PM CET 2025: Starting company car negotiation iteration 170 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.50s (total since entry 9.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38450\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬37,800 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 37900\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 37900\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 37900\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ’¡ Player model_b made offer â‚¬37,900 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,150 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬37,900 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37900
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 694.80 (saved â‚¬694.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1187.87 (profit â‚¬1187.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39289.60, seller=37900.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=694.80, model_a surplus=1187.87
âœ… Calculated utility_surplus: {'model_a': 1187.8745256249967, 'model_b': 694.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39289.59715125, 'model_a': 37900.0}
Metrics: {'utility_surplus': {'model_a': 1187.8745256249967, 'model_b': 694.7985756249982}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 170 completed successfully
Fri Nov  7 06:14:01 PM CET 2025: Completed iteration 170

=== Iteration 171/300 ===
Fri Nov  7 06:14:01 PM CET 2025: Starting company car negotiation iteration 171 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.49s (total since entry 9.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,400 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 194.80 (saved â‚¬194.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1687.87 (profit â‚¬1687.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38789.60, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=194.80, model_b surplus=1687.87
âœ… Calculated utility_surplus: {'model_a': 194.7985756249982, 'model_b': 1687.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38789.59715125, 'model_b': 38400.0}
Metrics: {'utility_surplus': {'model_a': 194.7985756249982, 'model_b': 1687.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 171 completed successfully
Fri Nov  7 06:14:28 PM CET 2025: Completed iteration 171

=== Iteration 172/300 ===
Fri Nov  7 06:14:28 PM CET 2025: Starting company car negotiation iteration 172 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.41s (total since entry 4.94s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.65s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.50s (total since entry 9.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬40,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1000.00, model_a surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 42000.0, 'model_a': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 172 completed successfully
Fri Nov  7 06:14:48 PM CET 2025: Completed iteration 172

=== Iteration 173/300 ===
Fri Nov  7 06:14:48 PM CET 2025: Starting company car negotiation iteration 173 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.66s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.53s (total since entry 9.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38495}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38495}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38495}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38495}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38495}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38495.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,400 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 194.80 (saved â‚¬194.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1687.87 (profit â‚¬1687.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38789.60, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=194.80, model_b surplus=1687.87
âœ… Calculated utility_surplus: {'model_a': 194.7985756249982, 'model_b': 1687.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38789.59715125, 'model_b': 38400.0}
Metrics: {'utility_surplus': {'model_a': 194.7985756249982, 'model_b': 1687.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 173 completed successfully
Fri Nov  7 06:15:16 PM CET 2025: Completed iteration 173

=== Iteration 174/300 ===
Fri Nov  7 06:15:16 PM CET 2025: Starting company car negotiation iteration 174 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.51s (total since entry 9.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38510}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38510}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38510}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38510}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38510}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38510.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,510 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37890}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37890}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37890}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37890}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37890}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37890.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,890 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", role": "ROLE A", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", role": "ROLE A", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", role": "ROLE A", "price": 38000}'
âš ï¸ [DEBUG] [model_a] JSON decode error for start match: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_a] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 38000}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_a] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 38000}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_a] Extracted JSON decode error: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âœ… [DEBUG] [model_a] Manually extracted action: {'type': 'offer'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38200\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38200\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38200\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,200 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 982.54 (saved â‚¬982.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 928.81 (profit â‚¬928.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40165.07, seller=38200.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=982.54, model_a surplus=928.81
âœ… Calculated utility_surplus: {'model_a': 928.8066250000047, 'model_b': 982.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 40165.07324999999, 'model_a': 38200.0}
Metrics: {'utility_surplus': {'model_a': 928.8066250000047, 'model_b': 982.5366249999934}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 174 completed successfully
Fri Nov  7 06:15:46 PM CET 2025: Completed iteration 174

=== Iteration 175/300 ===
Fri Nov  7 06:15:46 PM CET 2025: Starting company car negotiation iteration 175 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.56s (total since entry 9.28s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37990}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37990}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37990}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37990}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37990}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37990.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬37,990 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬37,990 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37990
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 604.80 (saved â‚¬604.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1277.87 (profit â‚¬1277.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39199.60, seller=37990.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=604.80, model_b surplus=1277.87
âœ… Calculated utility_surplus: {'model_a': 604.7985756249982, 'model_b': 1277.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39199.59715125, 'model_b': 37990.0}
Metrics: {'utility_surplus': {'model_a': 604.7985756249982, 'model_b': 1277.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 175 completed successfully
Fri Nov  7 06:16:11 PM CET 2025: Completed iteration 175

=== Iteration 176/300 ===
Fri Nov  7 06:16:11 PM CET 2025: Starting company car negotiation iteration 176 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.60s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.48s (total since entry 9.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,300 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,300 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38300
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 294.80 (saved â‚¬294.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1587.87 (profit â‚¬1587.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38889.60, seller=38300.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=294.80, model_b surplus=1587.87
âœ… Calculated utility_surplus: {'model_a': 294.7985756249982, 'model_b': 1587.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38889.59715125, 'model_b': 38300.0}
Metrics: {'utility_surplus': {'model_a': 294.7985756249982, 'model_b': 1587.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 176 completed successfully
Fri Nov  7 06:16:46 PM CET 2025: Completed iteration 176

=== Iteration 177/300 ===
Fri Nov  7 06:16:46 PM CET 2025: Starting company car negotiation iteration 177 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,150 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38425}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38425}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38425}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38425}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38425}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38425.0}
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,425 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,200 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 394.80 (saved â‚¬394.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1487.87 (profit â‚¬1487.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38989.60, seller=38200.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=394.80, model_a surplus=1487.87
âœ… Calculated utility_surplus: {'model_a': 1487.8745256249967, 'model_b': 394.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38989.59715125, 'model_a': 38200.0}
Metrics: {'utility_surplus': {'model_a': 1487.8745256249967, 'model_b': 394.7985756249982}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 177 completed successfully
Fri Nov  7 06:17:19 PM CET 2025: Completed iteration 177

=== Iteration 178/300 ===
Fri Nov  7 06:17:19 PM CET 2025: Starting company car negotiation iteration 178 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39250\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39250\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39250\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬39,250 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38750\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38750\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38750\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 594.80 (saved â‚¬594.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1287.87 (profit â‚¬1287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39189.60, seller=38000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=594.80, model_b surplus=1287.87
âœ… Calculated utility_surplus: {'model_a': 594.7985756249982, 'model_b': 1287.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39189.59715125, 'model_b': 38000.0}
Metrics: {'utility_surplus': {'model_a': 594.7985756249982, 'model_b': 1287.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 178 completed successfully
Fri Nov  7 06:17:45 PM CET 2025: Completed iteration 178

=== Iteration 179/300 ===
Fri Nov  7 06:17:45 PM CET 2025: Starting company car negotiation iteration 179 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.34s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.60s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.46s (total since entry 9.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38450\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬37,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1094.80 (saved â‚¬1094.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 787.87 (profit â‚¬787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39689.60, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1094.80, model_a surplus=787.87
âœ… Calculated utility_surplus: {'model_a': 787.8745256249967, 'model_b': 1094.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39689.59715125, 'model_a': 37500.0}
Metrics: {'utility_surplus': {'model_a': 787.8745256249967, 'model_b': 1094.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 179 completed successfully
Fri Nov  7 06:18:13 PM CET 2025: Completed iteration 179

=== Iteration 180/300 ===
Fri Nov  7 06:18:13 PM CET 2025: Starting company car negotiation iteration 180 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.46s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39900.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,900 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 594.80 (saved â‚¬594.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1287.87 (profit â‚¬1287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39189.60, seller=38000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=594.80, model_a surplus=1287.87
âœ… Calculated utility_surplus: {'model_a': 1287.8745256249967, 'model_b': 594.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39189.59715125, 'model_a': 38000.0}
Metrics: {'utility_surplus': {'model_a': 1287.8745256249967, 'model_b': 594.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 180 completed successfully
Fri Nov  7 06:18:43 PM CET 2025: Completed iteration 180

=== Iteration 181/300 ===
Fri Nov  7 06:18:43 PM CET 2025: Starting company car negotiation iteration 181 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 4.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.60s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.47s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39100\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39100\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39100\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39100.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,100 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,600 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-5.20, model_b surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': -5.201424375001807, 'model_b': 1887.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38589.59715125, 'model_b': 38600.0}
Metrics: {'utility_surplus': {'model_a': -5.201424375001807, 'model_b': 1887.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 181 completed successfully
Fri Nov  7 06:19:14 PM CET 2025: Completed iteration 181

=== Iteration 182/300 ===
Fri Nov  7 06:19:14 PM CET 2025: Starting company car negotiation iteration 182 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.96s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.41s (total since entry 9.03s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,490 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,600 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1179.22 (saved â‚¬1179.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 761.22 (profit â‚¬761.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40958.45, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1179.22, model_a surplus=761.22
âœ… Calculated utility_surplus: {'model_a': 761.2249999999985, 'model_b': 1179.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 40958.45, 'model_a': 38600.0}
Metrics: {'utility_surplus': {'model_a': 761.2249999999985, 'model_b': 1179.2249999999985}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 182 completed successfully
Fri Nov  7 06:19:41 PM CET 2025: Completed iteration 182

=== Iteration 183/300 ===
Fri Nov  7 06:19:41 PM CET 2025: Starting company car negotiation iteration 183 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.50s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.81s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.27s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38275}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38275}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38275}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38275}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38275}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38275.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,275 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 594.80 (saved â‚¬594.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1287.87 (profit â‚¬1287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39189.60, seller=38000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=594.80, model_a surplus=1287.87
âœ… Calculated utility_surplus: {'model_a': 1287.8745256249967, 'model_b': 594.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39189.59715125, 'model_a': 38000.0}
Metrics: {'utility_surplus': {'model_a': 1287.8745256249967, 'model_b': 594.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 183 completed successfully
Fri Nov  7 06:20:10 PM CET 2025: Completed iteration 183

=== Iteration 184/300 ===
Fri Nov  7 06:20:10 PM CET 2025: Starting company car negotiation iteration 184 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.50s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.40s (total since entry 9.02s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,490 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_a made offer â‚¬38,490 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38625\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38625\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38625\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38625}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38625}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38625.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ’¡ Player model_b made offer â‚¬38,625 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,150 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,150 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38150
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 444.80 (saved â‚¬444.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1437.87 (profit â‚¬1437.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39039.60, seller=38150.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=444.80, model_a surplus=1437.87
âœ… Calculated utility_surplus: {'model_a': 1437.8745256249967, 'model_b': 444.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39039.59715125, 'model_a': 38150.0}
Metrics: {'utility_surplus': {'model_a': 1437.8745256249967, 'model_b': 444.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 184 completed successfully
Fri Nov  7 06:20:39 PM CET 2025: Completed iteration 184

=== Iteration 185/300 ===
Fri Nov  7 06:20:39 PM CET 2025: Starting company car negotiation iteration 185 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.46s (total since entry 9.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39999}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39999}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39999}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39999}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39999}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39999.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40500.0}
ğŸ’¡ Player model_a made offer â‚¬39,999 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39999\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39999\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39999\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39999}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39999}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39999.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬39,999 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39100\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39100\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39100\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39100.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,100 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38762}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38762}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38762}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38762}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38762}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38762.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,762 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,250 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38250
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 344.80 (saved â‚¬344.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1537.87 (profit â‚¬1537.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38939.60, seller=38250.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=344.80, model_a surplus=1537.87
âœ… Calculated utility_surplus: {'model_a': 1537.8745256249967, 'model_b': 344.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38939.59715125, 'model_a': 38250.0}
Metrics: {'utility_surplus': {'model_a': 1537.8745256249967, 'model_b': 344.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 185 completed successfully
Fri Nov  7 06:21:07 PM CET 2025: Completed iteration 185

=== Iteration 186/300 ===
Fri Nov  7 06:21:07 PM CET 2025: Starting company car negotiation iteration 186 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.47s (total since entry 9.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬40,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1000.00, model_a surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 42000.0, 'model_a': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 186 completed successfully
Fri Nov  7 06:21:27 PM CET 2025: Completed iteration 186

=== Iteration 187/300 ===
Fri Nov  7 06:21:27 PM CET 2025: Starting company car negotiation iteration 187 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.43s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39750\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39750\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39750\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬39,750 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39100\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39100\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39100\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ’¡ Player model_b made offer â‚¬39,100 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,650 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=144.80, model_a surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 1737.8745256249967, 'model_b': 144.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38739.59715125, 'model_a': 38450.0}
Metrics: {'utility_surplus': {'model_a': 1737.8745256249967, 'model_b': 144.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 187 completed successfully
Fri Nov  7 06:22:02 PM CET 2025: Completed iteration 187

=== Iteration 188/300 ===
Fri Nov  7 06:22:02 PM CET 2025: Starting company car negotiation iteration 188 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,350 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 188 completed successfully
Fri Nov  7 06:22:33 PM CET 2025: Completed iteration 188

=== Iteration 189/300 ===
Fri Nov  7 06:22:33 PM CET 2025: Starting company car negotiation iteration 189 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 4.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.65s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38499}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38499}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38499}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38499}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38499}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38499.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,499 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38275}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38275}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38275}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38275}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38275}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38275.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,275 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,250 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38250
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 344.80 (saved â‚¬344.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1537.87 (profit â‚¬1537.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38939.60, seller=38250.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=344.80, model_a surplus=1537.87
âœ… Calculated utility_surplus: {'model_a': 1537.8745256249967, 'model_b': 344.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38939.59715125, 'model_a': 38250.0}
Metrics: {'utility_surplus': {'model_a': 1537.8745256249967, 'model_b': 344.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 189 completed successfully
Fri Nov  7 06:23:02 PM CET 2025: Completed iteration 189

=== Iteration 190/300 ===
Fri Nov  7 06:23:02 PM CET 2025: Starting company car negotiation iteration 190 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.39s (total since entry 4.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬40,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 385.00 (saved â‚¬385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1585.00 (profit â‚¬1585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40770.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=385.00, model_b surplus=1585.00
âœ… Calculated utility_surplus: {'model_a': 385.0, 'model_b': 1585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 40770.0, 'model_b': 40000.0}
Metrics: {'utility_surplus': {'model_a': 385.0, 'model_b': 1585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 190 completed successfully
Fri Nov  7 06:23:26 PM CET 2025: Completed iteration 190

=== Iteration 191/300 ===
Fri Nov  7 06:23:26 PM CET 2025: Starting company car negotiation iteration 191 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.50s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.60s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.04s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬40,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1000.00, model_a surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 42000.0, 'model_a': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 191 completed successfully
Fri Nov  7 06:23:46 PM CET 2025: Completed iteration 191

=== Iteration 192/300 ===
Fri Nov  7 06:23:46 PM CET 2025: Starting company car negotiation iteration 192 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.41s (total since entry 9.02s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39400.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,400 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,650 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=144.80, model_a surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 1737.8745256249967, 'model_b': 144.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38739.59715125, 'model_a': 38450.0}
Metrics: {'utility_surplus': {'model_a': 1737.8745256249967, 'model_b': 144.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 192 completed successfully
Fri Nov  7 06:24:13 PM CET 2025: Completed iteration 192

=== Iteration 193/300 ===
Fri Nov  7 06:24:13 PM CET 2025: Starting company car negotiation iteration 193 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.66s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.46s (total since entry 9.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39200\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39200\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39200\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1385.00, model_b surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 1385.0, 'model_b': 585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41770.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1385.0, 'model_b': 585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 193 completed successfully
Fri Nov  7 06:24:37 PM CET 2025: Completed iteration 193

=== Iteration 194/300 ===
Fri Nov  7 06:24:37 PM CET 2025: Starting company car negotiation iteration 194 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.46s (total since entry 9.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38750\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38750\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38750\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38425\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38425\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38425\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38425}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38425}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38425.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,425 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 194 completed successfully
Fri Nov  7 06:25:06 PM CET 2025: Completed iteration 194

=== Iteration 195/300 ===
Fri Nov  7 06:25:06 PM CET 2025: Starting company car negotiation iteration 195 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.32s (total since entry 4.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬40,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1000.00, model_a surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 42000.0, 'model_a': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 195 completed successfully
Fri Nov  7 06:25:26 PM CET 2025: Completed iteration 195

=== Iteration 196/300 ===
Fri Nov  7 06:25:26 PM CET 2025: Starting company car negotiation iteration 196 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.47s (total since entry 9.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39150}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39150}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39150}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39150}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39150.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,150 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,300 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=144.80, model_b surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38739.59715125, 'model_b': 38450.0}
Metrics: {'utility_surplus': {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 196 completed successfully
Fri Nov  7 06:25:49 PM CET 2025: Completed iteration 196

=== Iteration 197/300 ===
Fri Nov  7 06:25:49 PM CET 2025: Starting company car negotiation iteration 197 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.33s (total since entry 4.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.60s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.46s (total since entry 9.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬40,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1000.00, model_b surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 42000.0, 'model_b': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 197 completed successfully
Fri Nov  7 06:26:11 PM CET 2025: Completed iteration 197

=== Iteration 198/300 ===
Fri Nov  7 06:26:11 PM CET 2025: Starting company car negotiation iteration 198 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.41s (total since entry 9.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_a made offer â‚¬38,100 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38425}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38425}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38425}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38425}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38425}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38425.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,425 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=144.80, model_a surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 1737.8745256249967, 'model_b': 144.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38739.59715125, 'model_a': 38450.0}
Metrics: {'utility_surplus': {'model_a': 1737.8745256249967, 'model_b': 144.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 198 completed successfully
Fri Nov  7 06:26:41 PM CET 2025: Completed iteration 198

=== Iteration 199/300 ===
Fri Nov  7 06:26:41 PM CET 2025: Starting company car negotiation iteration 199 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.48s (total since entry 9.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=144.80, model_a surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 1737.8745256249967, 'model_b': 144.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38739.59715125, 'model_a': 38450.0}
Metrics: {'utility_surplus': {'model_a': 1737.8745256249967, 'model_b': 144.7985756249982}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 199 completed successfully
Fri Nov  7 06:27:08 PM CET 2025: Completed iteration 199

=== Iteration 200/300 ===
Fri Nov  7 06:27:08 PM CET 2025: Starting company car negotiation iteration 200 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.60s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.47s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,350 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,400 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 194.80 (saved â‚¬194.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1687.87 (profit â‚¬1687.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38789.60, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=194.80, model_a surplus=1687.87
âœ… Calculated utility_surplus: {'model_a': 1687.8745256249967, 'model_b': 194.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38789.59715125, 'model_a': 38400.0}
Metrics: {'utility_surplus': {'model_a': 1687.8745256249967, 'model_b': 194.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 200 completed successfully
Fri Nov  7 06:27:42 PM CET 2025: Completed iteration 200

=== Iteration 201/300 ===
Fri Nov  7 06:27:42 PM CET 2025: Starting company car negotiation iteration 201 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.93s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 41000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 41000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 41000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬41,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,250 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38250
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 344.80 (saved â‚¬344.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1537.87 (profit â‚¬1537.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38939.60, seller=38250.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=344.80, model_b surplus=1537.87
âœ… Calculated utility_surplus: {'model_a': 344.7985756249982, 'model_b': 1537.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38939.59715125, 'model_b': 38250.0}
Metrics: {'utility_surplus': {'model_a': 344.7985756249982, 'model_b': 1537.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 201 completed successfully
Fri Nov  7 06:28:14 PM CET 2025: Completed iteration 201

=== Iteration 202/300 ===
Fri Nov  7 06:28:14 PM CET 2025: Starting company car negotiation iteration 202 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.52s (total since entry 5.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.65s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.41s (total since entry 9.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39100\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39100\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39100\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39100.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,100 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=144.80, model_b surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38739.59715125, 'model_b': 38450.0}
Metrics: {'utility_surplus': {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 202 completed successfully
Fri Nov  7 06:28:38 PM CET 2025: Completed iteration 202

=== Iteration 203/300 ===
Fri Nov  7 06:28:38 PM CET 2025: Starting company car negotiation iteration 203 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.46s (total since entry 9.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,650 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,200 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 394.80 (saved â‚¬394.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1487.87 (profit â‚¬1487.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38989.60, seller=38200.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=394.80, model_a surplus=1487.87
âœ… Calculated utility_surplus: {'model_a': 1487.8745256249967, 'model_b': 394.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38989.59715125, 'model_a': 38200.0}
Metrics: {'utility_surplus': {'model_a': 1487.8745256249967, 'model_b': 394.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 203 completed successfully
Fri Nov  7 06:29:06 PM CET 2025: Completed iteration 203

=== Iteration 204/300 ===
Fri Nov  7 06:29:06 PM CET 2025: Starting company car negotiation iteration 204 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38764\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38764\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38764\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38764}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38764}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38764.0}
ğŸ’¡ Player model_a made offer â‚¬38,100 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,764 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38300\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38300\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38300\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ’¡ Player model_a made offer â‚¬38,650 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,300 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 204 completed successfully
Fri Nov  7 06:29:39 PM CET 2025: Completed iteration 204

=== Iteration 205/300 ===
Fri Nov  7 06:29:39 PM CET 2025: Starting company car negotiation iteration 205 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39450.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,450 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,350 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38475}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38475}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38475}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38475}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38475}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38475.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,475 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=144.80, model_a surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 1737.8745256249967, 'model_b': 144.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38739.59715125, 'model_a': 38450.0}
Metrics: {'utility_surplus': {'model_a': 1737.8745256249967, 'model_b': 144.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 205 completed successfully
Fri Nov  7 06:30:10 PM CET 2025: Completed iteration 205

=== Iteration 206/300 ===
Fri Nov  7 06:30:10 PM CET 2025: Starting company car negotiation iteration 206 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 4.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.48s (total since entry 9.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 37999}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37999}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37999}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37999}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37999}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37999.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬37,999 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,490 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,490 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38490
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 104.80 (saved â‚¬104.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1777.87 (profit â‚¬1777.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38699.60, seller=38490.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=104.80, model_b surplus=1777.87
âœ… Calculated utility_surplus: {'model_a': 104.7985756249982, 'model_b': 1777.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38699.59715125, 'model_b': 38490.0}
Metrics: {'utility_surplus': {'model_a': 104.7985756249982, 'model_b': 1777.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 206 completed successfully
Fri Nov  7 06:30:42 PM CET 2025: Completed iteration 206

=== Iteration 207/300 ===
Fri Nov  7 06:30:42 PM CET 2025: Starting company car negotiation iteration 207 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39100\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39100\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39100\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬39,100 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,250 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38250
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 344.80 (saved â‚¬344.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1537.87 (profit â‚¬1537.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38939.60, seller=38250.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=344.80, model_b surplus=1537.87
âœ… Calculated utility_surplus: {'model_a': 344.7985756249982, 'model_b': 1537.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38939.59715125, 'model_b': 38250.0}
Metrics: {'utility_surplus': {'model_a': 344.7985756249982, 'model_b': 1537.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 207 completed successfully
Fri Nov  7 06:31:16 PM CET 2025: Completed iteration 207

=== Iteration 208/300 ===
Fri Nov  7 06:31:16 PM CET 2025: Starting company car negotiation iteration 208 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.60s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,900 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38701}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38701}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38701}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38701}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38701}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38701.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,701 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=144.80, model_b surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38739.59715125, 'model_b': 38450.0}
Metrics: {'utility_surplus': {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 208 completed successfully
Fri Nov  7 06:31:42 PM CET 2025: Completed iteration 208

=== Iteration 209/300 ===
Fri Nov  7 06:31:42 PM CET 2025: Starting company car negotiation iteration 209 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.33s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.66s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.42s (total since entry 9.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,490 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38475}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38475}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38475}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38475}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38475}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38475.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,475 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38875}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38875}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38875}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38875}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38875}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38875.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-5.20, model_a surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38589.59715125, 'model_a': 38600.0}
Metrics: {'utility_surplus': {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 209 completed successfully
Fri Nov  7 06:32:16 PM CET 2025: Completed iteration 209

=== Iteration 210/300 ===
Fri Nov  7 06:32:16 PM CET 2025: Starting company car negotiation iteration 210 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.47s (total since entry 9.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38700\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38700\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38700\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬37,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1094.80 (saved â‚¬1094.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 787.87 (profit â‚¬787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39689.60, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1094.80, model_b surplus=787.87
âœ… Calculated utility_surplus: {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39689.59715125, 'model_b': 37500.0}
Metrics: {'utility_surplus': {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 210 completed successfully
Fri Nov  7 06:32:51 PM CET 2025: Completed iteration 210

=== Iteration 211/300 ===
Fri Nov  7 06:32:51 PM CET 2025: Starting company car negotiation iteration 211 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.43s (total since entry 4.96s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.48s (total since entry 9.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39499}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39499}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39499}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39499}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39499}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39499.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,499 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,150 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38450\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38450\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38450\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38200\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38200\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38200\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_a made offer â‚¬38,350 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,350 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38350
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 244.80 (saved â‚¬244.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1637.87 (profit â‚¬1637.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38839.60, seller=38350.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=244.80, model_a surplus=1637.87
âœ… Calculated utility_surplus: {'model_a': 1637.8745256249967, 'model_b': 244.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38839.59715125, 'model_a': 38350.0}
Metrics: {'utility_surplus': {'model_a': 1637.8745256249967, 'model_b': 244.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 211 completed successfully
Fri Nov  7 06:33:20 PM CET 2025: Completed iteration 211

=== Iteration 212/300 ===
Fri Nov  7 06:33:20 PM CET 2025: Starting company car negotiation iteration 212 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.32s (total since entry 4.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.35s (total since entry 9.00s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38480}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38480}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38480}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38480}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38480}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38480.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38550\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38550\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38550\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38550}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38550}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38550.0}
ğŸ’¡ Player model_a made offer â‚¬38,480 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,550 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38550}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38550}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38550}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38550}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38550}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38550.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,480 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38480
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 114.80 (saved â‚¬114.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1767.87 (profit â‚¬1767.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38709.60, seller=38480.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=114.80, model_b surplus=1767.87
âœ… Calculated utility_surplus: {'model_a': 114.7985756249982, 'model_b': 1767.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38709.59715125, 'model_b': 38480.0}
Metrics: {'utility_surplus': {'model_a': 114.7985756249982, 'model_b': 1767.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 212 completed successfully
Fri Nov  7 06:33:58 PM CET 2025: Completed iteration 212

=== Iteration 213/300 ===
Fri Nov  7 06:33:58 PM CET 2025: Starting company car negotiation iteration 213 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.04s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.33s (total since entry 5.39s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.39s (total since entry 9.03s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38800\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38800\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38800\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38800.0}
ğŸ’¡ Player model_a made offer â‚¬37,800 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,800 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,400 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 194.80 (saved â‚¬194.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1687.87 (profit â‚¬1687.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38789.60, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=194.80, model_b surplus=1687.87
âœ… Calculated utility_surplus: {'model_a': 194.7985756249982, 'model_b': 1687.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38789.59715125, 'model_b': 38400.0}
Metrics: {'utility_surplus': {'model_a': 194.7985756249982, 'model_b': 1687.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 213 completed successfully
Fri Nov  7 06:34:25 PM CET 2025: Completed iteration 213

=== Iteration 214/300 ===
Fri Nov  7 06:34:25 PM CET 2025: Starting company car negotiation iteration 214 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.39s (total since entry 4.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.68s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.43s (total since entry 9.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,490 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,490 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38475}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38475}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38475}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38475}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38475}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38475.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,475 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 214 completed successfully
Fri Nov  7 06:34:55 PM CET 2025: Completed iteration 214

=== Iteration 215/300 ===
Fri Nov  7 06:34:55 PM CET 2025: Starting company car negotiation iteration 215 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.50s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.55s (total since entry 5.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37650}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37650}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37650}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37650}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37650.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬37,650 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38750\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38750\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38750\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,200 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 394.80 (saved â‚¬394.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1487.87 (profit â‚¬1487.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38989.60, seller=38200.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=394.80, model_b surplus=1487.87
âœ… Calculated utility_surplus: {'model_a': 394.7985756249982, 'model_b': 1487.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38989.59715125, 'model_b': 38200.0}
Metrics: {'utility_surplus': {'model_a': 394.7985756249982, 'model_b': 1487.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 215 completed successfully
Fri Nov  7 06:35:31 PM CET 2025: Completed iteration 215

=== Iteration 216/300 ===
Fri Nov  7 06:35:31 PM CET 2025: Starting company car negotiation iteration 216 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 4.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.46s (total since entry 9.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 37450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38700\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38700\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38700\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ’¡ Player model_a made offer â‚¬37,450 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,200 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 394.80 (saved â‚¬394.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1487.87 (profit â‚¬1487.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38989.60, seller=38200.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=394.80, model_b surplus=1487.87
âœ… Calculated utility_surplus: {'model_a': 394.7985756249982, 'model_b': 1487.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38989.59715125, 'model_b': 38200.0}
Metrics: {'utility_surplus': {'model_a': 394.7985756249982, 'model_b': 1487.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 216 completed successfully
Fri Nov  7 06:35:55 PM CET 2025: Completed iteration 216

=== Iteration 217/300 ===
Fri Nov  7 06:35:55 PM CET 2025: Starting company car negotiation iteration 217 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38750\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38750\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38750\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 217 completed successfully
Fri Nov  7 06:36:23 PM CET 2025: Completed iteration 217

=== Iteration 218/300 ===
Fri Nov  7 06:36:23 PM CET 2025: Starting company car negotiation iteration 218 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.34s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.61s (total since entry 9.22s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 41000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 41000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 41000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39400.0}
ğŸ’¡ Player model_b made offer â‚¬41,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,400 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38495}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38495}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38495}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38495}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38495}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38495.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=144.80, model_b surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38739.59715125, 'model_b': 38450.0}
Metrics: {'utility_surplus': {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 218 completed successfully
Fri Nov  7 06:36:57 PM CET 2025: Completed iteration 218

=== Iteration 219/300 ===
Fri Nov  7 06:36:57 PM CET 2025: Starting company car negotiation iteration 219 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.33s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38800}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38800}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38800}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38800.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,800 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,250 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38250
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 344.80 (saved â‚¬344.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1537.87 (profit â‚¬1537.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38939.60, seller=38250.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=344.80, model_b surplus=1537.87
âœ… Calculated utility_surplus: {'model_a': 344.7985756249982, 'model_b': 1537.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38939.59715125, 'model_b': 38250.0}
Metrics: {'utility_surplus': {'model_a': 344.7985756249982, 'model_b': 1537.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 219 completed successfully
Fri Nov  7 06:37:24 PM CET 2025: Completed iteration 219

=== Iteration 220/300 ===
Fri Nov  7 06:37:24 PM CET 2025: Starting company car negotiation iteration 220 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.33s (total since entry 4.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.42s (total since entry 9.04s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,490 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38450\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=144.80, model_a surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 1737.8745256249967, 'model_b': 144.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38739.59715125, 'model_a': 38450.0}
Metrics: {'utility_surplus': {'model_a': 1737.8745256249967, 'model_b': 144.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 220 completed successfully
Fri Nov  7 06:37:56 PM CET 2025: Completed iteration 220

=== Iteration 221/300 ===
Fri Nov  7 06:37:56 PM CET 2025: Starting company car negotiation iteration 221 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 4.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,350 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,350 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38350
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 244.80 (saved â‚¬244.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1637.87 (profit â‚¬1637.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38839.60, seller=38350.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=244.80, model_b surplus=1637.87
âœ… Calculated utility_surplus: {'model_a': 244.7985756249982, 'model_b': 1637.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38839.59715125, 'model_b': 38350.0}
Metrics: {'utility_surplus': {'model_a': 244.7985756249982, 'model_b': 1637.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 221 completed successfully
Fri Nov  7 06:38:28 PM CET 2025: Completed iteration 221

=== Iteration 222/300 ===
Fri Nov  7 06:38:28 PM CET 2025: Starting company car negotiation iteration 222 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.29s (total since entry 4.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.65s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.32s (total since entry 8.97s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 35000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 35000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 35000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 35000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 35000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 35000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬35,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38250\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38250\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38250\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38350\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38350\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38350\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
ğŸ’¡ Player model_a made offer â‚¬38,650 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,350 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", role": "ROLE A", "price": 38100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", role": "ROLE A", "price": 38100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", role": "ROLE A", "price": 38100}'
âš ï¸ [DEBUG] [model_a] JSON decode error for start match: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_a] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 38100}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_a] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 38100}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_a] Extracted JSON decode error: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âœ… [DEBUG] [model_a] Manually extracted action: {'type': 'offer'}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,650 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38650
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -55.20 (saved â‚¬-55.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1937.87 (profit â‚¬1937.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38539.60, seller=38650.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-55.20, model_a surplus=1937.87
âœ… Calculated utility_surplus: {'model_a': 1937.8745256249967, 'model_b': -55.20142437500181}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38539.59715125, 'model_a': 38650.0}
Metrics: {'utility_surplus': {'model_a': 1937.8745256249967, 'model_b': -55.20142437500181}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 222 completed successfully
Fri Nov  7 06:39:00 PM CET 2025: Completed iteration 222

=== Iteration 223/300 ===
Fri Nov  7 06:39:00 PM CET 2025: Starting company car negotiation iteration 223 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.46s (total since entry 9.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", ROLE_A", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", ROLE_A", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", ROLE_A", "price": 39000}'
âš ï¸ [DEBUG] [model_a] JSON decode error for start match: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_a] JSON decode error for '{"type": "offer", ROLE_A", "price": 39000}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_a] JSON decode error for '{"type": "offer", ROLE_A", "price": 39000}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_a] Extracted JSON decode error: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âœ… [DEBUG] [model_a] Manually extracted action: {'type': 'offer'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,450 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=682.54, model_b surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39865.07324999999, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 223 completed successfully
Fri Nov  7 06:39:31 PM CET 2025: Completed iteration 223

=== Iteration 224/300 ===
Fri Nov  7 06:39:31 PM CET 2025: Starting company car negotiation iteration 224 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.52s (total since entry 5.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬40,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38475\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38475\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38475\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38475}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38475}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38475.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,475 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=144.80, model_a surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 1737.8745256249967, 'model_b': 144.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38739.59715125, 'model_a': 38450.0}
Metrics: {'utility_surplus': {'model_a': 1737.8745256249967, 'model_b': 144.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 224 completed successfully
Fri Nov  7 06:40:00 PM CET 2025: Completed iteration 224

=== Iteration 225/300 ===
Fri Nov  7 06:40:00 PM CET 2025: Starting company car negotiation iteration 225 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬40,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1000.00, model_a surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 42000.0, 'model_a': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 225 completed successfully
Fri Nov  7 06:40:22 PM CET 2025: Completed iteration 225

=== Iteration 226/300 ===
Fri Nov  7 06:40:22 PM CET 2025: Starting company car negotiation iteration 226 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.50s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.53s (total since entry 9.17s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬37,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1094.80 (saved â‚¬1094.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 787.87 (profit â‚¬787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39689.60, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1094.80, model_a surplus=787.87
âœ… Calculated utility_surplus: {'model_a': 787.8745256249967, 'model_b': 1094.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39689.59715125, 'model_a': 37500.0}
Metrics: {'utility_surplus': {'model_a': 787.8745256249967, 'model_b': 1094.7985756249982}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 226 completed successfully
Fri Nov  7 06:40:51 PM CET 2025: Completed iteration 226

=== Iteration 227/300 ===
Fri Nov  7 06:40:51 PM CET 2025: Starting company car negotiation iteration 227 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.65s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,350 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,150 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,300 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=144.80, model_a surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 1737.8745256249967, 'model_b': 144.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38739.59715125, 'model_a': 38450.0}
Metrics: {'utility_surplus': {'model_a': 1737.8745256249967, 'model_b': 144.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 227 completed successfully
Fri Nov  7 06:41:23 PM CET 2025: Completed iteration 227

=== Iteration 228/300 ===
Fri Nov  7 06:41:23 PM CET 2025: Starting company car negotiation iteration 228 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.34s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬39,100 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37950}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37950}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37950}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37950}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37950.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38779}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38779}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38779}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38779}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38779}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38779.0}
ğŸ’¡ Player model_a made offer â‚¬37,950 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,779 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 228 completed successfully
Fri Nov  7 06:41:59 PM CET 2025: Completed iteration 228

=== Iteration 229/300 ===
Fri Nov  7 06:41:59 PM CET 2025: Starting company car negotiation iteration 229 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.83s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.28s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,300 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,300 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38300
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 294.80 (saved â‚¬294.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1587.87 (profit â‚¬1587.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38889.60, seller=38300.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=294.80, model_a surplus=1587.87
âœ… Calculated utility_surplus: {'model_a': 1587.8745256249967, 'model_b': 294.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38889.59715125, 'model_a': 38300.0}
Metrics: {'utility_surplus': {'model_a': 1587.8745256249967, 'model_b': 294.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 229 completed successfully
Fri Nov  7 06:42:28 PM CET 2025: Completed iteration 229

=== Iteration 230/300 ===
Fri Nov  7 06:42:28 PM CET 2025: Starting company car negotiation iteration 230 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.59s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.95s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.43s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37999}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37999}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37999}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37999}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37999}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37999.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬37,999 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬37,999 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37999
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 595.80 (saved â‚¬595.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1286.87 (profit â‚¬1286.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39190.60, seller=37999.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=595.80, model_b surplus=1286.87
âœ… Calculated utility_surplus: {'model_a': 595.7985756249982, 'model_b': 1286.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39190.59715125, 'model_b': 37999.0}
Metrics: {'utility_surplus': {'model_a': 595.7985756249982, 'model_b': 1286.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 230 completed successfully
Fri Nov  7 06:42:59 PM CET 2025: Completed iteration 230

=== Iteration 231/300 ===
Fri Nov  7 06:42:59 PM CET 2025: Starting company car negotiation iteration 231 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.33s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.42s (total since entry 9.04s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 885.00 (saved â‚¬885.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1085.00 (profit â‚¬1085.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41270.00, seller=39500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=885.00, model_a surplus=1085.00
âœ… Calculated utility_surplus: {'model_a': 1085.0, 'model_b': 885.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 41270.0, 'model_a': 39500.0}
Metrics: {'utility_surplus': {'model_a': 1085.0, 'model_b': 885.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 231 completed successfully
Fri Nov  7 06:43:22 PM CET 2025: Completed iteration 231

=== Iteration 232/300 ===
Fri Nov  7 06:43:22 PM CET 2025: Starting company car negotiation iteration 232 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.34s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.66s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.42s (total since entry 9.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38750\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38750\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38750\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,250 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38250
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 932.54 (saved â‚¬932.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 978.81 (profit â‚¬978.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40115.07, seller=38250.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=932.54, model_a surplus=978.81
âœ… Calculated utility_surplus: {'model_a': 978.8066250000047, 'model_b': 932.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 40115.07324999999, 'model_a': 38250.0}
Metrics: {'utility_surplus': {'model_a': 978.8066250000047, 'model_b': 932.5366249999934}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 232 completed successfully
Fri Nov  7 06:43:48 PM CET 2025: Completed iteration 232

=== Iteration 233/300 ===
Fri Nov  7 06:43:48 PM CET 2025: Starting company car negotiation iteration 233 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.34s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.41s (total since entry 9.04s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37850}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37850}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37850}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37850}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37850}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37850.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,600 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-5.20, model_b surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': -5.201424375001807, 'model_b': 1887.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38589.59715125, 'model_b': 38600.0}
Metrics: {'utility_surplus': {'model_a': -5.201424375001807, 'model_b': 1887.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 233 completed successfully
Fri Nov  7 06:44:18 PM CET 2025: Completed iteration 233

=== Iteration 234/300 ===
Fri Nov  7 06:44:18 PM CET 2025: Starting company car negotiation iteration 234 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.46s (total since entry 9.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38200\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38200\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38200\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_a made offer â‚¬38,150 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,150 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38150
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 444.80 (saved â‚¬444.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1437.87 (profit â‚¬1437.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39039.60, seller=38150.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=444.80, model_a surplus=1437.87
âœ… Calculated utility_surplus: {'model_a': 1437.8745256249967, 'model_b': 444.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39039.59715125, 'model_a': 38150.0}
Metrics: {'utility_surplus': {'model_a': 1437.8745256249967, 'model_b': 444.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 234 completed successfully
Fri Nov  7 06:44:45 PM CET 2025: Completed iteration 234

=== Iteration 235/300 ===
Fri Nov  7 06:44:45 PM CET 2025: Starting company car negotiation iteration 235 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.33s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬40,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1000.00, model_b surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 42000.0, 'model_b': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 235 completed successfully
Fri Nov  7 06:45:07 PM CET 2025: Completed iteration 235

=== Iteration 236/300 ===
Fri Nov  7 06:45:07 PM CET 2025: Starting company car negotiation iteration 236 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.34s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38480}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38480}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38480}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38480}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38480}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38480.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,480 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38425}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38425}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38425}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38425}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38425}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38425.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,425 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,250 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38250
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 344.80 (saved â‚¬344.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1537.87 (profit â‚¬1537.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38939.60, seller=38250.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=344.80, model_a surplus=1537.87
âœ… Calculated utility_surplus: {'model_a': 1537.8745256249967, 'model_b': 344.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38939.59715125, 'model_a': 38250.0}
Metrics: {'utility_surplus': {'model_a': 1537.8745256249967, 'model_b': 344.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 236 completed successfully
Fri Nov  7 06:45:36 PM CET 2025: Completed iteration 236

=== Iteration 237/300 ===
Fri Nov  7 06:45:36 PM CET 2025: Starting company car negotiation iteration 237 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.39s (total since entry 4.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.49s (total since entry 9.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 237 completed successfully
Fri Nov  7 06:46:05 PM CET 2025: Completed iteration 237

=== Iteration 238/300 ===
Fri Nov  7 06:46:05 PM CET 2025: Starting company car negotiation iteration 238 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 4.95s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39200\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39200\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39200\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ’¡ Player model_a made offer â‚¬37,250 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,250 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38250
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 344.80 (saved â‚¬344.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1537.87 (profit â‚¬1537.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38939.60, seller=38250.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=344.80, model_b surplus=1537.87
âœ… Calculated utility_surplus: {'model_a': 344.7985756249982, 'model_b': 1537.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38939.59715125, 'model_b': 38250.0}
Metrics: {'utility_surplus': {'model_a': 344.7985756249982, 'model_b': 1537.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 238 completed successfully
Fri Nov  7 06:46:29 PM CET 2025: Completed iteration 238

=== Iteration 239/300 ===
Fri Nov  7 06:46:29 PM CET 2025: Starting company car negotiation iteration 239 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.47s (total since entry 9.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38750\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38750\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38750\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,750 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38750
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -155.20 (saved â‚¬-155.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2037.87 (profit â‚¬2037.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38439.60, seller=38750.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-155.20, model_a surplus=2037.87
âœ… Calculated utility_surplus: {'model_a': 2037.8745256249967, 'model_b': -155.2014243750018}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38439.59715125, 'model_a': 38750.0}
Metrics: {'utility_surplus': {'model_a': 2037.8745256249967, 'model_b': -155.2014243750018}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 239 completed successfully
Fri Nov  7 06:46:59 PM CET 2025: Completed iteration 239

=== Iteration 240/300 ===
Fri Nov  7 06:46:59 PM CET 2025: Starting company car negotiation iteration 240 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.50s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.65s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.41s (total since entry 9.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38300\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38300\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38300\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,300 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,300 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38300
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 294.80 (saved â‚¬294.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1587.87 (profit â‚¬1587.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38889.60, seller=38300.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=294.80, model_a surplus=1587.87
âœ… Calculated utility_surplus: {'model_a': 1587.8745256249967, 'model_b': 294.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38889.59715125, 'model_a': 38300.0}
Metrics: {'utility_surplus': {'model_a': 1587.8745256249967, 'model_b': 294.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 240 completed successfully
Fri Nov  7 06:47:29 PM CET 2025: Completed iteration 240

=== Iteration 241/300 ===
Fri Nov  7 06:47:29 PM CET 2025: Starting company car negotiation iteration 241 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.42s (total since entry 9.03s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37950}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37950}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37950}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37950}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37950.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,950 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38200\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38200\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38200\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=144.80, model_a surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 1737.8745256249967, 'model_b': 144.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38739.59715125, 'model_a': 38450.0}
Metrics: {'utility_surplus': {'model_a': 1737.8745256249967, 'model_b': 144.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 241 completed successfully
Fri Nov  7 06:47:59 PM CET 2025: Completed iteration 241

=== Iteration 242/300 ===
Fri Nov  7 06:47:59 PM CET 2025: Starting company car negotiation iteration 242 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38499}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38499}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38499}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38499}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38499}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38499.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,499 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38495}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38495}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38495}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38495}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38495}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38495.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,495 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,490 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,250 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38250
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 344.80 (saved â‚¬344.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1537.87 (profit â‚¬1537.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38939.60, seller=38250.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=344.80, model_a surplus=1537.87
âœ… Calculated utility_surplus: {'model_a': 1537.8745256249967, 'model_b': 344.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38939.59715125, 'model_a': 38250.0}
Metrics: {'utility_surplus': {'model_a': 1537.8745256249967, 'model_b': 344.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 242 completed successfully
Fri Nov  7 06:48:25 PM CET 2025: Completed iteration 242

=== Iteration 243/300 ===
Fri Nov  7 06:48:25 PM CET 2025: Starting company car negotiation iteration 243 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.66s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.42s (total since entry 9.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37650}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37650}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37650}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37650}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37650.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬37,650 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "accept"\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "accept"\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "accept"\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,400 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 194.80 (saved â‚¬194.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1687.87 (profit â‚¬1687.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38789.60, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=194.80, model_b surplus=1687.87
âœ… Calculated utility_surplus: {'model_a': 194.7985756249982, 'model_b': 1687.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38789.59715125, 'model_b': 38400.0}
Metrics: {'utility_surplus': {'model_a': 194.7985756249982, 'model_b': 1687.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 243 completed successfully
Fri Nov  7 06:48:53 PM CET 2025: Completed iteration 243

=== Iteration 244/300 ===
Fri Nov  7 06:48:53 PM CET 2025: Starting company car negotiation iteration 244 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.34s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬40,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 385.00 (saved â‚¬385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1585.00 (profit â‚¬1585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40770.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=385.00, model_b surplus=1585.00
âœ… Calculated utility_surplus: {'model_a': 385.0, 'model_b': 1585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 40770.0, 'model_b': 40000.0}
Metrics: {'utility_surplus': {'model_a': 385.0, 'model_b': 1585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 244 completed successfully
Fri Nov  7 06:49:16 PM CET 2025: Completed iteration 244

=== Iteration 245/300 ===
Fri Nov  7 06:49:16 PM CET 2025: Starting company car negotiation iteration 245 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,150 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38450\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬38,150 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-5.20, model_a surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38589.59715125, 'model_a': 38600.0}
Metrics: {'utility_surplus': {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 245 completed successfully
Fri Nov  7 06:49:42 PM CET 2025: Completed iteration 245

=== Iteration 246/300 ===
Fri Nov  7 06:49:42 PM CET 2025: Starting company car negotiation iteration 246 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38499}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38499}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38499}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38499}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38499}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38499.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,499 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38450\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 594.80 (saved â‚¬594.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1287.87 (profit â‚¬1287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39189.60, seller=38000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=594.80, model_a surplus=1287.87
âœ… Calculated utility_surplus: {'model_a': 1287.8745256249967, 'model_b': 594.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39189.59715125, 'model_a': 38000.0}
Metrics: {'utility_surplus': {'model_a': 1287.8745256249967, 'model_b': 594.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 246 completed successfully
Fri Nov  7 06:50:18 PM CET 2025: Completed iteration 246

=== Iteration 247/300 ===
Fri Nov  7 06:50:18 PM CET 2025: Starting company car negotiation iteration 247 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.65s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.46s (total since entry 9.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 36999}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36999}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36999}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36999}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36999}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36999.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬36,999 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 37500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 37500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 37500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬37,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1682.54 (saved â‚¬1682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 228.81 (profit â‚¬228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40865.07, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1682.54, model_b surplus=228.81
âœ… Calculated utility_surplus: {'model_a': 1682.5366249999934, 'model_b': 228.80662500000471}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 40865.07324999999, 'model_b': 37500.0}
Metrics: {'utility_surplus': {'model_a': 1682.5366249999934, 'model_b': 228.80662500000471}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 247 completed successfully
Fri Nov  7 06:50:44 PM CET 2025: Completed iteration 247

=== Iteration 248/300 ===
Fri Nov  7 06:50:44 PM CET 2025: Starting company car negotiation iteration 248 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.50s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.33s (total since entry 4.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.42s (total since entry 9.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬40,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1000.00, model_a surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat meta-llama/Llama-3.2-3B-Instruct (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 42000.0, 'model_a': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 248 completed successfully
Fri Nov  7 06:51:06 PM CET 2025: Completed iteration 248

=== Iteration 249/300 ===
Fri Nov  7 06:51:06 PM CET 2025: Starting company car negotiation iteration 249 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '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'}}
ğŸ“ Registered model: model_b (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.33s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7381
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.44s (total since entry 9.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20679
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,150 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=144.80, model_a surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 1737.8745256249967, 'model_b': 144.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Mistral-7B-Instruct-v0.3 (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Llama-3.2-3B-Instruct, model_b=Mistral-7B-Instruct-v0.3
âš ï¸  Model model_a shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38739.59715125, 'model_a': 38450.0}
Metrics: {'utility_surplus': {'model_a': 1737.8745256249967, 'model_b': 144.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 249 completed successfully
Fri Nov  7 06:51:34 PM CET 2025: Completed iteration 249

=== Iteration 250/300 ===
Fri Nov  7 06:51:34 PM CET 2025: Starting company car negotiation iteration 250 on node jn117
